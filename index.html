<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Mom Method - AI Interactive Calendar & Business Wizard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    
    <style>
        :root {
            --sage-green: #6B8E6B;
            --warm-cream: #FAF7F0;
            --deep-teal: #2D5B69;
            --charcoal: #2C3E50;
            --soft-gold: #D4A574;
            --light-sage: #E8F5E8;
            --sage-alpha: rgba(107, 142, 107, 0.1);
            --teal-alpha: rgba(45, 91, 105, 0.1);
            --gold-alpha: rgba(212, 165, 116, 0.1);
            --step-current: #3498db;
            --step-completed: #27ae60;
            --step-pending: #95a5a6;
            --button-next: #2ecc71;
            --button-done: #7f8c8d;
            --button-back: #e74c3c;
            --success-green: #27ae60;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: var(--charcoal);
            background: var(--warm-cream);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* User Status Bar */
        .user-status-bar {
            background: white;
            padding: 16px 20px;
            border-radius: 12px;
            margin-bottom: 20px;
            box-shadow: 0 4px 16px rgba(107, 142, 107, 0.08);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 16px;
        }

        .user-info {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .user-avatar {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, var(--sage-green), var(--deep-teal));
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
            font-size: 18px;
        }

        .user-details h4 {
            color: var(--charcoal);
            margin: 0;
            font-size: 16px;
        }

        .user-details p {
            color: var(--charcoal);
            opacity: 0.7;
            margin: 0;
            font-size: 14px;
        }

        .user-actions {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-badge.signed-in {
            background: var(--light-sage);
            color: var(--sage-green);
        }

        .status-badge.guest {
            background: #fff3cd;
            color: #856404;
        }

        /* Authentication Modal */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(44, 62, 80, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s ease;
        }

        .auth-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .auth-content {
            background: white;
            border-radius: 24px;
            padding: 50px;
            max-width: 500px;
            width: 90%;
            position: relative;
            transform: translateY(20px);
            transition: transform 0.4s ease;
        }

        .auth-modal.active .auth-content {
            transform: translateY(0);
        }

        .auth-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--charcoal);
            opacity: 0.7;
        }

        .auth-close:hover {
            opacity: 1;
        }

        .auth-title {
            font-family: 'Playfair Display', serif;
            color: var(--sage-green);
            margin-bottom: 32px;
            font-size: 2rem;
            text-align: center;
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .auth-input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--light-sage);
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
        }

        .auth-input:focus {
            outline: none;
            border-color: var(--sage-green);
            box-shadow: 0 0 0 4px var(--sage-alpha);
        }

        .auth-button {
            background: linear-gradient(135deg, var(--sage-green), #5A7A5A);
            color: white;
            padding: 18px 36px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .auth-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(107, 142, 107, 0.35);
        }

        .auth-button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        .auth-switch {
            text-align: center;
            margin-top: 24px;
            color: var(--charcoal);
            opacity: 0.8;
        }

        .auth-link {
            color: var(--sage-green);
            cursor: pointer;
            text-decoration: underline;
        }

        .auth-error {
            background: #ffebee;
            border: 1px solid #e57373;
            color: #c62828;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 14px;
        }

        .auth-success {
            background: #e8f5e8;
            border: 1px solid var(--sage-green);
            color: var(--sage-green);
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 14px;
        }

        .loading-spinner {
            width: 20px;
            height: 20px;
            border: 2px solid #f3f3f3;
            border-top: 2px solid var(--sage-green);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-right: 8px;
            display: inline-block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Welcome Modal */
        .welcome-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(44, 62, 80, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 1;
            visibility: visible;
            transition: all 0.4s ease;
        }

        .welcome-modal.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .welcome-content {
            background: white;
            border-radius: 24px;
            padding: 60px 50px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            transform: translateY(0);
            transition: transform 0.4s ease;
            box-shadow: 0 30px 80px rgba(44, 62, 80, 0.2);
        }

        .welcome-content h2 {
            font-family: 'Playfair Display', serif;
            color: var(--sage-green);
            margin-bottom: 24px;
            font-size: 2.4rem;
            font-weight: 600;
        }

        .welcome-content p {
            color: var(--charcoal);
            margin-bottom: 40px;
            font-size: 1.1rem;
            line-height: 1.7;
            opacity: 0.8;
        }

        .welcome-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .welcome-btn {
            padding: 18px 36px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
            font-family: 'Inter', sans-serif;
        }

        .welcome-btn.primary {
            background: linear-gradient(135deg, var(--sage-green), #5A7A5A);
            color: white;
            box-shadow: 0 8px 24px rgba(107, 142, 107, 0.3);
        }

        .welcome-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(107, 142, 107, 0.4);
        }

        .welcome-btn.secondary {
            background: var(--deep-teal);
            color: white;
        }

        .welcome-btn.secondary:hover {
            background: #1E3D47;
            transform: translateY(-2px);
        }

        .welcome-btn.auth {
            background: var(--soft-gold);
            color: white;
        }

        .welcome-btn.auth:hover {
            background: #C79660;
            transform: translateY(-2px);
        }

        /* Language Selection */
        .language-selector {
            text-align: center;
            margin-bottom: 40px;
            padding: 32px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(44, 62, 80, 0.08);
        }

        .language-selector h2 {
            margin-bottom: 24px;
            color: var(--charcoal);
            font-size: 1.6rem;
            font-weight: 600;
        }

        .language-buttons {
            display: flex;
            gap: 24px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .language-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 40px;
            background: var(--sage-green);
            color: white;
            border: none;
            border-radius: 16px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            min-width: 200px;
            box-shadow: 0 6px 20px rgba(107, 142, 107, 0.25);
        }

        .language-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(107, 142, 107, 0.35);
        }

        .language-btn.active {
            background: var(--soft-gold);
            transform: translateY(-2px);
        }

        .language-btn .flag {
            font-size: 2rem;
            margin-bottom: 12px;
        }

        .language-btn small {
            margin-top: 8px;
            opacity: 0.9;
        }

        /* Progress Container */
        .progress-container {
            background: white;
            border-radius: 20px;
            padding: 32px;
            margin-bottom: 32px;
            box-shadow: 0 8px 32px rgba(44, 62, 80, 0.08);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .step-counter {
            font-weight: 700;
            color: var(--sage-green);
            font-size: 1.3rem;
        }

        .overall-progress {
            width: 100%;
            height: 12px;
            background: var(--light-sage);
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 32px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--sage-green), var(--deep-teal));
            transition: width 0.5s ease;
            border-radius: 6px;
            width: 10%;
        }

        .progress-bar {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 8px;
            margin-bottom: 0;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 12px 8px;
            border-radius: 12px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--sage-alpha);
        }
        
        .progress-step:hover {
            background: var(--teal-alpha);
            transform: translateY(-2px);
        }

        .progress-step.active {
            background: var(--step-current);
            color: white;
        }

        .progress-step.completed {
            background: var(--step-completed);
            color: white;
        }

        .progress-step.pending {
            background: var(--step-pending);
            color: white;
        }

        .step-number {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-bottom: 8px;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .progress-step.active .step-number {
            background: rgba(255, 255, 255, 0.3);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .step-text {
            font-size: 0.7rem;
            text-align: center;
            font-weight: 600;
            line-height: 1.2;
        }

        /* Main Card */
        .main-card {
            background: white;
            border-radius: 24px;
            box-shadow: 0 16px 48px rgba(44, 62, 80, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, var(--sage-green), var(--deep-teal));
            color: white;
            padding: 60px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: shimmer 8s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(180deg); }
        }

        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            margin-bottom: 16px;
            position: relative;
            z-index: 1;
            font-weight: 600;
        }

        .header .subtitle {
            font-size: 1.3rem;
            opacity: 0.95;
            position: relative;
            z-index: 1;
            font-weight: 400;
        }

        .badge {
            display: inline-block;
            background: var(--soft-gold);
            color: white;
            padding: 12px 28px;
            border-radius: 30px;
            font-weight: 700;
            margin-top: 24px;
            font-size: 1rem;
            position: relative;
            z-index: 1;
        }

        .header .cta-section {
            margin-top: 40px;
            position: relative;
            z-index: 1;
        }

        .btn-current {
            background: linear-gradient(135deg, var(--soft-gold), #C79660);
            color: white;
            box-shadow: 0 8px 24px rgba(212, 165, 116, 0.3);
            font-size: 1.2rem;
            padding: 20px 40px;
            border-radius: 50px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-current:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(212, 165, 116, 0.4);
        }

        .content {
            padding: 50px 40px;
        }

        .step-description {
            background: var(--light-sage);
            padding: 32px;
            border-radius: 16px;
            margin-bottom: 40px;
            border-left: 6px solid var(--sage-green);
        }

        .step-description h2 {
            font-family: 'Playfair Display', serif;
            color: var(--charcoal);
            margin-bottom: 16px;
            font-size: 2rem;
            font-weight: 600;
        }

        .step-description p {
            color: var(--charcoal);
            font-size: 1.1rem;
            opacity: 0.8;
        }

        .empowerment-message {
            background: linear-gradient(135deg, var(--gold-alpha), rgba(212, 165, 116, 0.15));
            border: 2px solid var(--soft-gold);
            border-radius: 20px;
            padding: 32px;
            margin: 32px 0;
            text-align: center;
        }

        .empowerment-title {
            color: var(--charcoal);
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 16px;
            font-family: 'Playfair Display', serif;
        }

        .empowerment-text {
            color: var(--charcoal);
            line-height: 1.7;
            opacity: 0.9;
        }

        /* Form Sections */
        .form-section {
            margin-bottom: 40px;
            padding: 40px;
            background: white;
            border-radius: 20px;
            border: 2px solid var(--light-sage);
            box-shadow: 0 4px 16px rgba(107, 142, 107, 0.08);
        }

        .form-section h2 {
            font-family: 'Playfair Display', serif;
            color: var(--charcoal);
            margin-bottom: 32px;
            font-size: 1.8rem;
            font-weight: 600;
            text-align: center;
        }

        .form-group {
            margin-bottom: 28px;
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 12px;
            font-weight: 600;
            color: var(--charcoal);
            font-size: 1rem;
        }

        .required {
            color: var(--soft-gold);
            margin-left: 4px;
        }

        .form-control {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--light-sage);
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
            background: var(--warm-cream);
            resize: vertical;
        }

        .form-control:focus {
            outline: none;
            border-color: var(--sage-green);
            box-shadow: 0 0 0 4px var(--sage-alpha);
            background: white;
        }

        .validation-message {
            margin-top: 8px;
            font-size: 14px;
            color: #e57373;
        }

        .validation-message.success {
            color: var(--sage-green);
        }

        .char-counter {
            text-align: right;
            font-size: 12px;
            color: var(--charcoal);
            opacity: 0.6;
            margin-top: 4px;
        }

        /* AI Workflow Section */
        .ai-section {
            background: linear-gradient(135deg, var(--sage-alpha), var(--teal-alpha));
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
            border: 2px solid var(--sage-green);
        }

        .ai-section h2 {
            font-family: 'Playfair Display', serif;
            color: var(--charcoal);
            margin-bottom: 24px;
            font-size: 1.8rem;
            text-align: center;
        }

        .ai-workflow {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 30px 0;
        }

        .ai-platform {
            background: white;
            border-radius: 16px;
            padding: 30px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.1);
            text-align: center;
            transition: transform 0.3s ease;
        }

        .ai-platform:hover {
            transform: translateY(-5px);
        }

        .ai-platform .icon {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        .ai-platform h3 {
            color: var(--charcoal);
            margin-bottom: 16px;
            font-size: 1.3rem;
        }

        .ai-platform .prompt-box {
            background: var(--warm-cream);
            border: 1px solid var(--light-sage);
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
            font-size: 14px;
            text-align: left;
            max-height: 120px;
            overflow-y: auto;
            word-wrap: break-word;
        }

        .ai-platform .response-area {
            width: 100%;
            min-height: 120px;
            margin: 16px 0;
            padding: 16px;
            border: 2px solid var(--light-sage);
            border-radius: 8px;
            resize: vertical;
        }

        .copy-btn {
            background: var(--sage-green);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 12px;
            margin: 8px 4px;
            transition: background 0.3s ease;
        }

        .copy-btn:hover {
            background: #5A7A5A;
        }

        .open-ai-btn {
            background: var(--deep-teal);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            margin: 8px 4px;
            transition: all 0.3s ease;
        }

        .open-ai-btn:hover {
            background: #1E3D47;
            transform: translateY(-2px);
        }

        /* Calendar Section */
        .calendar-section {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
            box-shadow: 0 8px 32px rgba(44, 62, 80, 0.08);
        }

        .calendar-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 16px;
        }

        .week-nav {
            display: flex;
            gap: 12px;
            align-items: center;
        }

        .week-nav button {
            background: var(--sage-green);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .week-nav button:hover:not(:disabled) {
            background: #5A7A5A;
            transform: translateY(-2px);
        }

        .week-nav button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .week-display {
            background: var(--light-sage);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .week-title {
            font-size: 1.4rem;
            font-weight: 700;
            color: var(--charcoal);
            margin-bottom: 12px;
        }

        .task-list {
            list-style: none;
            padding: 0;
        }

        .task-item {
            display: flex;
            align-items: center;
            padding: 12px;
            margin: 8px 0;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
            transition: all 0.3s ease;
        }

        .task-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.1);
        }

        .task-item.completed {
            opacity: 0.6;
            text-decoration: line-through;
        }

        .task-checkbox {
            margin-right: 12px;
            transform: scale(1.2);
            cursor: pointer;
        }

        .progress-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }

        .stat-card {
            background: var(--sage-alpha);
            padding: 20px;
            border-radius: 12px;
            text-align: center;
        }

        .stat-number {
            font-size: 2rem;
            font-weight: 700;
            color: var(--sage-green);
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--charcoal);
            opacity: 0.8;
        }

        /* Payment Section */
        .payment-section {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin: 40px 0;
            box-shadow: 0 8px 32px rgba(44, 62, 80, 0.08);
        }

        .payment-tiers {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 30px;
            margin: 30px 0;
        }

        .payment-tier {
            background: white;
            border: 2px solid var(--light-sage);
            border-radius: 16px;
            padding: 30px;
            text-align: center;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .payment-tier:hover {
            transform: translateY(-5px);
            border-color: var(--sage-green);
            box-shadow: 0 12px 32px rgba(107, 142, 107, 0.2);
        }

        .payment-tier.featured {
            border-color: var(--soft-gold);
            background: linear-gradient(135deg, var(--gold-alpha), rgba(212, 165, 116, 0.05));
        }

        .payment-tier.featured::before {
            content: 'Most Popular';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            background: var(--soft-gold);
            color: white;
            padding: 8px;
            font-size: 12px;
            font-weight: 700;
            text-transform: uppercase;
        }

        .tier-price {
            font-size: 3rem;
            font-weight: 700;
            color: var(--sage-green);
            margin: 16px 0;
        }

        .tier-price::before {
            content: '$';
            font-size: 1.5rem;
            vertical-align: super;
        }

        .tier-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: var(--charcoal);
            margin-bottom: 16px;
        }

        .tier-description {
            color: var(--charcoal);
            opacity: 0.8;
            margin-bottom: 24px;
            font-size: 0.9rem;
        }

        .tier-features {
            list-style: none;
            padding: 0;
            margin: 24px 0;
            text-align: left;
        }

        .tier-features li {
            padding: 8px 0;
            position: relative;
            padding-left: 24px;
        }

        .tier-features li::before {
            content: '✓';
            position: absolute;
            left: 0;
            color: var(--sage-green);
            font-weight: 700;
        }

        .tier-button {
            background: var(--sage-green);
            color: white;
            border: none;
            padding: 16px 32px;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            width: 100%;
        }

        .tier-button:hover {
            background: #5A7A5A;
            transform: translateY(-2px);
        }

        .tier-button.featured {
            background: var(--soft-gold);
        }

        .tier-button.featured:hover {
            background: #C79660;
        }

        /* Path Selection */
        .path-selection {
            margin: 50px 0;
            text-align: center;
        }

        .path-selection h2 {
            font-family: 'Playfair Display', serif;
            color: var(--charcoal);
            margin-bottom: 40px;
            font-size: 2.2rem;
            font-weight: 600;
        }

        .path-options {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }

        .path-option {
            background: var(--warm-cream);
            border-radius: 20px;
            padding: 40px 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
            position: relative;
            text-align: center;
        }

        .path-option:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(107, 142, 107, 0.2);
            border-color: var(--sage-green);
        }

        .path-option.selected {
            border-color: var(--soft-gold);
            background: white;
            transform: translateY(-3px);
            box-shadow: 0 12px 36px rgba(212, 165, 116, 0.25);
        }

        .path-icon {
            font-size: 3rem;
            margin-bottom: 20px;
            display: block;
        }

        .path-title {
            font-family: 'Playfair Display', serif;
            font-size: 1.5rem;
            font-weight: 600;
            color: var(--charcoal);
            margin-bottom: 16px;
        }

        .path-description {
            color: var(--charcoal);
            opacity: 0.8;
            line-height: 1.6;
            font-size: 0.95rem;
        }

        /* Navigation Buttons */
        .nav-buttons {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 40px 0;
            gap: 20px;
        }

        .nav-btn {
            padding: 16px 32px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 150px;
        }

        .nav-btn.back {
            background: var(--button-back);
            color: white;
        }

        .nav-btn.back:hover {
            background: #c0392b;
            transform: translateY(-2px);
        }

        .nav-btn.next {
            background: var(--button-next);
            color: white;
        }

        .nav-btn.next:hover {
            background: #27ae60;
            transform: translateY(-2px);
        }

        .nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none !important;
        }

        /* Success Message */
        .success-message {
            background: linear-gradient(135deg, var(--sage-green), var(--deep-teal));
            color: white;
            padding: 60px 40px;
            text-align: center;
            border-radius: 24px;
            margin: 40px 0;
        }

        .success-message h2 {
            font-family: 'Playfair Display', serif;
            font-size: 2.5rem;
            margin-bottom: 20px;
        }

        .success-message p {
            font-size: 1.2rem;
            margin-bottom: 30px;
            opacity: 0.9;
        }

        .success-actions {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 40px;
            flex-wrap: wrap;
        }

        .success-btn {
            background: var(--soft-gold);
            color: white;
            padding: 18px 36px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
        }

        .success-btn:hover {
            background: #C79660;
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(212, 165, 116, 0.3);
        }

        .success-btn.primary {
            background: var(--button-next);
        }

        /* Step Content Areas */
        .step-content {
            margin-bottom: 40px;
        }

        .step-content.hidden {
            display: none;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .container {
                padding: 0 16px;
            }
            
            .header h1 {
                font-size: 2.2rem;
            }
            
            .header .subtitle {
                font-size: 1.1rem;
            }
            
            .content {
                padding: 30px 20px;
            }
            
            .progress-bar {
                grid-template-columns: repeat(5, 1fr);
                gap: 4px;
            }

            .progress-step {
                padding: 8px 4px;
            }

            .step-text {
                font-size: 0.6rem;
            }

            .step-number {
                width: 28px;
                height: 28px;
                font-size: 12px;
            }

            .language-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .language-btn {
                min-width: 280px;
            }

            .welcome-content {
                padding: 40px 30px;
            }

            .welcome-buttons {
                flex-direction: column;
            }

            .form-control {
                font-size: 16px;
                padding: 18px;
            }

            .auth-content {
                padding: 30px 20px;
            }

            .path-options {
                grid-template-columns: 1fr;
                gap: 20px;
            }

            .path-option {
                padding: 30px 20px;
            }

            .form-section {
                padding: 30px 20px;
            }

            .user-status-bar {
                flex-direction: column;
                align-items: flex-start;
                gap: 12px;
            }

            .user-actions {
                width: 100%;
                justify-content: space-between;
            }

            .success-actions {
                flex-direction: column;
                align-items: center;
            }

            .success-btn {
                min-width: 100%;
                max-width: 300px;
            }

            .nav-buttons {
                flex-direction: column;
            }

            .nav-btn {
                width: 100%;
            }

            .ai-workflow {
                grid-template-columns: 1fr;
            }

            .payment-tiers {
                grid-template-columns: 1fr;
            }

            .calendar-controls {
                flex-direction: column;
                align-items: stretch;
            }

            .week-nav {
                justify-content: center;
            }

            .progress-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .hidden {
            display: none !important;
        }
    </style>
</head>
<body>
    <!-- Authentication Modal -->
    <div id="authModal" class="auth-modal">
        <div class="auth-content">
            <button class="auth-close" onclick="closeAuthModal()">&times;</button>
            <h2 class="auth-title" id="authTitle">Create Your Account</h2>
            
            <div id="authError" class="auth-error hidden"></div>
            <div id="authSuccess" class="auth-success hidden"></div>
            
            <form class="auth-form" id="authForm">
                <input type="text" id="authName" class="auth-input" placeholder="Your Name" style="display: none;">
                <input type="email" id="authEmail" class="auth-input" placeholder="Email Address" required>
                <input type="password" id="authPassword" class="auth-input" placeholder="Password" required>
                <input type="password" id="authConfirmPassword" class="auth-input" placeholder="Confirm Password" style="display: none;">
                
                <button type="submit" class="auth-button" id="authSubmitBtn">
                    <span id="authSubmitText">Create Account</span>
                </button>
            </form>
            
            <div class="auth-switch">
                <span id="authSwitchText">Already have an account?</span>
                <span class="auth-link" id="authSwitchLink" onclick="toggleAuthMode()">Sign In</span>
            </div>
        </div>
    </div>

    <!-- Welcome Modal -->
    <div id="welcomeModal" class="welcome-modal">
        <div class="welcome-content">
            <h2 id="welcomeTitle">Welcome to Smart Mom Method!</h2>
            <p id="welcomeDescription">Create your personalized interactive calendar and business plan in 10 comprehensive steps. This process will take approximately 30-40 minutes and will generate a complete interactive calendar and business strategy tailored specifically for busy moms like you.</p>
            <div class="welcome-buttons">
                <button class="welcome-btn primary" onclick="startOnboarding()">
                    <span id="welcomeStart">Get Started</span>
                </button>
                <button class="welcome-btn auth" onclick="showAuthModal('signup')">
                    <span id="welcomeCreate">Create Account & Save Progress</span>
                </button>
                <button class="welcome-btn secondary" onclick="handleReturningUser()">
                    <span id="welcomeReturning">I'm a returning user</span>
                </button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- User Status Bar -->
        <div id="userStatusBar" class="user-status-bar hidden">
            <div class="user-info">
                <div class="user-avatar" id="userAvatar">?</div>
                <div class="user-details">
                    <h4 id="userDisplayName">Guest User</h4>
                    <p id="userStatusText">Progress will not be saved</p>
                </div>
            </div>
            <div class="user-actions">
                <div class="status-badge guest" id="statusBadge">Guest Mode</div>
                <button onclick="showAuthModal('signup')" style="background: var(--sage-green); color: white; border: none; padding: 8px 16px; border-radius: 8px; font-size: 14px; cursor: pointer;">
                    Save Progress
                </button>
                <button id="signOutBtn" onclick="signOut()" style="background: none; border: 1px solid var(--charcoal); color: var(--charcoal); padding: 8px 16px; border-radius: 8px; font-size: 14px; cursor: pointer; display: none;">
                    Sign Out
                </button>
            </div>
        </div>

        <!-- Connection Status Notice -->
        <div id="connectionNotice" class="hidden" style="background: #fff3cd; border: 1px solid #ffeaa7; color: #856404; padding: 12px 20px; border-radius: 8px; margin-bottom: 20px; text-align: center; font-size: 14px;">
            <strong>📡 Local Mode:</strong> Server connection unavailable. Your data will be stored locally on this device.
        </div>

        <!-- Progress Container -->
        <div class="progress-container">
            <div class="progress-header">
                <div class="step-counter" id="stepCounter">Step 1 of 10</div>
            </div>
            <div class="overall-progress">
                <div class="progress-fill" id="progressFill"></div>
            </div>
            <div class="progress-bar">
                <div class="progress-step active" id="step-1">
                    <span class="step-number">1</span>
                    <span class="step-text" id="stepText1">Language</span>
                </div>
                <div class="progress-step pending" id="step-2">
                    <span class="step-number">2</span>
                    <span class="step-text" id="stepText2">Basic Info</span>
                </div>
                <div class="progress-step pending" id="step-3">
                    <span class="step-number">3</span>
                    <span class="step-text" id="stepText3">Path Select</span>
                </div>
                <div class="progress-step pending" id="step-4">
                    <span class="step-number">4</span>
                    <span class="step-text" id="stepText4">Family</span>
                </div>
                <div class="progress-step pending" id="step-5">
                    <span class="step-number">5</span>
                    <span class="step-text" id="stepText5">Schedule</span>
                </div>
                <div class="progress-step pending" id="step-6">
                    <span class="step-number">6</span>
                    <span class="step-text" id="stepText6">Investment</span>
                </div>
                <div class="progress-step pending" id="step-7">
                    <span class="step-number">7</span>
                    <span class="step-text" id="stepText7">AI Ideas</span>
                </div>
                <div class="progress-step pending" id="step-8">
                    <span class="step-number">8</span>
                    <span class="step-text" id="stepText8">Research</span>
                </div>
                <div class="progress-step pending" id="step-9">
                    <span class="step-number">9</span>
                    <span class="step-text" id="stepText9">Calendar</span>
                </div>
                <div class="progress-step pending" id="step-10">
                    <span class="step-number">10</span>
                    <span class="step-text" id="stepText10">Dashboard</span>
                </div>
            </div>
        </div>

        <div class="main-card">
            <div class="header">
                <h1 id="mainTitle">Smart Mom Method</h1>
                <p class="subtitle" id="mainSubtitle">AI-Powered Interactive Calendar & Business Planning for Busy Moms</p>
                <span class="badge" id="freeBadge">100% Free</span>
                
                <div class="cta-section">
                    <button class="btn-current" onclick="scrollToCurrentStep()">
                        <span id="ctaButton">Start Your Free Interactive Calendar & Business Plan Now</span>
                    </button>
                    <p style="margin-top: 16px; font-size: 0.95rem; opacity: 0.9;" id="ctaSubtext">No email required to browse • Full process takes 30 minutes</p>
                </div>
            </div>

            <div class="content">
                <!-- Step 1: Language Selection -->
                <div id="step1Content" class="step-content">
                    <div class="language-selector">
                        <h2 id="languageTitle">Choose Your Language / Elige Tu Idioma</h2>
                        <div class="language-buttons">
                            <button class="language-btn active" onclick="changeLanguage('en')" id="lang-en">
                                <span class="flag">🇺🇸</span>
                                <span>English</span>
                                <small>Read and answer everything in English</small>
                            </button>
                            <button class="language-btn" onclick="changeLanguage('es')" id="lang-es">
                                <span class="flag">🇪🇸</span>
                                <span>Español</span>
                                <small>Lee y responde todo en español</small>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Step 2: Basic Information -->
                <div id="step2Content" class="step-content hidden">
                    <div class="step-description">
                        <h2 id="stepDesc2Title">Basic Information</h2>
                        <p id="stepDesc2Text">Let's get to know you better so we can create the perfect interactive calendar and business plan for your unique situation.</p>
                    </div>

                    <div class="form-section">
                        <h2 id="basicInfoTitle">Your Information</h2>
                        
                        <div class="form-group">
                            <label id="nameLabel">Your Name: <span class="required">*</span></label>
                            <input type="text" id="user-name" class="form-control" placeholder="Enter your name" onchange="validateField(this)" />
                            <div class="validation-message" id="user-name-validation"></div>
                        </div>

                        <div class="form-group">
                            <label id="emailLabel">Your Email: <span class="required">*</span></label>
                            <input type="email" id="user-email" class="form-control" placeholder="your.email@example.com" onchange="validateField(this)" />
                            <div class="validation-message" id="user-email-validation"></div>
                        </div>
                    </div>

                    <div class="empowerment-message">
                        <div class="empowerment-title" id="empowermentTitle">You're Already Successful!</div>
                        <p class="empowerment-text" id="empowermentText">Managing a family is running a complex organization. You have negotiation skills, time management expertise, and crisis resolution abilities that most CEOs would envy. Now let's channel that into YOUR organized life and successful business!</p>
                    </div>
                </div>

                <!-- Step 3: Path Selection -->
                <div id="step3Content" class="step-content hidden">
                    <div class="step-description">
                        <h2 id="stepDesc3Title">Choose Your Focus</h2>
                        <p id="stepDesc3Text">What brings you here today? Choose your main focus so we can customize your experience.</p>
                    </div>

                    <div class="path-selection">
                        <h2 id="pathSelectionTitle">Select Your Path:</h2>
                        
                        <div class="path-options">
                            <div class="path-option" data-path="life-organization" onclick="selectPath('life-organization')">
                                <span class="path-icon">🏠</span>
                                <h3 class="path-title" id="pathTitle1">Life Organization</h3>
                                <p class="path-description" id="pathDesc1">I need help organizing my daily life, family schedules, and home systems</p>
                            </div>
                            
                            <div class="path-option" data-path="business-launch" onclick="selectPath('business-launch')">
                                <span class="path-icon">💼</span>
                                <h3 class="path-title" id="pathTitle2">Business Launch</h3>
                                <p class="path-description" id="pathDesc2">I want to start a business or create passive income streams</p>
                            </div>
                            
                            <div class="path-option" data-path="both" onclick="selectPath('both')">
                                <span class="path-icon">☀️</span>
                                <h3 class="path-title" id="pathTitle3">Both Life & Business</h3>
                                <p class="path-description" id="pathDesc3">I need life organization AND want to start a business</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 4: Family Structure -->
                <div id="step4Content" class="step-content hidden">
                    <div class="step-description">
                        <h2 id="stepDesc4Title">Family Structure</h2>
                        <p id="stepDesc4Text">Understanding your family situation helps us create realistic recommendations that fit your actual life.</p>
                    </div>

                    <div class="form-section">
                        <h2 id="familyStructureTitle">Tell Us About Your Family</h2>
                        
                        <div class="form-group">
                            <label id="familyStructureLabel">Describe your family structure: <span class="required">*</span></label>
                            <textarea id="family-structure" class="form-control" maxlength="1000" 
                                      placeholder="Tell us about your family size, ages of children, support system, partner situation, etc. Be as detailed as you'd like - this helps us give you better recommendations."
                                      onchange="validateField(this)" oninput="updateCharCounter(this)"></textarea>
                            <div class="char-counter">
                                <span id="family-structure-counter">1000 characters remaining</span>
                            </div>
                            <div class="validation-message" id="family-structure-validation"></div>
                        </div>
                    </div>
                </div>

                <!-- Step 5: Daily Schedule -->
                <div id="step5Content" class="step-content hidden">
                    <div class="step-description">
                        <h2 id="stepDesc5Title">Daily Schedule</h2>
                        <p id="stepDesc5Text">Your daily routine determines what's realistic for your business and organization goals.</p>
                    </div>

                    <div class="form-section">
                        <h2 id="dailyScheduleTitle">Describe Your Typical Day</h2>
                        
                        <div class="form-group">
                            <label id="dailyScheduleLabel">What does your typical daily schedule look like? <span class="required">*</span></label>
                            <textarea id="daily-schedule" class="form-control" maxlength="1000" 
                                      placeholder="Describe your typical day from morning to night. Include work schedule, kids' activities, household responsibilities, available free time, etc."
                                      onchange="validateField(this)" oninput="updateCharCounter(this)"></textarea>
                            <div class="char-counter">
                                <span id="daily-schedule-counter">1000 characters remaining</span>
                            </div>
                            <div class="validation-message" id="daily-schedule-validation"></div>
                        </div>
                    </div>
                </div>

                <!-- Step 6: Investment & Timeline -->
                <div id="step6Content" class="step-content hidden">
                    <div class="step-description">
                        <h2 id="stepDesc6Title">Investment & Timeline</h2>
                        <p id="stepDesc6Text">Understanding your budget and timeline helps us recommend realistic business options.</p>
                    </div>

                    <div class="form-section">
                        <h2 id="investmentTitle">Investment Level & Timeline</h2>
                        
                        <div class="form-group">
                            <label id="investmentLevelLabel">How much can you invest to start? <span class="required">*</span></label>
                            <select id="investment-level" class="form-control" onchange="validateField(this)">
                                <option value="">Choose your investment level...</option>
                                <option value="no-money">No money to invest ($0)</option>
                                <option value="minimal">Minimal investment ($1-$500)</option>
                                <option value="moderate">Moderate investment ($500-$2000)</option>
                                <option value="flexible">Flexible budget ($2000+)</option>
                            </select>
                            <div class="validation-message" id="investment-level-validation"></div>
                        </div>

                        <div class="form-group">
                            <label id="incomeTimelineLabel">When do you need income? <span class="required">*</span></label>
                            <select id="income-timeline" class="form-control" onchange="validateField(this)">
                                <option value="">Choose your timeline...</option>
                                <option value="immediate">Need income immediately (0-3 months)</option>
                                <option value="moderate">Income needed soon (3-6 months)</option>
                                <option value="patient">Can wait for income (6-12 months)</option>
                                <option value="long-term">Long-term planning (12+ months)</option>
                            </select>
                            <div class="validation-message" id="income-timeline-validation"></div>
                        </div>
                    </div>
                </div>

                <!-- Step 7: AI Business Ideas -->
                <div id="step7Content" class="step-content hidden">
                    <div class="step-description">
                        <h2 id="stepDesc7Title">AI Business Ideas</h2>
                        <p id="stepDesc7Text">We'll use ChatGPT to generate personalized business ideas based on your specific situation.</p>
                    </div>

                    <div class="ai-section">
                        <h2>🤖 ChatGPT Business Ideas Generator</h2>
                        
                        <div class="ai-workflow">
                            <div class="ai-platform">
                                <div class="icon">🚀</div>
                                <h3>Step 1: Get AI Ideas</h3>
                                
                                <div class="prompt-box" id="chatgptPrompt">
                                    Loading personalized prompt...
                                </div>
                                
                                <div style="margin: 16px 0;">
                                    <button class="copy-btn" onclick="copyPrompt('chatgpt')">Copy Prompt</button>
                                    <button class="open-ai-btn" onclick="openAI('chatgpt')">Open ChatGPT</button>
                                </div>
                                
                                <label>Paste ChatGPT's response here:</label>
                                <textarea class="response-area" id="chatgpt-response" 
                                          placeholder="Copy and paste the business ideas from ChatGPT here..."
                                          onchange="saveAIResponse('chatgpt', this.value)"></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 8: Market Research -->
                <div id="step8Content" class="step-content hidden">
                    <div class="step-description">
                        <h2 id="stepDesc8Title">Market Research</h2>
                        <p id="stepDesc8Text">Now we'll use Google Gemini to research the market for your chosen business idea.</p>
                    </div>

                    <div class="ai-section">
                        <h2>📊 Gemini Market Research</h2>
                        
                        <div class="ai-workflow">
                            <div class="ai-platform">
                                <div class="icon">📈</div>
                                <h3>Step 2: Market Analysis</h3>
                                
                                <div class="prompt-box" id="geminiPrompt">
                                    Select a business idea from Step 7 first...
                                </div>
                                
                                <div style="margin: 16px 0;">
                                    <label>Choose your favorite business idea from ChatGPT:</label>
                                    <input type="text" id="selected-business-idea" class="form-control" 
                                           placeholder="Type or paste your chosen business idea here..."
                                           onchange="updateGeminiPrompt(this.value)">
                                </div>
                                
                                <div style="margin: 16px 0;">
                                    <button class="copy-btn" onclick="copyPrompt('gemini')">Copy Prompt</button>
                                    <button class="open-ai-btn" onclick="openAI('gemini')">Open Gemini</button>
                                </div>
                                
                                <label>Paste Gemini's market research here:</label>
                                <textarea class="response-area" id="gemini-response" 
                                          placeholder="Copy and paste the market research from Gemini here..."
                                          onchange="saveAIResponse('gemini', this.value)"></textarea>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 9: Calendar Creation -->
                <div id="step9Content" class="step-content hidden">
                    <div class="step-description">
                        <h2 id="stepDesc9Title">Calendar Creation</h2>
                        <p id="stepDesc9Text">Finally, we'll use Claude to create your personalized 12-week implementation calendar.</p>
                    </div>

                    <div class="ai-section">
                        <h2>📅 Claude Calendar Creator</h2>
                        
                        <div class="ai-workflow">
                            <div class="ai-platform">
                                <div class="icon">🗓️</div>
                                <h3>Step 3: Implementation Calendar</h3>
                                
                                <div class="prompt-box" id="claudePrompt">
                                    Complete Steps 7 and 8 first...
                                </div>
                                
                                <div style="margin: 16px 0;">
                                    <button class="copy-btn" onclick="copyPrompt('claude')">Copy Prompt</button>
                                    <button class="open-ai-btn" onclick="openAI('claude')">Open Claude</button>
                                </div>
                                
                                <label>Paste Claude's calendar here:</label>
                                <textarea class="response-area" id="claude-response" 
                                          placeholder="Copy and paste the 12-week calendar from Claude here..."
                                          onchange="saveAIResponse('claude', this.value)"></textarea>
                                
                                <div style="margin-top: 20px;">
                                    <button class="nav-btn next" onclick="parseCalendar()" id="parseCalendarBtn" disabled>
                                        Parse Calendar & Continue
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Calendar Display -->
                    <div id="calendarDisplay" class="calendar-section hidden">
                        <h2>📅 Your Interactive 12-Week Calendar</h2>
                        
                        <div class="calendar-controls">
                            <div class="week-nav">
                                <button onclick="previousWeek()" id="prevWeekBtn" disabled>← Previous</button>
                                <span id="weekIndicator">Week 1 of 12</span>
                                <button onclick="nextWeek()" id="nextWeekBtn">Next →</button>
                            </div>
                        </div>

                        <div class="week-display" id="weekDisplay">
                            <div class="week-title" id="weekTitle">Week 1: Getting Started</div>
                            <ul class="task-list" id="taskList">
                                <!-- Tasks will be populated by JavaScript -->
                            </ul>
                        </div>

                        <div class="progress-stats">
                            <div class="stat-card">
                                <div class="stat-number" id="completedTasks">0</div>
                                <div class="stat-label">Tasks Completed</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="totalTasks">0</div>
                                <div class="stat-label">Total Tasks</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="completionPercentage">0%</div>
                                <div class="stat-label">Progress</div>
                            </div>
                            <div class="stat-card">
                                <div class="stat-number" id="currentWeekNum">1</div>
                                <div class="stat-label">Current Week</div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Step 10: Final Dashboard -->
                <div id="step10Content" class="step-content hidden">
                    <div class="step-description">
                        <h2 id="stepDesc10Title">Your Complete Business Plan</h2>
                        <p id="stepDesc10Text">Congratulations! Here's your complete personalized business plan and next steps.</p>
                    </div>

                    <!-- Payment Options -->
                    <div class="payment-section">
                        <h2>💎 Choose Your Success Plan</h2>
                        <p style="text-align: center; margin-bottom: 30px; color: var(--charcoal); opacity: 0.8;">
                            Take your business to the next level with personalized support and advanced resources.
                        </p>
                        
                        <div class="payment-tiers">
                            <div class="payment-tier">
                                <div class="tier-price">0</div>
                                <h3 class="tier-title">Free Consultation</h3>
                                <p class="tier-description">Perfect for getting started and understanding your options</p>
                                <ul class="tier-features">
                                    <li>Basic business assessment</li>
                                    <li>30-minute consultation</li>
                                    <li>General guidance</li>
                                </ul>
                                <button class="tier-button" onclick="selectPlan('free')">Book Free Consultation</button>
                            </div>

                            <div class="payment-tier">
                                <div class="tier-price">39</div>
                                <h3 class="tier-title">Starter Plan</h3>
                                <p class="tier-description">Ideal for moms ready to start their business journey</p>
                                <ul class="tier-features">
                                    <li>Complete business analysis</li>
                                    <li>AI-generated ideas</li>
                                    <li>12-week calendar</li>
                                    <li>Email support</li>
                                </ul>
                                <button class="tier-button" onclick="selectPlan('starter')">Get Starter Plan</button>
                            </div>

                            <div class="payment-tier featured">
                                <div class="tier-price">49</div>
                                <h3 class="tier-title">Growth Plan</h3>
                                <p class="tier-description">For serious entrepreneurs ready to scale</p>
                                <ul class="tier-features">
                                    <li>Everything in Starter</li>
                                    <li>Market research</li>
                                    <li>Competition analysis</li>
                                    <li>Priority support</li>
                                </ul>
                                <button class="tier-button featured" onclick="selectPlan('growth')">Choose Growth Plan</button>
                            </div>

                            <div class="payment-tier">
                                <div class="tier-price">89</div>
                                <h3 class="tier-title">Premium Plan</h3>
                                <p class="tier-description">Complete support for ambitious business goals</p>
                                <ul class="tier-features">
                                    <li>Everything in Growth</li>
                                    <li>Personal coaching call</li>
                                    <li>Custom strategy</li>
                                    <li>Advanced resources</li>
                                </ul>
                                <button class="tier-button" onclick="selectPlan('premium')">Go Premium</button>
                            </div>

                            <div class="payment-tier">
                                <div class="tier-price">100</div>
                                <h3 class="tier-title">VIP Experience</h3>
                                <p class="tier-description">Ultimate package for maximum support and success</p>
                                <ul class="tier-features">
                                    <li>Everything in Premium</li>
                                    <li>Monthly check-ins</li>
                                    <li>Direct access</li>
                                    <li>Custom modifications</li>
                                </ul>
                                <button class="tier-button" onclick="selectPlan('vip')">VIP Access</button>
                            </div>
                        </div>
                    </div>

                    <!-- Success Message -->
                    <div id="finalSuccessMessage" class="success-message">
                        <h2>🎉 Congratulations!</h2>
                        <p>Your Smart Mom Method profile and business plan have been created successfully!</p>
                        
                        <div style="background: rgba(255,255,255,0.15); padding: 30px; border-radius: 16px; margin: 30px 0;">
                            <h3 style="margin-bottom: 15px;">What You've Accomplished:</h3>
                            <ul style="list-style: none; padding: 0; text-align: left;">
                                <li style="margin: 10px 0;">✅ Completed comprehensive business assessment</li>
                                <li style="margin: 10px 0;">✅ Received AI-generated business ideas</li>
                                <li style="margin: 10px 0;">✅ Got market research insights</li>
                                <li style="margin: 10px 0;">✅ Created your 12-week implementation calendar</li>
                                <li style="margin: 10px 0;">✅ Your progress is automatically saved</li>
                            </ul>
                        </div>

                        <div class="success-actions">
                            <button class="success-btn primary" onclick="viewCompleteProfile()">
                                View Complete Profile
                            </button>
                            
                            <button class="success-btn" onclick="downloadResults()">
                                Download Your Results
                            </button>
                            
                            <button class="success-btn" onclick="startOver()">
                                Start New Assessment
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Navigation Buttons -->
                <div class="nav-buttons" id="navButtons">
                    <button class="nav-btn back" id="backBtn" onclick="previousStep()" disabled>
                        ← Previous Step
                    </button>
                    <button class="nav-btn next" id="nextBtn" onclick="nextStep()">
                        Next Step →
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // ===== GLOBAL VARIABLES =====
        let currentLanguage = 'en';
        let selectedPath = '';
        let authMode = 'signup';
        let currentUser = null;
        let formData = {};
        let currentStep = 1;
        let useLocalStorageOnly = false; // PRESERVED - DO NOT MODIFY
        let aiResponses = {
            chatgpt: '',
            gemini: '',
            claude: ''
        };
        let calendarData = null;
        let currentWeek = 1;
        let completedTasks = new Set();

        // ===== EXPANDED STEP CONFIGURATION =====
        const TOTAL_STEPS = 10;
        const stepConfig = {
            1: { title: "Language Selection", component: "language-selector" },
            2: { title: "Basic Information", component: "basic-info" },
            3: { title: "Path Selection", component: "path-selection" },
            4: { title: "Family Structure", component: "family-structure" },
            5: { title: "Daily Schedule", component: "daily-schedule" },
            6: { title: "Investment & Timeline", component: "investment-timeline" },
            7: { title: "AI Business Ideas", component: "ai-chatgpt" },
            8: { title: "Market Research", component: "ai-gemini" },
            9: { title: "Calendar Creation", component: "ai-claude" },
            10: { title: "Final Dashboard", component: "final-dashboard" }
        };

        // ===== COMPLETE TRANSLATION SYSTEM =====
        const translations = {
            en: {
                welcomeTitle: "Welcome to Smart Mom Method!",
                welcomeDescription: "Create your personalized interactive calendar and business plan in 10 comprehensive steps. This process will take approximately 30-40 minutes and will generate a complete interactive calendar and business strategy tailored specifically for busy moms like you.",
                welcomeStart: "Get Started",
                welcomeCreate: "Create Account & Save Progress",
                welcomeReturning: "I'm a returning user",
                mainTitle: "Smart Mom Method",
                mainSubtitle: "AI-Powered Interactive Calendar & Business Planning for Busy Moms",
                freeBadge: "100% Free",
                ctaButton: "Start Your Free Interactive Calendar & Business Plan Now",
                ctaSubtext: "No email required to browse • Full process takes 30 minutes",
                languageTitle: "Choose Your Language / Elige Tu Idioma",
                stepDesc2Title: "Basic Information",
                stepDesc2Text: "Let's get to know you better so we can create the perfect interactive calendar and business plan for your unique situation.",
                basicInfoTitle: "Your Information",
                nameLabel: "Your Name:",
                emailLabel: "Your Email:",
                empowermentTitle: "You're Already Successful!",
                empowermentText: "Managing a family is running a complex organization. You have negotiation skills, time management expertise, and crisis resolution abilities that most CEOs would envy. Now let's channel that into YOUR organized life and successful business!",
                stepDesc3Title: "Choose Your Focus",
                stepDesc3Text: "What brings you here today? Choose your main focus so we can customize your experience.",
                pathSelectionTitle: "Select Your Path:",
                pathTitle1: "Life Organization",
                pathDesc1: "I need help organizing my daily life, family schedules, and home systems",
                pathTitle2: "Business Launch",
                pathDesc2: "I want to start a business or create passive income streams",
                pathTitle3: "Both Life & Business",
                pathDesc3: "I need life organization AND want to start a business",
                stepDesc4Title: "Family Structure",
                stepDesc4Text: "Understanding your family situation helps us create realistic recommendations that fit your actual life.",
                familyStructureTitle: "Tell Us About Your Family",
                familyStructureLabel: "Describe your family structure:",
                stepDesc5Title: "Daily Schedule",
                stepDesc5Text: "Your daily routine determines what's realistic for your business and organization goals.",
                dailyScheduleTitle: "Describe Your Typical Day",
                dailyScheduleLabel: "What does your typical daily schedule look like?",
                stepDesc6Title: "Investment & Timeline",
                stepDesc6Text: "Understanding your budget and timeline helps us recommend realistic business options.",
                investmentTitle: "Investment Level & Timeline",
                investmentLevelLabel: "How much can you invest to start?",
                incomeTimelineLabel: "When do you need income?",
                stepDesc7Title: "AI Business Ideas",
                stepDesc7Text: "We'll use ChatGPT to generate personalized business ideas based on your specific situation.",
                stepDesc8Title: "Market Research",
                stepDesc8Text: "Now we'll use Google Gemini to research the market for your chosen business idea.",
                stepDesc9Title: "Calendar Creation",
                stepDesc9Text: "Finally, we'll use Claude to create your personalized 12-week implementation calendar.",
                stepDesc10Title: "Your Complete Business Plan",
                stepDesc10Text: "Congratulations! Here's your complete personalized business plan and next steps."
            },
            es: {
                welcomeTitle: "¡Bienvenida al Método Smart Mom!",
                welcomeDescription: "Crea tu calendario interactivo personalizado y plan de negocio en 10 pasos completos. Este proceso tomará aproximadamente 30-40 minutos y generará un calendario interactivo completo y estrategia de negocio diseñada específicamente para madres ocupadas como tú.",
                welcomeStart: "Comenzar",
                welcomeCreate: "Crear Cuenta y Guardar Progreso",
                welcomeReturning: "Soy usuario que regresa",
                mainTitle: "Método Smart Mom",
                mainSubtitle: "Calendario Interactivo y Planificación de Negocios con IA para Madres Ocupadas",
                freeBadge: "100% Gratis",
                ctaButton: "Comienza Tu Calendario Interactivo y Plan de Negocio Gratis Ahora",
                ctaSubtext: "No se requiere email para navegar • El proceso completo toma 30 minutos",
                languageTitle: "Choose Your Language / Elige Tu Idioma",
                stepDesc2Title: "Información Básica",
                stepDesc2Text: "Conozcámonos mejor para crear el calendario interactivo y plan de negocio perfecto para tu situación única.",
                basicInfoTitle: "Tu Información",
                nameLabel: "Tu Nombre:",
                emailLabel: "Tu Email:",
                empowermentTitle: "¡Ya Eres Exitosa!",
                empowermentText: "Manejar una familia es dirigir una organización compleja. Tienes habilidades de negociación, experiencia en gestión del tiempo y capacidades de resolución de crisis que la mayoría de los CEOs envidiarían. ¡Ahora canalicemos eso hacia TU vida organizada y negocio exitoso!",
                stepDesc3Title: "Elige Tu Enfoque",
                stepDesc3Text: "¿Qué te trae aquí hoy? Elige tu enfoque principal para que podamos personalizar tu experiencia.",
                pathSelectionTitle: "Selecciona Tu Camino:",
                pathTitle1: "Organización de Vida",
                pathDesc1: "Necesito ayuda organizando mi vida diaria, horarios familiares y sistemas del hogar",
                pathTitle2: "Lanzamiento de Negocio",
                pathDesc2: "Quiero comenzar un negocio o crear fuentes de ingresos pasivos",
                pathTitle3: "Vida y Negocio",
                pathDesc3: "Necesito organización de vida Y quiero comenzar un negocio",
                stepDesc4Title: "Estructura Familiar",
                stepDesc4Text: "Entender tu situación familiar nos ayuda a crear recomendaciones realistas que se ajusten a tu vida real.",
                familyStructureTitle: "Cuéntanos Sobre Tu Familia",
                familyStructureLabel: "Describe la estructura de tu familia:",
                stepDesc5Title: "Horario Diario",
                stepDesc5Text: "Tu rutina diaria determina qué es realista para tus objetivos de negocio y organización.",
                dailyScheduleTitle: "Describe Tu Día Típico",
                dailyScheduleLabel: "¿Cómo se ve tu horario diario típico?",
                stepDesc6Title: "Inversión y Cronograma",
                stepDesc6Text: "Entender tu presupuesto y cronograma nos ayuda a recomendar opciones de negocio realistas.",
                investmentTitle: "Nivel de Inversión y Cronograma",
                investmentLevelLabel: "¿Cuánto puedes invertir para comenzar?",
                incomeTimelineLabel: "¿Cuándo necesitas ingresos?",
                stepDesc7Title: "Ideas de Negocio con IA",
                stepDesc7Text: "Usaremos ChatGPT para generar ideas de negocio personalizadas basadas en tu situación específica.",
                stepDesc8Title: "Investigación de Mercado",
                stepDesc8Text: "Ahora usaremos Google Gemini para investigar el mercado de tu idea de negocio elegida.",
                stepDesc9Title: "Creación de Calendario",
                stepDesc9Text: "Finalmente, usaremos Claude para crear tu calendario de implementación personalizado de 12 semanas.",
                stepDesc10Title: "Tu Plan de Negocio Completo",
                stepDesc10Text: "¡Felicitaciones! Aquí está tu plan de negocio personalizado completo y próximos pasos."
            }
        };

        // ===== AI PLATFORM CONFIGURATION =====
        const AI_PLATFORMS = {
            chatgpt: 'https://chat.openai.com',
            gemini: 'https://gemini.google.com',
            claude: 'https://claude.ai'
        };

        // ===== PRESERVED USER MANAGEMENT FUNCTIONS =====
        
        function getLocalUsers() {
            try {
                const data = localStorage.getItem('smartMomUsers');
                if (!data || data === 'null' || data === 'undefined') {
                    return [];
                }
                const parsed = JSON.parse(data);
                return Array.isArray(parsed) ? parsed : [];
            } catch (error) {
                console.warn('Error parsing local users, resetting:', error);
                localStorage.removeItem('smartMomUsers');
                return [];
            }
        }

        function saveLocalUser(userData) {
            try {
                const users = getLocalUsers();
                
                const existingIndex = users.findIndex(user => user.email === userData.email);
                if (existingIndex !== -1) {
                    throw new Error('User already exists');
                }
                
                users.push(userData);
                localStorage.setItem('smartMomUsers', JSON.stringify(users));
                console.log('User saved locally successfully');
                return userData;
            } catch (error) {
                console.error('Error saving user locally:', error);
                throw error;
            }
        }

        function findLocalUser(email, password = null) {
            try {
                const users = getLocalUsers();
                return users.find(user => {
                    if (password) {
                        return user.email === email && user.password === password;
                    }
                    return user.email === email;
                });
            } catch (error) {
                console.error('Error finding local user:', error);
                return null;
            }
        }

        async function hashPassword(password) {
            try {
                const encoder = new TextEncoder();
                const data = encoder.encode(password);
                const hash = await crypto.subtle.digest('SHA-256', data);
                return Array.from(new Uint8Array(hash))
                    .map(b => b.toString(16).padStart(2, '0'))
                    .join('');
            } catch (error) {
                console.warn('Using simple hash fallback');
                let hash = 0;
                for (let i = 0; i < password.length; i++) {
                    const char = password.charCodeAt(i);
                    hash = ((hash << 5) - hash) + char;
                    hash = hash & hash;
                }
                return Math.abs(hash).toString(16);
            }
        }

        // ===== PRESERVED CREATEUSER FUNCTION - DO NOT MODIFY =====
        async function createUser(email, password, name) {
            try {
                console.log('Creating user account...');
                
                // Send to N8N webhook (PRESERVED EXACTLY)
                const response = await fetch('https://momsurvivaltoolkit.app.n8n.cloud/webhook-test/smart-mom-form', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        name: name,
                        email: email,
                        selectedPath: selectedPath || 'not-selected',
                        source: 'smart-mom-website',
                        timestamp: new Date().toISOString(),
                        language: currentLanguage
                    })
                });

                const result = await response.json();
                
                if (response.ok && result.success) {
                    console.log('✅ User registration successful!');
                    
                    currentUser = {
                        id: Date.now().toString(),
                        email: email,
                        name: name,
                        displayName: name,
                        source: 'webhook',
                        status: 'synced'
                    };
                    
                    updateUserSession(currentUser);
                    saveUserProgress();
                    
                    return result;
                    
                } else {
                    throw new Error('Registration failed on server');
                }
                
            } catch (error) {
                console.error('Registration failed, using local storage fallback:', error);
                
                const hashedPassword = await hashPassword(password);
                
                const userData = {
                    id: Date.now().toString(),
                    name: name,
                    email: email,
                    password: hashedPassword,
                    createdAt: new Date().toISOString(),
                    language: currentLanguage,
                    source: 'local'
                };
                
                saveLocalUser(userData);
                
                currentUser = {
                    id: userData.id,
                    email: email,
                    name: name,
                    displayName: name,
                    source: 'local',
                    status: 'local'
                };
                
                updateUserSession(currentUser);
                showAuthSuccess('Account created successfully! (Using local storage)');
                
                return userData;
            }
        }

        async function signIn(email, password) {
            try {
                console.log('Signing in locally...');
                const hashedPassword = await hashPassword(password);
                const localUser = findLocalUser(email, hashedPassword);
                
                if (!localUser) {
                    throw new Error('Invalid email or password');
                }

                currentUser = {
                    id: localUser.id,
                    email: email,
                    name: localUser.name,
                    displayName: localUser.name,
                    source: 'local',
                    status: 'local'
                };

                updateUserSession(currentUser);
                loadUserProgress();
                showConnectionNotice();
                
                return localUser;
                
            } catch (error) {
                console.error('Error signing in:', error);
                throw error;
            }
        }

        // ===== ENHANCED PROGRESS MANAGEMENT =====
        
        function saveUserProgress() {
            const progressData = {
                currentStep,
                selectedPath,
                formData,
                aiResponses,
                calendarData,
                completedTasks: Array.from(completedTasks),
                currentWeek,
                currentLanguage,
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('smartMomProgress', JSON.stringify(progressData));
            
            // INTEGRATE with existing working webhook system
            if (!useLocalStorageOnly && currentUser && currentUser.status === 'synced') {
                sendProgressUpdate(progressData);
            }
        }

        async function sendProgressUpdate(progressData) {
            try {
                const response = await fetch('https://momsurvivaltoolkit.app.n8n.cloud/webhook-test/smart-mom-form', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        ...progressData,
                        updateType: 'progress',
                        userId: currentUser.email,
                        source: 'smart-mom-website'
                    })
                });
            } catch (error) {
                console.log('Progress update failed, continuing with local storage');
            }
        }

        function loadUserProgress() {
            const saved = localStorage.getItem('smartMomProgress');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    currentStep = data.currentStep || 1;
                    selectedPath = data.selectedPath || '';
                    formData = data.formData || {};
                    aiResponses = data.aiResponses || {};
                    calendarData = data.calendarData || null;
                    completedTasks = new Set(data.completedTasks || []);
                    currentWeek = data.currentWeek || 1;
                    currentLanguage = data.currentLanguage || 'en';
                    
                    if (currentLanguage !== 'en') {
                        changeLanguage(currentLanguage);
                    }
                    
                    restoreFormData();
                    updateProgressDisplay();
                    showCurrentStep();
                } catch (error) {
                    console.error('Error loading progress:', error);
                }
            }
        }

        function restoreFormData() {
            Object.keys(formData).forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field) {
                    field.value = formData[fieldId];
                    if (field.type === 'textarea') {
                        updateCharCounter(field);
                    }
                }
            });
            
            // Restore AI responses
            Object.keys(aiResponses).forEach(platform => {
                const field = document.getElementById(`${platform}-response`);
                if (field && aiResponses[platform]) {
                    field.value = aiResponses[platform];
                }
            });
            
            // Restore path selection
            if (selectedPath) {
                const pathOption = document.querySelector(`[data-path="${selectedPath}"]`);
                if (pathOption) {
                    pathOption.classList.add('selected');
                }
            }
        }

        // ===== USER SESSION MANAGEMENT =====
        
        function updateUserSession(user) {
            currentUser = user;
            
            localStorage.setItem('smartMomUser', JSON.stringify(user));
            
            document.getElementById('userStatusBar').classList.remove('hidden');
            document.getElementById('userAvatar').textContent = user.name.charAt(0).toUpperCase();
            document.getElementById('userDisplayName').textContent = user.name;
            
            if (user.status === 'synced') {
                document.getElementById('userStatusText').textContent = `Synced: ${user.email}`;
                document.getElementById('statusBadge').textContent = 'Synced';
                document.getElementById('statusBadge').className = 'status-badge signed-in';
            } else {
                document.getElementById('userStatusText').textContent = `Local Mode: ${user.email}`;
                document.getElementById('statusBadge').textContent = 'Local Mode';
                document.getElementById('statusBadge').className = 'status-badge guest';
                showConnectionNotice();
            }
            
            document.getElementById('signOutBtn').style.display = 'block';
            
            const saveBtn = document.querySelector('[onclick="showAuthModal(\'signup\')"]');
            if (saveBtn) saveBtn.style.display = 'none';
        }

        function checkExistingSession() {
            const savedUser = localStorage.getItem('smartMomUser');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    updateUserSession(currentUser);
                    loadUserProgress();
                } catch (error) {
                    console.error('Error restoring session:', error);
                    localStorage.removeItem('smartMomUser');
                }
            }
            document.getElementById('userStatusBar').classList.remove('hidden');
        }

        function showConnectionNotice() {
            document.getElementById('connectionNotice').classList.remove('hidden');
        }

        function signOut() {
            currentUser = null;
            localStorage.removeItem('smartMomUser');
            localStorage.removeItem('smartMomProgress');
            
            document.getElementById('userAvatar').textContent = '?';
            document.getElementById('userDisplayName').textContent = 'Guest User';
            document.getElementById('userStatusText').textContent = 'Progress will not be saved';
            document.getElementById('statusBadge').textContent = 'Guest Mode';
            document.getElementById('statusBadge').className = 'status-badge guest';
            document.getElementById('signOutBtn').style.display = 'none';
            
            const saveBtn = document.querySelector('[onclick="showAuthModal(\'signup\')"]');
            if (saveBtn) saveBtn.style.display = 'block';
            
            document.querySelectorAll('.form-control').forEach(field => {
                field.value = '';
            });
            
            currentStep = 1;
            selectedPath = '';
            formData = {};
            aiResponses = {};
            updateProgressDisplay();
            showCurrentStep();
        }

        // ===== AUTHENTICATION MODAL FUNCTIONS =====
        
        function showAuthModal(mode) {
            authMode = mode || 'signup';
            
            const modal = document.getElementById('authModal');
            const title = document.getElementById('authTitle');
            const submitBtn = document.getElementById('authSubmitText');
            const switchText = document.getElementById('authSwitchText');
            const switchLink = document.getElementById('authSwitchLink');
            const nameField = document.getElementById('authName');
            const confirmField = document.getElementById('authConfirmPassword');

            clearAuthMessages();

            if (authMode === 'signup') {
                title.textContent = 'Create Your Account';
                submitBtn.textContent = 'Create Account';
                switchText.textContent = 'Already have an account?';
                switchLink.textContent = 'Sign In';
                nameField.style.display = 'block';
                confirmField.style.display = 'block';
                nameField.required = true;
                confirmField.required = true;
            } else {
                title.textContent = 'Sign In';
                submitBtn.textContent = 'Sign In';
                switchText.textContent = "Don't have an account?";
                switchLink.textContent = 'Create Account';
                nameField.style.display = 'none';
                confirmField.style.display = 'none';
                nameField.required = false;
                confirmField.required = false;
            }

            modal.classList.add('active');
        }

        function closeAuthModal() {
            document.getElementById('authModal').classList.remove('active');
            clearAuthMessages();
            document.getElementById('authForm').reset();
        }

        function toggleAuthMode() {
            showAuthModal(authMode === 'signup' ? 'signin' : 'signup');
        }

        function clearAuthMessages() {
            document.getElementById('authError').classList.add('hidden');
            document.getElementById('authSuccess').classList.add('hidden');
        }

        function showAuthError(message) {
            const errorDiv = document.getElementById('authError');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
        }

        function showAuthSuccess(message) {
            const successDiv = document.getElementById('authSuccess');
            successDiv.textContent = message;
            successDiv.classList.remove('hidden');
        }

        // ===== STEP NAVIGATION =====
        
        function showCurrentStep() {
            // Hide all step content
            for (let i = 1; i <= TOTAL_STEPS; i++) {
                const stepContent = document.getElementById(`step${i}Content`);
                if (stepContent) {
                    stepContent.classList.add('hidden');
                }
            }
            
            // Show current step
            const currentStepContent = document.getElementById(`step${currentStep}Content`);
            if (currentStepContent) {
                currentStepContent.classList.remove('hidden');
            }
            
            updateProgressDisplay();
            updateNavigationButtons();
            
            // Update AI prompts when reaching AI steps
            if (currentStep === 7) {
                updateChatGPTPrompt();
            } else if (currentStep === 8) {
                updateGeminiPrompt();
            } else if (currentStep === 9) {
                updateClaudePrompt();
            }
        }

        function nextStep() {
            if (validateCurrentStep()) {
                if (currentStep < TOTAL_STEPS) {
                    currentStep++;
                    showCurrentStep();
                    saveUserProgress();
                    scrollToCurrentStep();
                }
            }
        }

        function previousStep() {
            if (currentStep > 1) {
                currentStep--;
                showCurrentStep();
                saveUserProgress();
                scrollToCurrentStep();
            }
        }

        function validateCurrentStep() {
            switch (currentStep) {
                case 1: // Language selection
                    return true; // Language is always selected
                
                case 2: // Basic info
                    const name = document.getElementById('user-name').value.trim();
                    const email = document.getElementById('user-email').value.trim();
                    if (!name || !email || !isValidEmail(email)) {
                        alert('Please fill in your name and valid email address');
                        return false;
                    }
                    break;
                
                case 3: // Path selection
                    if (!selectedPath) {
                        alert('Please select a path first');
                        return false;
                    }
                    break;
                
                case 4: // Family structure
                    const familyStructure = document.getElementById('family-structure').value.trim();
                    if (!familyStructure) {
                        alert('Please describe your family structure');
                        return false;
                    }
                    break;
                
                case 5: // Daily schedule
                    const dailySchedule = document.getElementById('daily-schedule').value.trim();
                    if (!dailySchedule) {
                        alert('Please describe your daily schedule');
                        return false;
                    }
                    break;
                
                case 6: // Investment & Timeline
                    const investment = document.getElementById('investment-level').value;
                    const timeline = document.getElementById('income-timeline').value;
                    if (!investment || !timeline) {
                        alert('Please select both investment level and income timeline');
                        return false;
                    }
                    break;
                
                case 7: // ChatGPT response
                    if (!aiResponses.chatgpt || aiResponses.chatgpt.trim().length < 50) {
                        alert('Please paste the ChatGPT response with business ideas');
                        return false;
                    }
                    break;
                
                case 8: // Gemini response
                    const selectedIdea = document.getElementById('selected-business-idea').value.trim();
                    if (!selectedIdea) {
                        alert('Please enter your chosen business idea first');
                        return false;
                    }
                    if (!aiResponses.gemini || aiResponses.gemini.trim().length < 50) {
                        alert('Please paste the Gemini market research response');
                        return false;
                    }
                    break;
                
                case 9: // Claude response
                    if (!aiResponses.claude || aiResponses.claude.trim().length < 100) {
                        alert('Please paste the Claude calendar response');
                        return false;
                    }
                    break;
            }
            
            return true;
        }

        function updateProgressDisplay() {
            const stepCounter = document.getElementById('stepCounter');
            const progressFill = document.getElementById('progressFill');
            
            if (stepCounter) {
                stepCounter.textContent = `Step ${currentStep} of ${TOTAL_STEPS}`;
            }
            
            if (progressFill) {
                const percentage = (currentStep / TOTAL_STEPS) * 100;
                progressFill.style.width = `${percentage}%`;
            }

            // Update step indicators
            for (let i = 1; i <= TOTAL_STEPS; i++) {
                const stepElement = document.getElementById(`step-${i}`);
                if (stepElement) {
                    stepElement.classList.remove('active', 'completed', 'pending');
                    
                    if (i < currentStep) {
                        stepElement.classList.add('completed');
                    } else if (i === currentStep) {
                        stepElement.classList.add('active');
                    } else {
                        stepElement.classList.add('pending');
                    }
                }
            }
        }

        function updateNavigationButtons() {
            const backBtn = document.getElementById('backBtn');
            const nextBtn = document.getElementById('nextBtn');
            const navButtons = document.getElementById('navButtons');
            
            if (backBtn) {
                backBtn.disabled = (currentStep === 1);
            }
            
            if (nextBtn) {
                if (currentStep === TOTAL_STEPS) {
                    nextBtn.textContent = 'Complete';
                    nextBtn.onclick = completeAssessment;
                } else {
                    nextBtn.textContent = 'Next Step →';
                    nextBtn.onclick = nextStep;
                }
            }
            
            // Hide navigation on final step
            if (navButtons) {
                navButtons.style.display = (currentStep === TOTAL_STEPS) ? 'none' : 'flex';
            }
        }

        function scrollToCurrentStep() {
            const currentStepContent = document.getElementById(`step${currentStep}Content`);
            if (currentStepContent) {
                currentStepContent.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // ===== FORM VALIDATION =====
        
        function validateField(field) {
            const validation = document.getElementById(field.id + '-validation');
            let isValid = true;
            let message = '';

            if (field.required && !field.value.trim()) {
                isValid = false;
                message = 'This field is required';
            } else if (field.type === 'email' && field.value && !isValidEmail(field.value)) {
                isValid = false;
                message = 'Please enter a valid email address';
            } else if (field.id === 'user-name' && field.value && field.value.length < 2) {
                isValid = false;
                message = 'Name must be at least 2 characters';
            }

            if (validation) {
                validation.textContent = message;
                validation.className = isValid ? 'validation-message success' : 'validation-message';
            }

            formData[field.id] = field.value;
            
            if (currentUser) {
                saveUserProgress();
            }

            return isValid;
        }

        function isValidEmail(email) {
            return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email);
        }

        function updateCharCounter(field) {
            const maxLength = field.getAttribute('maxlength');
            const counter = document.getElementById(field.id + '-counter');
            
            if (counter && maxLength) {
                const remaining = maxLength - field.value.length;
                counter.textContent = `${remaining} characters remaining`;
                counter.style.color = remaining < 50 ? '#ff4444' : '#666';
            }
            
            formData[field.id] = field.value;
            if (currentUser) {
                saveUserProgress();
            }
        }

        // ===== LANGUAGE MANAGEMENT =====
        
        function changeLanguage(lang) {
            currentLanguage = lang;
            
            document.querySelectorAll('.language-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`lang-${lang}`).classList.add('active');
            
            localStorage.setItem('smartMomLanguage', lang);
            updateLanguageContent(lang);
            
            if (currentUser) {
                saveUserProgress();
            }
        }

        function updateLanguageContent(lang) {
            const t = translations[lang];
            if (t) {
                Object.keys(t).forEach(key => {
                    const element = document.getElementById(key);
                    if (element) {
                        element.textContent = t[key];
                    }
                });
            }
        }

        // ===== PATH SELECTION =====
        
        function selectPath(path) {
            selectedPath = path;
            
            document.querySelectorAll('.path-option').forEach(option => {
                option.classList.remove('selected');
            });
            
            document.querySelector(`[data-path="${path}"]`).classList.add('selected');
            
            formData.selectedPath = path;
            if (currentUser) {
                saveUserProgress();
            }
        }

        // ===== AI WORKFLOW FUNCTIONS =====
        
        function generateChatGPTPrompt() {
            const userData = {
                familyStructure: formData['family-structure'] || 'Not specified',
                dailySchedule: formData['daily-schedule'] || 'Not specified',
                investmentLevel: formData['investment-level'] || 'Not specified',
                incomeTimeline: formData['income-timeline'] || 'Not specified',
                selectedPath: selectedPath || 'Not specified'
            };
            
            return `You are a business strategist helping a mom with the following situation:

Family Structure: ${userData.familyStructure}

Daily Schedule: ${userData.dailySchedule}

Investment Level: ${userData.investmentLevel}

Income Timeline: ${userData.incomeTimeline}

Selected Path: ${userData.selectedPath}

Generate 3 realistic, specific business ideas that fit this exact situation. Focus on practical, achievable options that work with their family constraints and available time. Each idea should include:
- Brief description of the business
- Why it fits their situation
- Realistic earning potential
- Time investment required

Format as a numbered list with brief descriptions.`;
        }

        function generateGeminiPrompt() {
            const businessIdea = document.getElementById('selected-business-idea').value.trim();
            const userData = {
                familyStructure: formData['family-structure'] || 'Not specified',
                investmentLevel: formData['investment-level'] || 'Not specified'
            };
            
            return `Research market viability for this business idea: ${businessIdea}

Target demographic: Moms with similar situation to ${userData.familyStructure}
Investment level: ${userData.investmentLevel}

Provide specific data on:
1. Market size and trends
2. Competition analysis (3-5 main competitors)
3. Startup costs breakdown
4. Potential revenue ranges
5. Key challenges and opportunities
6. Success factors for this market

Focus on realistic data and actionable insights for someone starting this business.`;
        }

        function generateClaudePrompt() {
            const businessIdea = document.getElementById('selected-business-idea').value.trim();
            const marketResearch = aiResponses.gemini || 'No market research provided';
            const userData = {
                dailySchedule: formData['daily-schedule'] || 'Not specified',
                investmentLevel: formData['investment-level'] || 'Not specified',
                familyStructure: formData['family-structure'] || 'Not specified'
            };
            
            return `Create a detailed 12-week implementation calendar for this business: ${businessIdea}

Market Research Context: ${marketResearch.substring(0, 500)}...

User Constraints:
- Daily Schedule: ${userData.dailySchedule}
- Investment Level: ${userData.investmentLevel}
- Family Situation: ${userData.familyStructure}

Format as a 12-week plan with this structure:

Week 1: [Title]
- [Task 1]
- [Task 2]
- [Task 3]

Week 2: [Title]
- [Task 1]
- [Task 2]
- [Task 3]

[Continue for all 12 weeks]

Make tasks specific, actionable, and realistic for someone with family obligations. Include milestones and progress markers. Consider time management and work-life balance.`;
        }

        function updateChatGPTPrompt() {
            document.getElementById('chatgptPrompt').textContent = generateChatGPTPrompt();
        }

        function updateGeminiPrompt(businessIdea = null) {
            if (businessIdea) {
                formData['selected-business-idea'] = businessIdea;
                if (currentUser) saveUserProgress();
            }
            document.getElementById('geminiPrompt').textContent = generateGeminiPrompt();
        }

        function updateClaudePrompt() {
            document.getElementById('claudePrompt').textContent = generateClaudePrompt();
        }

        function copyPrompt(platform) {
            let promptText = '';
            
            switch (platform) {
                case 'chatgpt':
                    promptText = generateChatGPTPrompt();
                    break;
                case 'gemini':
                    promptText = generateGeminiPrompt();
                    break;
                case 'claude':
                    promptText = generateClaudePrompt();
                    break;
            }
            
            navigator.clipboard.writeText(promptText).then(() => {
                alert('Prompt copied to clipboard!');
            }).catch(() => {
                alert('Please manually copy the prompt text');
            });
        }

        function openAI(platform) {
            const url = AI_PLATFORMS[platform];
            if (url) {
                window.open(url, '_blank');
            }
        }

        function saveAIResponse(platform, response) {
            aiResponses[platform] = response;
            if (currentUser) {
                saveUserProgress();
            }
            
            // Enable calendar parsing if Claude response is available
            if (platform === 'claude' && response.trim().length > 100) {
                document.getElementById('parseCalendarBtn').disabled = false;
            }
        }

        // ===== CALENDAR FUNCTIONS =====
        
        function parseCalendar() {
            const claudeResponse = aiResponses.claude;
            if (!claudeResponse) {
                alert('Please paste Claude response first');
                return;
            }
            
            calendarData = parseCalendarFromAI(claudeResponse);
            if (calendarData && calendarData.length > 0) {
                document.getElementById('calendarDisplay').classList.remove('hidden');
                currentWeek = 1;
                displayCurrentWeek();
                updateCalendarStats();
                saveUserProgress();
            } else {
                alert('Could not parse calendar. Please check the format.');
            }
        }

        function parseCalendarFromAI(aiResponse) {
            const weeks = [];
            const lines = aiResponse.split('\n');
            let currentWeekData = null;
            
            lines.forEach(line => {
                const trimmedLine = line.trim();
                
                // Match week headers like "Week 1:", "Week 2:", etc.
                const weekMatch = trimmedLine.match(/week\s+(\d+):?\s*(.*)/i);
                if (weekMatch) {
                    if (currentWeekData) {
                        weeks.push(currentWeekData);
                    }
                    currentWeekData = {
                        week: parseInt(weekMatch[1]),
                        title: weekMatch[2] || `Week ${weekMatch[1]}`,
                        tasks: []
                    };
                } else if (trimmedLine.startsWith('-') && currentWeekData) {
                    // Add task
                    const taskText = trimmedLine.replace(/^-\s*/, '');
                    if (taskText) {
                        currentWeekData.tasks.push({
                            id: `task_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`,
                            text: taskText,
                            completed: false
                        });
                    }
                }
            });
            
            if (currentWeekData) {
                weeks.push(currentWeekData);
            }
            
            return weeks;
        }

        function displayCurrentWeek() {
            if (!calendarData || currentWeek < 1 || currentWeek > calendarData.length) {
                return;
            }
            
            const weekData = calendarData[currentWeek - 1];
            
            document.getElementById('weekTitle').textContent = `Week ${weekData.week}: ${weekData.title}`;
            document.getElementById('weekIndicator').textContent = `Week ${currentWeek} of ${calendarData.length}`;
            
            const taskList = document.getElementById('taskList');
            taskList.innerHTML = '';
            
            weekData.tasks.forEach(task => {
                const taskItem = document.createElement('li');
                taskItem.className = 'task-item';
                if (completedTasks.has(task.id)) {
                    taskItem.classList.add('completed');
                }
                
                taskItem.innerHTML = `
                    <input type="checkbox" class="task-checkbox" 
                           ${completedTasks.has(task.id) ? 'checked' : ''} 
                           onchange="toggleTask('${task.id}')">
                    <span>${task.text}</span>
                `;
                
                taskList.appendChild(taskItem);
            });
            
            // Update navigation buttons
            document.getElementById('prevWeekBtn').disabled = (currentWeek === 1);
            document.getElementById('nextWeekBtn').disabled = (currentWeek === calendarData.length);
            
            updateCalendarStats();
        }

        function toggleTask(taskId) {
            if (completedTasks.has(taskId)) {
                completedTasks.delete(taskId);
            } else {
                completedTasks.add(taskId);
            }
            
            saveUserProgress();
            displayCurrentWeek();
        }

        function previousWeek() {
            if (currentWeek > 1) {
                currentWeek--;
                displayCurrentWeek();
                saveUserProgress();
            }
        }

        function nextWeek() {
            if (calendarData && currentWeek < calendarData.length) {
                currentWeek++;
                displayCurrentWeek();
                saveUserProgress();
            }
        }

        function updateCalendarStats() {
            if (!calendarData) return;
            
            let totalTasks = 0;
            calendarData.forEach(week => {
                totalTasks += week.tasks.length;
            });
            
            const completedCount = completedTasks.size;
            const percentage = totalTasks > 0 ? Math.round((completedCount / totalTasks) * 100) : 0;
            
            document.getElementById('completedTasks').textContent = completedCount;
            document.getElementById('totalTasks').textContent = totalTasks;
            document.getElementById('completionPercentage').textContent = `${percentage}%`;
            document.getElementById('currentWeekNum').textContent = currentWeek;
        }

        // ===== PAYMENT FUNCTIONS =====
        
        function selectPlan(plan) {
            const plans = {
                free: {
                    price: 0,
                    action: () => {
                        alert('Free consultation booking will be implemented with calendar integration.');
                    }
                },
                starter: {
                    price: 39,
                    link: 'https://buy.stripe.com/starter-plan-link'
                },
                growth: {
                    price: 49,
                    link: 'https://buy.stripe.com/growth-plan-link'
                },
                premium: {
                    price: 89,
                    link: 'https://buy.stripe.com/premium-plan-link'
                },
                vip: {
                    price: 100,
                    link: 'https://buy.stripe.com/vip-plan-link'
                }
            };
            
            const selectedPlan = plans[plan];
            if (selectedPlan) {
                if (selectedPlan.action) {
                    selectedPlan.action();
                } else {
                    // For now, show alert (replace with actual Stripe integration)
                    alert(`Redirecting to payment for ${plan} plan ($${selectedPlan.price}). This will be implemented with actual Stripe links.`);
                    // window.open(selectedPlan.link, '_blank');
                }
                
                // Save selected plan
                formData.selectedPlan = plan;
                if (currentUser) {
                    saveUserProgress();
                }
            }
        }

        // ===== MODAL FUNCTIONS =====
        
        function startOnboarding() {
            document.getElementById('welcomeModal').classList.add('hidden');
        }

        function handleReturningUser() {
            document.getElementById('welcomeModal').classList.add('hidden');
            showAuthModal('signin');
        }

        function scrollToCurrentStep() {
            scrollToCurrentStep();
        }

        // ===== COMPLETION FUNCTIONS =====
        
        function completeAssessment() {
            currentStep = TOTAL_STEPS;
            showCurrentStep();
            
            // Save final completion
            formData.completedAt = new Date().toISOString();
            if (currentUser) {
                saveUserProgress();
            }
            
            // Show final success message
            document.getElementById('finalSuccessMessage').scrollIntoView({ behavior: 'smooth' });
        }

        function viewCompleteProfile() {
            const profile = {
                name: formData['user-name'] || 'Not provided',
                email: formData['user-email'] || 'Not provided',
                language: currentLanguage,
                selectedPath: selectedPath || 'Not selected',
                familyStructure: formData['family-structure'] || 'Not provided',
                dailySchedule: formData['daily-schedule'] || 'Not provided',
                investmentLevel: formData['investment-level'] || 'Not provided',
                incomeTimeline: formData['income-timeline'] || 'Not provided',
                businessIdea: formData['selected-business-idea'] || 'Not provided',
                hasCalendar: !!calendarData,
                completedTasks: completedTasks.size,
                totalTasks: calendarData ? calendarData.reduce((sum, week) => sum + week.tasks.length, 0) : 0,
                completedAt: formData.completedAt || 'Not completed'
            };
            
            let profileText = `SMART MOM METHOD - COMPLETE PROFILE\n\n`;
            profileText += `Name: ${profile.name}\n`;
            profileText += `Email: ${profile.email}\n`;
            profileText += `Language: ${profile.language}\n`;
            profileText += `Selected Path: ${profile.selectedPath}\n\n`;
            profileText += `FAMILY & SCHEDULE:\n`;
            profileText += `Family Structure: ${profile.familyStructure}\n`;
            profileText += `Daily Schedule: ${profile.dailySchedule}\n\n`;
            profileText += `BUSINESS PLANNING:\n`;
            profileText += `Investment Level: ${profile.investmentLevel}\n`;
            profileText += `Income Timeline: ${profile.incomeTimeline}\n`;
            profileText += `Chosen Business Idea: ${profile.businessIdea}\n\n`;
            profileText += `PROGRESS:\n`;
            profileText += `Calendar Created: ${profile.hasCalendar ? 'Yes' : 'No'}\n`;
            profileText += `Tasks Completed: ${profile.completedTasks}/${profile.totalTasks}\n`;
            profileText += `Completed: ${new Date(profile.completedAt).toLocaleDateString()}\n\n`;
            profileText += `Data Status: ${currentUser?.status === 'synced' ? 'Synced to servers' : 'Stored locally'}\n`;
            
            alert(profileText);
        }

        function downloadResults() {
            const results = {
                profile: {
                    name: formData['user-name'],
                    email: formData['user-email'],
                    language: currentLanguage,
                    selectedPath: selectedPath
                },
                responses: formData,
                aiResponses: aiResponses,
                calendar: calendarData,
                progress: {
                    completedTasks: Array.from(completedTasks),
                    currentWeek: currentWeek
                },
                completedAt: new Date().toISOString()
            };
            
            const dataStr = JSON.stringify(results, null, 2);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            
            const link = document.createElement('a');
            link.href = url;
            link.download = `smart-mom-results-${new Date().toISOString().split('T')[0]}.json`;
            link.click();
            
            URL.revokeObjectURL(url);
        }

        function startOver() {
            if (confirm('Are you sure you want to start over? This will clear all your progress.')) {
                localStorage.removeItem('smartMomProgress');
                currentStep = 1;
                selectedPath = '';
                formData = {};
                aiResponses = {};
                calendarData = null;
                currentWeek = 1;
                completedTasks.clear();
                
                document.querySelectorAll('.form-control').forEach(field => {
                    field.value = '';
                });
                
                document.querySelectorAll('.path-option').forEach(option => {
                    option.classList.remove('selected');
                });
                
                showCurrentStep();
                updateProgressDisplay();
                scrollToCurrentStep();
            }
        }

        // ===== FORM SUBMISSION HANDLER =====
        
        document.addEventListener('DOMContentLoaded', function() {
            checkExistingSession();
            
            // Load saved language
            const savedLanguage = localStorage.getItem('smartMomLanguage');
            if (savedLanguage) {
                changeLanguage(savedLanguage);
            }
            
            // Show initial step
            showCurrentStep();

            // Auth form submission
            document.getElementById('authForm').addEventListener('submit', async function(event) {
                event.preventDefault();
                
                const email = document.getElementById('authEmail').value;
                const password = document.getElementById('authPassword').value;
                const name = document.getElementById('authName').value;
                const confirmPassword = document.getElementById('authConfirmPassword').value;
                
                clearAuthMessages();
                
                if (authMode === 'signup') {
                    if (!name.trim()) {
                        showAuthError('Name is required');
                        return;
                    }
                    
                    if (password !== confirmPassword) {
                        showAuthError('Passwords do not match');
                        return;
                    }
                    
                    if (password.length < 6) {
                        showAuthError('Password must be at least 6 characters');
                        return;
                    }
                    
                    try {
                        document.getElementById('authSubmitBtn').disabled = true;
                        document.getElementById('authSubmitText').innerHTML = '<span class="loading-spinner"></span>Creating Account...';
                        
                        await createUser(email, password, name);
                        
                        showAuthSuccess('Account created successfully! Welcome to Smart Mom Method!');
                        
                        setTimeout(() => {
                            closeAuthModal();
                        }, 2000);
                        
                    } catch (error) {
                        let errorMessage = 'Failed to create account';
                        
                        if (error.message === 'User already exists') {
                            errorMessage = 'An account with this email already exists';
                        }
                        
                        showAuthError(errorMessage);
                    } finally {
                        document.getElementById('authSubmitBtn').disabled = false;
                        document.getElementById('authSubmitText').textContent = 'Create Account';
                    }
                } else {
                    try {
                        document.getElementById('authSubmitBtn').disabled = true;
                        document.getElementById('authSubmitText').innerHTML = '<span class="loading-spinner"></span>Signing In...';
                        
                        await signIn(email, password);
                        
                        showAuthSuccess('Signed in successfully! Welcome back!');
                        
                        setTimeout(() => {
                            closeAuthModal();
                        }, 1500);
                        
                    } catch (error) {
                        let errorMessage = 'Invalid email or password';
                        showAuthError(errorMessage);
                    } finally {
                        document.getElementById('authSubmitBtn').disabled = false;
                        document.getElementById('authSubmitText').textContent = 'Sign In';
                    }
                }
            });

            // Add event listeners for all form fields
            document.querySelectorAll('.form-control').forEach(field => {
                field.addEventListener('change', function() {
                    validateField(this);
                });
                
                if (field.type === 'textarea') {
                    field.addEventListener('input', function() {
                        updateCharCounter(this);
                    });
                }
            });

            // Add character counters to textareas
            document.querySelectorAll('textarea[maxlength]').forEach(textarea => {
                const counter = document.createElement('div');
                counter.className = 'char-counter';
                counter.id = textarea.id + '-counter';
                textarea.parentNode.insertBefore(counter, textarea.nextSibling);
                updateCharCounter(textarea);
            });

            // Add business idea input listener
            const businessIdeaField = document.getElementById('selected-business-idea');
            if (businessIdeaField) {
                businessIdeaField.addEventListener('input', function() {
                    updateGeminiPrompt(this.value);
                });
            }

            // Add AI response listeners
            ['chatgpt', 'gemini', 'claude'].forEach(platform => {
                const responseField = document.getElementById(`${platform}-response`);
                if (responseField) {
                    responseField.addEventListener('input', function() {
                        saveAIResponse(platform, this.value);
                    });
                }
            });
        });

        // ===== ACCESSIBILITY ENHANCEMENTS =====
        
        function addAccessibilityFeatures() {
            // Progress indicators
            document.querySelectorAll('.progress-step').forEach((indicator, index) => {
                indicator.setAttribute('aria-label', `Step ${index + 1} of ${TOTAL_STEPS}: ${stepConfig[index + 1]?.title || 'Step'}`);
                indicator.setAttribute('role', 'button');
                indicator.setAttribute('tabindex', '0');
                
                // Add keyboard navigation
                indicator.addEventListener('keydown', function(e) {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault();
                        if (index + 1 <= currentStep) {
                            currentStep = index + 1;
                            showCurrentStep();
                        }
                    }
                });
            });
            
            // Add skip to main content link
            const skipLink = document.createElement('a');
            skipLink.href = '#main-content';
            skipLink.textContent = 'Skip to main content';
            skipLink.style.cssText = `
                position: absolute;
                top: -40px;
                left: 6px;
                background: var(--sage-green);
                color: white;
                padding: 8px;
                text-decoration: none;
                border-radius: 4px;
                z-index: 10000;
                transition: top 0.3s;
            `;
            skipLink.addEventListener('focus', function() {
                this.style.top = '6px';
            });
            skipLink.addEventListener('blur', function() {
                this.style.top = '-40px';
            });
            document.body.insertBefore(skipLink, document.body.firstChild);
            
            // Add main content landmark
            const mainContent = document.querySelector('.main-card .content');
            if (mainContent) {
                mainContent.id = 'main-content';
                mainContent.setAttribute('role', 'main');
            }
            
            // Enhanced form accessibility
            document.querySelectorAll('input[required], textarea[required], select[required]').forEach(field => {
                field.setAttribute('aria-required', 'true');
                
                // Add success validation for better UX
                field.addEventListener('blur', function() {
                    if (this.value.trim() && validateField(this)) {
                        const successMsg = this.parentNode.querySelector('.validation-success');
                        if (!successMsg) {
                            const success = document.createElement('div');
                            success.className = 'validation-success';
                            success.style.cssText = 'color: var(--success-green); font-size: 14px; margin-top: 5px;';
                            success.textContent = '✓ Complete';
                            success.setAttribute('aria-live', 'polite');
                            this.parentNode.appendChild(success);
                        }
                    }
                });
            });
            
            // High contrast mode detection
            if (window.matchMedia && window.matchMedia('(prefers-contrast: high)').matches) {
                document.body.classList.add('high-contrast');
            }
            
            // Reduced motion detection
            if (window.matchMedia && window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.body.classList.add('reduced-motion');
                
                // Add CSS for reduced motion
                const style = document.createElement('style');
                style.textContent = `
                    .reduced-motion * {
                        animation-duration: 0.01s !important;
                        animation-iteration-count: 1 !important;
                        transition-duration: 0.01s !important;
                    }
                `;
                document.head.appendChild(style);
            }
        }

        // ===== ERROR HANDLING =====
        
        window.addEventListener('error', function(event) {
            console.error('Global error:', event.error);
            
            // Show user-friendly error message
            const errorMsg = document.createElement('div');
            errorMsg.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #ff4444;
                color: white;
                padding: 16px;
                border-radius: 8px;
                z-index: 10000;
                max-width: 300px;
                font-size: 14px;
            `;
            errorMsg.textContent = 'Something went wrong. Your progress has been saved locally.';
            document.body.appendChild(errorMsg);
            
            setTimeout(() => {
                errorMsg.remove();
            }, 5000);
        });

        // ===== FINAL INITIALIZATION =====
        
        // Initialize accessibility features when DOM is loaded
        document.addEventListener('DOMContentLoaded', addAccessibilityFeatures);

        // Auto-save progress every 30 seconds
        setInterval(() => {
            if (currentUser) {
                saveUserProgress();
            }
        }, 30000);

        // Warn user before leaving if they have unsaved progress
        window.addEventListener('beforeunload', function(event) {
            if (currentStep > 1 && !currentUser) {
                event.preventDefault();
                event.returnValue = 'You have unsaved progress. Are you sure you want to leave?';
                return event.returnValue;
            }
        });

        // Handle offline/online status
        window.addEventListener('offline', function() {
            showConnectionNotice();
            const notice = document.getElementById('connectionNotice');
            if (notice) {
                notice.innerHTML = '<strong>📡 Offline Mode:</strong> You are currently offline. Data will be stored locally and synced when connection is restored.';
            }
        });

        window.addEventListener('online', function() {
            const notice = document.getElementById('connectionNotice');
            if (notice && currentUser && currentUser.status === 'synced') {
                notice.classList.add('hidden');
                
                // Try to sync any pending progress
                if (currentUser) {
                    saveUserProgress();
                }
            }
        });

        // ===== UTILITY FUNCTIONS =====
        
        function t(key) {
            return translations[currentLanguage][key] || key;
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Debounced save function to prevent excessive saving
        const debouncedSave = debounce(() => {
            if (currentUser) {
                saveUserProgress();
            }
        }, 1000);

        // ===== EXPORT FUNCTIONS FOR GLOBAL ACCESS =====
        
        // Make key functions available globally for onclick handlers
        window.showAuthModal = showAuthModal;
        window.closeAuthModal = closeAuthModal;
        window.toggleAuthMode = toggleAuthMode;
        window.startOnboarding = startOnboarding;
        window.handleReturningUser = handleReturningUser;
        window.changeLanguage = changeLanguage;
        window.selectPath = selectPath;
        window.nextStep = nextStep;
        window.previousStep = previousStep;
        window.validateField = validateField;
        window.updateCharCounter = updateCharCounter;
        window.copyPrompt = copyPrompt;
        window.openAI = openAI;
        window.saveAIResponse = saveAIResponse;
        window.updateGeminiPrompt = updateGeminiPrompt;
        window.parseCalendar = parseCalendar;
        window.toggleTask = toggleTask;
        window.previousWeek = previousWeek;
        window.nextWeek = nextWeek;
        window.selectPlan = selectPlan;
        window.viewCompleteProfile = viewCompleteProfile;
        window.downloadResults = downloadResults;
        window.startOver = startOver;
        window.signOut = signOut;
        window.scrollToCurrentStep = scrollToCurrentStep;
        window.completeAssessment = completeAssessment;
    </script>
</body>
</html>
