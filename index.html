<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Smart Mom Method - AI Business Launch Wizard</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Playfair+Display:wght@400;500;600&display=swap" rel="stylesheet">
    
    <!-- Firebase SDK -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-app-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-auth-compat.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/firebase/9.23.0/firebase-firestore-compat.min.js"></script>
    
    <style>
        :root {
            --sage-green: #6B8E6B;
            --warm-cream: #FAF7F0;
            --deep-teal: #2D5B69;
            --charcoal: #2C3E50;
            --soft-gold: #D4A574;
            --light-sage: #E8F5E8;
            --sage-alpha: rgba(107, 142, 107, 0.1);
            --teal-alpha: rgba(45, 91, 105, 0.1);
            --gold-alpha: rgba(212, 165, 116, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: var(--charcoal);
            background: var(--warm-cream);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Authentication Modal */
        .auth-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(44, 62, 80, 0.95);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10001;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s ease;
        }

        .auth-modal.active {
            opacity: 1;
            visibility: visible;
        }

        .auth-content {
            background: white;
            border-radius: 24px;
            padding: 50px;
            max-width: 500px;
            width: 90%;
            position: relative;
            transform: translateY(20px);
            transition: transform 0.4s ease;
        }

        .auth-modal.active .auth-content {
            transform: translateY(0);
        }

        .auth-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--charcoal);
            opacity: 0.7;
        }

        .auth-close:hover {
            opacity: 1;
        }

        .auth-title {
            font-family: 'Playfair Display', serif;
            color: var(--sage-green);
            margin-bottom: 32px;
            font-size: 2rem;
            text-align: center;
        }

        .auth-form {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .auth-input {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--light-sage);
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
        }

        .auth-input:focus {
            outline: none;
            border-color: var(--sage-green);
            box-shadow: 0 0 0 4px var(--sage-alpha);
        }

        .auth-button {
            background: linear-gradient(135deg, var(--sage-green), #5A7A5A);
            color: white;
            padding: 18px 36px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .auth-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(107, 142, 107, 0.35);
        }

        .google-auth-button {
            background: white;
            border: 2px solid var(--light-sage);
            color: var(--charcoal);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-top: 16px;
        }

        .google-auth-button:hover {
            background: var(--light-sage);
            transform: translateY(-2px);
        }

        .auth-switch {
            text-align: center;
            margin-top: 24px;
            color: var(--charcoal);
            opacity: 0.8;
        }

        .auth-link {
            color: var(--sage-green);
            cursor: pointer;
            text-decoration: underline;
        }

        .auth-error {
            background: #ffebee;
            border: 1px solid #e57373;
            color: #c62828;
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 14px;
        }

        .auth-success {
            background: #e8f5e8;
            border: 1px solid var(--sage-green);
            color: var(--sage-green);
            padding: 12px 16px;
            border-radius: 8px;
            margin-bottom: 16px;
            font-size: 14px;
        }

        /* Welcome Modal */
        .welcome-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(44, 62, 80, 0.9);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10000;
            opacity: 1;
            visibility: visible;
            transition: all 0.4s ease;
        }

        .welcome-modal.hidden {
            opacity: 0;
            visibility: hidden;
        }

        .welcome-content {
            background: white;
            border-radius: 24px;
            padding: 60px 50px;
            max-width: 600px;
            width: 90%;
            text-align: center;
            transform: translateY(0);
            transition: transform 0.4s ease;
            box-shadow: 0 30px 80px rgba(44, 62, 80, 0.2);
        }

        .welcome-content h2 {
            font-family: 'Playfair Display', serif;
            color: var(--sage-green);
            margin-bottom: 24px;
            font-size: 2.4rem;
            font-weight: 600;
        }

        .welcome-content p {
            color: var(--charcoal);
            margin-bottom: 40px;
            font-size: 1.1rem;
            line-height: 1.7;
            opacity: 0.8;
        }

        .welcome-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .welcome-btn {
            padding: 18px 36px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            min-width: 200px;
            font-family: 'Inter', sans-serif;
        }

        .welcome-btn.primary {
            background: linear-gradient(135deg, var(--sage-green), #5A7A5A);
            color: white;
            box-shadow: 0 8px 24px rgba(107, 142, 107, 0.3);
        }

        .welcome-btn.primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(107, 142, 107, 0.4);
        }

        .welcome-btn.secondary {
            background: var(--deep-teal);
            color: white;
        }

        .welcome-btn.secondary:hover {
            background: #1E3D47;
            transform: translateY(-2px);
        }

        .welcome-btn.auth {
            background: var(--soft-gold);
            color: white;
        }

        .welcome-btn.auth:hover {
            background: #C79660;
            transform: translateY(-2px);
        }

        /* User Status Bar */
        .user-status-bar {
            background: linear-gradient(135deg, var(--sage-green), var(--deep-teal));
            color: white;
            padding: 16px 32px;
            text-align: center;
            position: relative;
            z-index: 100;
        }

        .user-status-bar.hidden {
            display: none;
        }

        .user-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            max-width: 1200px;
            margin: 0 auto;
        }

        .user-welcome {
            font-weight: 600;
        }

        .logout-btn {
            background: rgba(255, 255, 255, 0.2);
            border: 1px solid rgba(255, 255, 255, 0.3);
            color: white;
            padding: 8px 16px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
        }

        .logout-btn:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        /* Language Selection */
        .language-selector {
            text-align: center;
            margin-bottom: 40px;
            padding: 32px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 8px 32px rgba(44, 62, 80, 0.08);
        }

        .language-selector h2 {
            margin-bottom: 24px;
            color: var(--charcoal);
            font-size: 1.6rem;
            font-weight: 600;
        }

        .language-buttons {
            display: flex;
            gap: 24px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .language-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 40px;
            background: var(--sage-green);
            color: white;
            border: none;
            border-radius: 16px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            min-width: 200px;
            box-shadow: 0 6px 20px rgba(107, 142, 107, 0.25);
        }

        .language-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 30px rgba(107, 142, 107, 0.35);
        }

        .language-btn.active {
            background: var(--soft-gold);
            transform: translateY(-2px);
        }

        .language-btn .flag {
            font-size: 2rem;
            margin-bottom: 12px;
        }

        .language-btn small {
            margin-top: 8px;
            opacity: 0.9;
        }

        /* Learning Style Adaptation */
        .visual-preference-calm {
            background: linear-gradient(135deg, #f8f9fa, #e9ecef);
            border-left: 4px solid #6c757d;
        }

        .visual-preference-energetic {
            background: linear-gradient(135deg, #fff3cd, #ffeaa7);
            border-left: 4px solid #fd7e14;
        }

        .visual-preference-minimal {
            background: white;
            border: 1px solid #dee2e6;
            border-left: 4px solid var(--sage-green);
        }

        .learning-style-indicator {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: 600;
            margin-left: 8px;
        }

        .adaptive-help {
            background: var(--light-sage);
            border-radius: 12px;
            padding: 16px;
            margin-top: 16px;
            font-size: 14px;
            line-height: 1.5;
        }

        .form-section.adapted {
            border-left: 6px solid var(--soft-gold);
        }

        /* Progress Container */
        .progress-container {
            background: white;
            border-radius: 20px;
            padding: 32px;
            margin-bottom: 32px;
            box-shadow: 0 8px 32px rgba(44, 62, 80, 0.08);
        }

        .progress-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 24px;
        }

        .step-counter {
            font-weight: 700;
            color: var(--sage-green);
            font-size: 1.3rem;
        }

        .time-estimate {
            background: var(--soft-gold);
            color: white;
            padding: 8px 20px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .overall-progress {
            width: 100%;
            height: 12px;
            background: var(--light-sage);
            border-radius: 6px;
            overflow: hidden;
            margin-bottom: 32px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--sage-green), var(--deep-teal));
            transition: width 0.5s ease;
            border-radius: 6px;
            width: 14.29%;
        }

        .progress-bar {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 16px;
            margin-bottom: 0;
        }

        .progress-step {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px 16px;
            border-radius: 16px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
            background: var(--sage-alpha);
        }
        
        .progress-step:hover {
            background: var(--teal-alpha);
            transform: translateY(-2px);
        }

        .progress-step.active {
            background: var(--sage-green);
            color: white;
        }

        .progress-step.completed {
            background: var(--deep-teal);
            color: white;
        }

        .progress-step.next {
            background: var(--soft-gold);
            color: white;
        }

        .step-number {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.2);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-bottom: 12px;
            transition: all 0.3s ease;
        }

        .progress-step.active .step-number {
            background: rgba(255, 255, 255, 0.3);
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .step-text {
            font-size: 0.9rem;
            text-align: center;
            font-weight: 600;
        }

        /* Main Card */
        .main-card {
            background: white;
            border-radius: 24px;
            box-shadow: 0 16px 48px rgba(44, 62, 80, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, var(--sage-green), var(--deep-teal));
            color: white;
            padding: 60px 40px;
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: -50%;
            left: -50%;
            width: 200%;
            height: 200%;
            background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
            animation: shimmer 8s ease-in-out infinite;
        }

        @keyframes shimmer {
            0%, 100% { transform: rotate(0deg); }
            50% { transform: rotate(180deg); }
        }

        .header h1 {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            margin-bottom: 16px;
            position: relative;
            z-index: 1;
            font-weight: 600;
        }

        .header .subtitle {
            font-size: 1.3rem;
            opacity: 0.95;
            position: relative;
            z-index: 1;
            font-weight: 400;
        }

        .badge {
            display: inline-block;
            background: var(--soft-gold);
            color: white;
            padding: 12px 28px;
            border-radius: 30px;
            font-weight: 700;
            margin-top: 24px;
            font-size: 1rem;
            position: relative;
            z-index: 1;
        }

        .header .cta-section {
            margin-top: 40px;
            position: relative;
            z-index: 1;
        }

        .btn-current {
            background: linear-gradient(135deg, var(--soft-gold), #C79660);
            color: white;
            box-shadow: 0 8px 24px rgba(212, 165, 116, 0.3);
            font-size: 1.2rem;
            padding: 20px 40px;
            border-radius: 50px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-current:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(212, 165, 116, 0.4);
        }

        .content {
            padding: 50px 40px;
        }

        .step-description {
            background: var(--light-sage);
            padding: 32px;
            border-radius: 16px;
            margin-bottom: 40px;
            border-left: 6px solid var(--sage-green);
        }

        .step-description h2 {
            font-family: 'Playfair Display', serif;
            color: var(--charcoal);
            margin-bottom: 16px;
            font-size: 2rem;
            font-weight: 600;
        }

        .step-description p {
            color: var(--charcoal);
            font-size: 1.1rem;
            opacity: 0.8;
        }

        .empowerment-message {
            background: linear-gradient(135deg, var(--gold-alpha), rgba(212, 165, 116, 0.15));
            border: 2px solid var(--soft-gold);
            border-radius: 20px;
            padding: 32px;
            margin: 32px 0;
            text-align: center;
        }

        .empowerment-title {
            color: var(--charcoal);
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 16px;
            font-family: 'Playfair Display', serif;
        }

        .empowerment-text {
            color: var(--charcoal);
            line-height: 1.7;
            opacity: 0.9;
        }

        .form-section {
            margin-bottom: 40px;
            padding: 40px;
            background: white;
            border-radius: 20px;
            border: 2px solid var(--light-sage);
            box-shadow: 0 4px 16px rgba(107, 142, 107, 0.08);
            position: relative;
        }

        .form-section h3 {
            font-family: 'Playfair Display', serif;
            color: var(--charcoal);
            margin-bottom: 32px;
            font-size: 1.5rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .form-group {
            margin-bottom: 28px;
            position: relative;
        }

        .form-group label {
            display: block;
            margin-bottom: 12px;
            font-weight: 600;
            color: var(--charcoal);
            font-size: 1rem;
        }

        .required {
            color: var(--soft-gold);
            margin-left: 4px;
        }

        .form-control {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--light-sage);
            border-radius: 12px;
            font-size: 16px;
            transition: all 0.3s ease;
            font-family: 'Inter', sans-serif;
            background: var(--warm-cream);
        }

        .form-control:focus {
            outline: none;
            border-color: var(--sage-green);
            box-shadow: 0 0 0 4px var(--sage-alpha);
            background: white;
        }

        .char-counter {
            position: absolute;
            bottom: 8px;
            right: 12px;
            font-size: 12px;
            color: var(--charcoal);
            opacity: 0.6;
        }

        .validation-message {
            margin-top: 8px;
            font-size: 14px;
            color: #e57373;
        }

        .validation-message.success {
            color: var(--sage-green);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--sage-green), #5A7A5A);
            color: white;
            box-shadow: 0 8px 24px rgba(107, 142, 107, 0.25);
            padding: 18px 36px;
            border: none;
            border-radius: 12px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 12px 32px rgba(107, 142, 107, 0.35);
        }

        /* Platform Buttons */
        .platform-button {
            display: inline-block;
            padding: 16px 32px;
            border-radius: 12px;
            text-decoration: none;
            color: white;
            font-weight: 600;
            font-size: 16px;
            transition: all 0.3s ease;
            margin: 8px;
            cursor: pointer;
            border: none;
        }

        .platform-button.chatgpt-button {
            background: linear-gradient(135deg, #00a67e, #00c896);
        }

        .platform-button.gemini-button {
            background: linear-gradient(135deg, #4285f4, #34a853);
        }

        .platform-button.claude-button {
            background: linear-gradient(135deg, #cc785c, #d97757);
        }

        .platform-button:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.2);
        }

        /* Business Idea Selector */
        .business-idea-selector {
            background: white;
            border-radius: 20px;
            padding: 40px;
            margin: 32px 0;
            border: 2px solid var(--light-sage);
            box-shadow: 0 8px 32px rgba(44, 62, 80, 0.08);
        }

        .idea-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
            margin-top: 24px;
        }

        .idea-card {
            background: var(--warm-cream);
            border-radius: 16px;
            padding: 24px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .idea-card:hover,
        .idea-card.selected {
            border-color: var(--sage-green);
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(107, 142, 107, 0.2);
        }

        /* Auto-populated prompts */
        .auto-populated-prompt {
            background: var(--light-sage);
            border-radius: 12px;
            padding: 20px;
            margin: 16px 0;
            border-left: 4px solid var(--sage-green);
        }

        .auto-populate-status {
            display: inline-block;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 16px;
        }

        .auto-populate-status.ready {
            background: var(--light-sage);
            color: var(--sage-green);
        }

        /* Returning user status */
        .returning-user-status {
            background: linear-gradient(135deg, var(--gold-alpha), rgba(212, 165, 116, 0.15));
            border: 2px solid var(--soft-gold);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 24px;
            text-align: center;
        }

        /* Celebration section */
        .celebration-section {
            background: linear-gradient(135deg, var(--sage-green), var(--deep-teal));
            color: white;
            padding: 60px 40px;
            text-align: center;
            border-radius: 24px;
            margin: 40px 0;
            position: relative;
            overflow: hidden;
        }

        .celebration-section::before {
            content: '🎉';
            position: absolute;
            font-size: 6rem;
            opacity: 0.1;
            animation: celebrate 3s infinite;
        }

        @keyframes celebrate {
            0%, 100% { transform: rotate(-10deg) scale(1); }
            50% { transform: rotate(10deg) scale(1.1); }
        }

        /* Services Section */
        .services-section {
            background: var(--warm-cream);
            padding: 80px 20px;
            margin: 50px -40px -50px -40px;
            border-radius: 0;
        }

        .services-container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .services-title {
            font-family: 'Playfair Display', serif;
            text-align: center;
            font-size: 2.8rem;
            color: var(--charcoal);
            margin-bottom: 16px;
            font-weight: 600;
        }

        .services-subtitle {
            text-align: center;
            font-size: 1.3rem;
            color: var(--charcoal);
            opacity: 0.8;
            margin-bottom: 60px;
        }

        .track-section {
            margin-bottom: 80px;
            padding: 50px;
            background: white;
            border-radius: 24px;
            border-left: 8px solid var(--sage-green);
            box-shadow: 0 12px 40px rgba(44, 62, 80, 0.08);
        }

        .track-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.2rem;
            color: var(--charcoal);
            margin-bottom: 16px;
            font-weight: 600;
            text-align: center;
        }

        .track-subtitle {
            font-size: 1.2rem;
            color: var(--charcoal);
            opacity: 0.8;
            text-align: center;
            margin-bottom: 50px;
            line-height: 1.6;
        }

        .service-blocks {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 40px;
            margin-bottom: 30px;
        }

        .service-block {
            background: var(--warm-cream);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 12px 32px rgba(44, 62, 80, 0.08);
            text-align: center;
            position: relative;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            border: 2px solid transparent;
        }

        .service-block:hover {
            transform: translateY(-5px);
            box-shadow: 0 20px 48px rgba(44, 62, 80, 0.12);
            border-color: var(--sage-green);
        }

        .popular-service {
            border: 3px solid var(--soft-gold);
            transform: scale(1.02);
            background: white;
        }

        .popular-badge {
            position: absolute;
            top: -12px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--soft-gold);
            color: white;
            padding: 8px 24px;
            border-radius: 24px;
            font-size: 0.9rem;
            font-weight: 700;
        }

        .service-icon {
            font-size: 1rem;
            font-weight: 700;
            color: var(--sage-green);
            background: var(--light-sage);
            padding: 12px 20px;
            border-radius: 24px;
            display: inline-block;
            margin-bottom: 20px;
        }

        .service-block h3 {
            font-family: 'Playfair Display', serif;
            font-size: 1.6rem;
            color: var(--charcoal);
            margin-bottom: 16px;
            font-weight: 600;
        }

        .service-price {
            font-size: 2.2rem;
            font-weight: 700;
            color: var(--sage-green);
            margin-bottom: 20px;
            font-family: 'Inter', sans-serif;
        }

        .service-description {
            color: var(--charcoal);
            opacity: 0.8;
            font-size: 1rem;
            line-height: 1.6;
            margin-bottom: 24px;
        }

        .service-features {
            list-style: none;
            padding: 0;
            margin: 24px 0;
            text-align: left;
        }

        .service-features li {
            padding: 8px 0;
            color: var(--charcoal);
            font-size: 0.95rem;
            position: relative;
            padding-left: 24px;
        }

        .service-features li::before {
            content: "✓";
            position: absolute;
            left: 0;
            color: var(--sage-green);
            font-weight: 700;
        }

        .service-button {
            width: 100%;
            padding: 18px 32px;
            border: none;
            border-radius: 12px;
            font-size: 1.1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-top: 24px;
            font-family: 'Inter', sans-serif;
        }

        .service-button.free-button {
            background: linear-gradient(135deg, var(--sage-green), #5A7A5A);
            color: white;
        }

        .service-button.free-button:hover {
            background: linear-gradient(135deg, #5A7A5A, var(--sage-green));
            transform: translateY(-2px);
        }

        .service-button.premium-button {
            background: linear-gradient(135deg, var(--deep-teal), #1E3D47);
            color: white;
        }

        .service-button.premium-button:hover {
            background: linear-gradient(135deg, #1E3D47, var(--deep-teal));
            transform: translateY(-2px);
        }

        /* Social Proof Section */
        .social-proof-section {
            background: linear-gradient(135deg, var(--teal-alpha), rgba(45, 91, 105, 0.08));
            padding: 80px 20px;
            margin: 50px 0;
            border-radius: 24px;
        }

        .social-proof-title {
            font-family: 'Playfair Display', serif;
            font-size: 2.8rem;
            color: var(--charcoal);
            margin-bottom: 20px;
            font-weight: 600;
            text-align: center;
        }

        .user-counter {
            background: linear-gradient(135deg, var(--sage-green), var(--deep-teal));
            color: white;
            padding: 18px 36px;
            border-radius: 40px;
            font-size: 1.3rem;
            font-weight: 700;
            display: inline-block;
            margin: 24px 0;
            animation: pulse 3s infinite;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            .container {
                padding: 0 16px;
            }
            
            .header h1 {
                font-size: 2.2rem;
            }
            
            .header .subtitle {
                font-size: 1.1rem;
            }
            
            .content {
                padding: 30px 20px;
            }
            
            .form-section {
                padding: 24px;
            }
            
            .progress-bar {
                grid-template-columns: repeat(4, 1fr);
                gap: 8px;
            }

            .progress-step {
                padding: 12px 8px;
            }

            .step-text {
                font-size: 0.7rem;
            }

            .language-buttons {
                flex-direction: column;
                align-items: center;
            }
            
            .language-btn {
                min-width: 280px;
            }

            .welcome-content {
                padding: 40px 30px;
            }

            .welcome-buttons {
                flex-direction: column;
            }

            .form-control {
                font-size: 16px;
                padding: 18px;
            }

            .auth-content {
                padding: 30px 20px;
            }

            .user-info {
                flex-direction: column;
                gap: 12px;
            }
        }

        /* Interactive Calendar Styles */
        .interactive-calendar {
            background: white;
            border-radius: 24px;
            padding: 40px;
            margin: 40px 0;
            box-shadow: 0 12px 40px rgba(44, 62, 80, 0.08);
            border-left: 6px solid var(--sage-green);
        }

        .calendar-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .calendar-title {
            font-family: 'Playfair Display', serif;
            color: var(--charcoal);
            font-size: 2.2rem;
            margin-bottom: 16px;
        }

        .calendar-subtitle {
            color: var(--charcoal);
            opacity: 0.8;
            font-size: 1.1rem;
            margin-bottom: 24px;
        }

        .calendar-progress {
            background: var(--light-sage);
            border-radius: 20px;
            padding: 16px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 32px;
        }

        .progress-stats {
            display: flex;
            gap: 32px;
            align-items: center;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--sage-green);
            display: block;
        }

        .stat-label {
            font-size: 0.9rem;
            color: var(--charcoal);
            opacity: 0.7;
        }

        .overall-calendar-progress {
            width: 300px;
            height: 12px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 6px;
            overflow: hidden;
        }

        .overall-progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--sage-green), var(--deep-teal));
            transition: width 0.5s ease;
            border-radius: 6px;
            width: 0%;
        }

        .week-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 32px;
            justify-content: center;
        }

        .week-btn {
            padding: 12px 20px;
            border: 2px solid var(--light-sage);
            background: white;
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
            color: var(--charcoal);
        }

        .week-btn.active {
            background: var(--sage-green);
            color: white;
            border-color: var(--sage-green);
        }

        .week-btn.completed {
            background: var(--deep-teal);
            color: white;
            border-color: var(--deep-teal);
        }

        .week-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(107, 142, 107, 0.2);
        }

        .calendar-content {
            display: none;
        }

        .calendar-content.active {
            display: block;
        }

        .week-view {
            margin-bottom: 40px;
        }

        .week-header {
            background: linear-gradient(135deg, var(--sage-green), var(--deep-teal));
            color: white;
            padding: 20px 32px;
            border-radius: 16px;
            margin-bottom: 24px;
            text-align: center;
        }

        .week-title {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 8px;
        }

        .week-progress {
            font-size: 0.9rem;
            opacity: 0.9;
        }

        .days-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 24px;
        }

        .day-card {
            background: var(--warm-cream);
            border-radius: 16px;
            padding: 24px;
            border: 2px solid var(--light-sage);
            transition: all 0.3s ease;
        }

        .day-card:hover {
            border-color: var(--sage-green);
            transform: translateY(-2px);
        }

        .day-card.completed {
            background: linear-gradient(135deg, var(--light-sage), rgba(107, 142, 107, 0.1));
            border-color: var(--sage-green);
        }

        .day-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 12px;
            border-bottom: 2px solid var(--light-sage);
        }

        .day-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: var(--charcoal);
        }

        .day-progress {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .day-progress-bar {
            width: 60px;
            height: 8px;
            background: rgba(107, 142, 107, 0.2);
            border-radius: 4px;
            overflow: hidden;
        }

        .day-progress-fill {
            height: 100%;
            background: var(--sage-green);
            transition: width 0.3s ease;
            border-radius: 4px;
        }

        .day-percentage {
            font-size: 0.8rem;
            font-weight: 600;
            color: var(--sage-green);
        }

        .task-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .task-item {
            margin-bottom: 24px;
            background: white;
            border-radius: 12px;
            padding: 20px;
            border-left: 4px solid var(--soft-gold);
            box-shadow: 0 2px 8px rgba(44, 62, 80, 0.05);
        }

        .task-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 16px;
        }

        .task-title {
            font-size: 1rem;
            font-weight: 600;
            color: var(--charcoal);
            margin-bottom: 4px;
        }

        .task-meta {
            display: flex;
            gap: 12px;
            align-items: center;
            flex-wrap: wrap;
        }

        .task-cost {
            background: var(--sage-green);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .task-cost.free {
            background: var(--deep-teal);
        }

        .task-time {
            background: var(--soft-gold);
            color: white;
            padding: 4px 12px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .task-progress {
            text-align: right;
        }

        .task-progress-bar {
            width: 80px;
            height: 6px;
            background: rgba(107, 142, 107, 0.2);
            border-radius: 3px;
            overflow: hidden;
            margin-bottom: 4px;
        }

        .task-progress-fill {
            height: 100%;
            background: var(--sage-green);
            transition: width 0.3s ease;
            border-radius: 3px;
        }

        .task-percentage {
            font-size: 0.7rem;
            color: var(--sage-green);
            font-weight: 600;
        }

        .step-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .step-item {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            margin-bottom: 12px;
            padding: 8px 0;
        }

        .step-checkbox {
            width: 20px;
            height: 20px;
            border: 2px solid var(--sage-green);
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            flex-shrink: 0;
            margin-top: 2px;
        }

        .step-checkbox.checked {
            background: var(--sage-green);
            color: white;
        }

        .step-checkbox:hover {
            transform: scale(1.1);
            box-shadow: 0 2px 8px rgba(107, 142, 107, 0.3);
        }

        .step-text {
            color: var(--charcoal);
            line-height: 1.5;
            flex: 1;
        }

        .step-text.completed {
            text-decoration: line-through;
            opacity: 0.6;
        }

        .step-link {
            color: var(--sage-green);
            text-decoration: underline;
            font-weight: 600;
        }

        .step-link:hover {
            color: var(--deep-teal);
        }

        .celebration-popup {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: white;
            border-radius: 24px;
            padding: 40px;
            box-shadow: 0 20px 60px rgba(44, 62, 80, 0.3);
            z-index: 10000;
            text-align: center;
            opacity: 0;
            visibility: hidden;
            transition: all 0.4s ease;
        }

        .celebration-popup.show {
            opacity: 1;
            visibility: visible;
        }

        .celebration-emoji {
            font-size: 4rem;
            margin-bottom: 16px;
            animation: bounce 1s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .energy-tracker {
            background: linear-gradient(135deg, var(--gold-alpha), rgba(212, 165, 116, 0.15));
            border: 2px solid var(--soft-gold);
            border-radius: 16px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }

        .energy-title {
            font-weight: 600;
            margin-bottom: 12px;
            color: var(--charcoal);
        }

        .energy-levels {
            display: flex;
            gap: 8px;
            justify-content: center;
        }

        .energy-level {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 2px solid var(--soft-gold);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1.2rem;
        }

        .energy-level.selected {
            background: var(--soft-gold);
            color: white;
        }

        .energy-level:hover {
            transform: scale(1.1);
        }

        .rest-day-message {
            background: linear-gradient(135deg, var(--teal-alpha), rgba(45, 91, 105, 0.15));
            border: 2px solid var(--deep-teal);
            border-radius: 16px;
            padding: 24px;
            text-align: center;
            margin: 20px 0;
        }

        .rest-day-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: var(--deep-teal);
            margin-bottom: 12px;
        }

        .adaptive-suggestions {
            background: var(--light-sage);
            border-radius: 12px;
            padding: 16px;
            margin: 16px 0;
        }

        .adaptive-title {
            font-weight: 600;
            color: var(--sage-green);
            margin-bottom: 8px;
        }

        .adaptive-text {
            font-size: 0.9rem;
            color: var(--charcoal);
            opacity: 0.8;
        }

        @media (max-width: 768px) {
            .days-grid {
                grid-template-columns: 1fr;
            }
            
            .week-selector {
                flex-direction: column;
                align-items: center;
            }
            
            .progress-stats {
                flex-direction: column;
                gap: 16px;
            }
            
            .overall-calendar-progress {
                width: 100%;
            }
            
            .task-meta {
                flex-direction: column;
                align-items: flex-start;
                gap: 8px;
            }
        }
    </style>
</head>
<body>
    <!-- Authentication Modal -->
    <div id="authModal" class="auth-modal">
        <div class="auth-content">
            <button class="auth-close" onclick="closeAuthModal()">&times;</button>
            <h2 class="auth-title" id="authTitle">Create Your Account</h2>
            
            <div id="authError" class="auth-error hidden"></div>
            <div id="authSuccess" class="auth-success hidden"></div>
            
            <form class="auth-form" id="authForm">
                <input type="text" id="authName" class="auth-input" placeholder="Your Name" style="display: none;">
                <input type="email" id="authEmail" class="auth-input" placeholder="Email Address" required>
                <input type="password" id="authPassword" class="auth-input" placeholder="Password" required>
                <input type="password" id="authConfirmPassword" class="auth-input" placeholder="Confirm Password" style="display: none;">
                
                <button type="submit" class="auth-button" id="authSubmitBtn">Create Account</button>
                <button type="button" class="auth-button google-auth-button" onclick="signInWithGoogle()">
                    <svg width="18" height="18" viewBox="0 0 18 18">
                        <path fill="#4285F4" d="M16.51 8H8.98v3h4.3c-.18 1-.74 1.48-1.6 2.04v2.01h2.6a7.8 7.8 0 0 0 2.38-5.88c0-.57-.05-.66-.15-1.18z"/>
                        <path fill="#34A853" d="M8.98 17c2.16 0 3.97-.72 5.3-1.94l-2.6-2.04a4.8 4.8 0 0 1-7.18-2.53H1.83v2.07A8 8 0 0 0 8.98 17z"/>
                        <path fill="#FBBC05" d="M4.5 10.49a4.8 4.8 0 0 1 0-3.07V5.35H1.83a8 8 0 0 0 0 7.28l2.67-2.14z"/>
                        <path fill="#EA4335" d="M8.98 4.72c1.16 0 2.23.4 3.06 1.2l2.3-2.3A8 8 0 0 0 1.83 5.35L4.5 7.42a4.8 4.8 0 0 1 4.48-2.7z"/>
                    </svg>
                    Sign in with Google
                </button>
            </form>
            
            <div class="auth-switch">
                <span id="authSwitchText">Already have an account?</span>
                <span class="auth-link" id="authSwitchLink" onclick="toggleAuthMode()">Sign In</span>
            </div>
        </div>
    </div>

    <!-- User Status Bar -->
    <div id="userStatusBar" class="user-status-bar hidden">
        <div class="user-info">
            <span class="user-welcome" id="userWelcome"></span>
            <button class="logout-btn" onclick="signOut()">Sign Out</button>
        </div>
    </div>

    <!-- Welcome Modal -->
    <div id="welcomeModal" class="welcome-modal">
        <div class="welcome-content">
            <h2>Welcome to Smart Mom Method!</h2>
            <p>Create your personalized business plan in 7 simple steps. This process will take approximately 20-25 minutes and will generate a comprehensive business plan tailored specifically for busy moms like you.</p>
            <div class="welcome-buttons">
                <button class="welcome-btn primary" onclick="startOnboarding()">
                    🚀 Get Started
                </button>
                <button class="welcome-btn auth" onclick="showAuthModal('signup')">
                    💾 Create Account & Save Progress
                </button>
                <button class="welcome-btn secondary" onclick="checkReturningUser()">
                    I'm a returning user
                </button>
            </div>
        </div>
    </div>

    <div class="container">
        <!-- Language Selection -->
        <div class="language-selector">
            <h2>Choose Your Language / Elige Tu Idioma</h2>
            <div class="language-buttons">
                <button class="language-btn active" onclick="changeLanguage('en')" id="lang-en">
                    <span class="flag">🇺🇸</span>
                    <span>English</span>
                    <small>Read and answer everything in English</small>
                </button>
                <button class="language-btn" onclick="changeLanguage('es')" id="lang-es">
                    <span class="flag">🇪🇸</span>
                    <span>Español</span>
                    <small>Lee y responde todo en español</small>
                </button>
            </div>
        </div>

        <!-- Social Proof Section -->
        <div class="social-proof-section">
            <div class="social-proof-header">
                <h2 class="social-proof-title">Join 2,847+ Successful Mom Entrepreneurs!</h2>
                <div class="user-counter">
                    <span>🎉 2,847+ moms have launched their businesses!</span>
                </div>
            </div>
        </div>

        <!-- Progress Container -->
        <div class="progress-container">
            <div class="progress-header">
                <div class="step-counter">Step 1 of 7</div>
                <div class="time-estimate">⏱️ Estimated: 5 min</div>
            </div>
            <div class="overall-progress">
                <div class="progress-fill"></div>
            </div>
            <div class="progress-bar">
                <div class="progress-step active">
                    <span class="step-number">1</span>
                    <span class="step-text">Collect Information</span>
                </div>
                <div class="progress-step next">
                    <span class="step-number">2</span>
                    <span class="step-text">ChatGPT</span>
                </div>
                <div class="progress-step">
                    <span class="step-number">3</span>
                    <span class="step-text">Gemini</span>
                </div>
                <div class="progress-step">
                    <span class="step-number">3.5</span>
                    <span class="step-text">Pricing Research</span>
                </div>
                <div class="progress-step">
                    <span class="step-number">4</span>
                    <span class="step-text">Claude</span>
                </div>
                <div class="progress-step">
                    <span class="step-number">5</span>
                    <span class="step-text">Optimize</span>
                </div>
                <div class="progress-step">
                    <span class="step-number">6</span>
                    <span class="step-text">Complete</span>
                </div>
            </div>
        </div>

        <div class="main-card">
            <div class="header">
                <h1>Smart Mom Method</h1>
                <p class="subtitle">AI-Powered Business Planning for Busy Moms</p>
                <span class="badge">100% Free</span>
                
                <div class="cta-section">
                    <button class="btn-current" onclick="scrollToForm()">
                        🚀 Start Your Free Business Plan Now
                    </button>
                    <p style="margin-top: 16px; font-size: 0.95rem; opacity: 0.9;">No email required to browse • Full process takes 20-25 minutes</p>
                </div>
            </div>

            <div class="content">
                <div class="step-description">
                    <h2>📋 Step 1: Tell Us About Yourself</h2>
                    <p>The more specific you are, the better your personalized AI prompts will be. This information helps create business ideas that actually fit your real life.</p>
                </div>

                <div class="empowerment-message">
                    <div class="empowerment-title">You're Already Successful! 🌟</div>
                    <p class="empowerment-text">Managing a family is running a complex organization. You have negotiation skills, time management expertise, and crisis resolution abilities that most CEOs would envy. Now let's channel that into YOUR business!</p>
                </div>

                <!-- Personal & Family Situation -->
                <div class="form-section">
                    <h3>👨‍👩‍👧‍👦 Personal & Family Situation</h3>
                    
                    <div class="form-group">
                        <label>Your Name: <span class="required">*</span></label>
                        <input type="text" id="user-name" class="form-control" placeholder="Enter your name" onchange="validateField(this)" />
                        <div class="validation-message" id="user-name-validation"></div>
                    </div>

                    <div class="form-group">
                        <label>Your Email: <span class="required">*</span></label>
                        <input type="email" id="user-email" class="form-control" placeholder="your.email@example.com" onchange="validateField(this)" />
                        <div class="validation-message" id="user-email-validation"></div>
                    </div>
                    
                    <div class="form-group">
                        <label>Family Structure & Ages: <span class="required">*</span></label>
                        <textarea id="family-structure" class="form-control" rows="3" placeholder="e.g., 'Married with 5-year-old in kindergarten and 2-year-old at home. Husband works full-time. I handle most childcare and household duties.'" onchange="validateField(this)" oninput="updateCharCount(this, 1000)"></textarea>
                        <div class="char-counter">0/1000</div>
                        <div class="validation-message" id="family-structure-validation"></div>
                    </div>
                    
                    <div class="form-group">
                        <label>Daily Schedule & Availability: <span class="required">*</span></label>
                        <textarea id="daily-schedule" class="form-control" rows="3" placeholder="e.g., 'Free from 9-11am when youngest naps. Kids in bed by 8pm, so I have 8-10pm available. Weekends are family time except Sunday mornings.'" onchange="validateField(this)" oninput="updateCharCount(this, 1000)"></textarea>
                        <div class="char-counter">0/1000</div>
                        <div class="validation-message" id="daily-schedule-validation"></div>
                    </div>
                    
                    <div class="form-group">
                        <label>Current Work Status: <span class="required">*</span></label>
                        <select id="work-status" class="form-control" onchange="validateField(this)">
                            <option value="">Select your situation...</option>
                            <option value="stay-at-home">Stay-at-home super mom</option>
                            <option value="part-time">Working part-time</option>
                            <option value="full-time">Working full-time</option>
                            <option value="unemployed">Recently unemployed/looking</option>
                            <option value="student">Student/in school</option>
                        </select>
                        <div class="validation-message" id="work-status-validation"></div>
                    </div>
                </div>

                <!-- Skills & Experience -->
                <div class="form-section">
                    <h3>🎯 Skills & Experience</h3>
                    
                    <div class="form-group">
                        <label>Professional Background: <span class="required">*</span></label>
                        <textarea id="skills" class="form-control" rows="3" placeholder="e.g., '10 years in marketing, project management experience, good with Excel and presentations, former teacher, always been the organized one who plans family events.'" onchange="validateField(this)" oninput="updateCharCount(this, 750)"></textarea>
                        <div class="char-counter">0/750</div>
                        <div class="validation-message" id="skills-validation"></div>
                    </div>
                    
                    <div class="form-group">
                        <label>Monthly Income Goal: <span class="required">*</span></label>
                        <textarea id="income-goal" class="form-control" rows="2" placeholder="e.g., '$1,500/month to cover grocery budget, $3,000/month to replace part-time job, $5,000/month for family financial freedom.'" onchange="validateField(this)" oninput="updateCharCount(this, 300)"></textarea>
                        <div class="char-counter">0/300</div>
                        <div class="validation-message" id="income-goal-validation"></div>
                    </div>

                    <div class="form-group">
                        <label>Learning Willingness: <span class="required">*</span></label>
                        <select id="learning-willingness" class="form-control" onchange="validateField(this)">
                            <option value="">Select your approach...</option>
                            <option value="eager">Eager to learn new skills quickly</option>
                            <option value="moderate">Willing to learn gradually</option>
                            <option value="prefer-existing">Prefer using skills I already have</option>
                            <option value="minimal">Minimal learning, maximum results</option>
                        </select>
                        <div class="validation-message" id="learning-willingness-validation"></div>
                    </div>

                    <div class="form-group">
                        <label>Investment Level: <span class="required">*</span></label>
                        <select id="investment-level" class="form-control" onchange="validateField(this)">
                            <option value="">Select investment comfort...</option>
                            <option value="free-only">Free only - no money to invest</option>
                            <option value="minimal">Up to $50 if absolutely necessary</option>
                            <option value="moderate">$50-200 for the right opportunity</option>
                            <option value="invest">$200-500 if it's promising</option>
                            <option value="serious">$500+ ready to invest in my future</option>
                        </select>
                        <div class="validation-message" id="investment-level-validation"></div>
                    </div>
                </div>

                <!-- Business Preferences -->
                <div class="form-section">
                    <h3>💼 Business Preferences</h3>

                    <div class="form-group">
                        <label>Preferred Work Location: <span class="required">*</span></label>
                        <select id="work-location" class="form-control" onchange="validateField(this)">
                            <option value="">Select work location...</option>
                            <option value="home-only">Home only - need to be with kids</option>
                            <option value="home-flexible">Mostly home, occasional outings</option>
                            <option value="local-community">Local community/neighborhood</option>
                            <option value="hybrid">Mix of home and outside work</option>
                            <option value="travel-okay">Comfortable traveling for business</option>
                        </select>
                        <div class="validation-message" id="work-location-validation"></div>
                    </div>

                    <div class="form-group">
                        <label>Work Style Preference: <span class="required">*</span></label>
                        <select id="work-style" class="form-control" onchange="validateField(this)">
                            <option value="">Select work style...</option>
                            <option value="independent">Independent work - minimal client interaction</option>
                            <option value="some-interaction">Some client calls/meetings</option>
                            <option value="collaborative">Collaborative - enjoy working with people</option>
                            <option value="teaching-mentoring">Teaching/mentoring others</option>
                            <option value="creative-expressive">Creative and expressive work</option>
                        </select>
                        <div class="validation-message" id="work-style-validation"></div>
                    </div>

                    <div class="form-group">
                        <label>Are you comfortable being on camera/social media? <span class="required">*</span></label>
                        <select id="camera-comfort" class="form-control" onchange="validateField(this)">
                            <option value="">Select your comfort level...</option>
                            <option value="love-it">Love it! I'm comfortable on camera</option>
                            <option value="okay-with-it">Okay with it, can learn</option>
                            <option value="prefer-behind-scenes">Prefer behind-the-scenes work</option>
                            <option value="absolutely-not">Absolutely not comfortable</option>
                        </select>
                        <div class="validation-message" id="camera-comfort-validation"></div>
                    </div>

                    <div class="form-group">
                        <label>Timeline to first income: <span class="required">*</span></label>
                        <select id="income-timeline" class="form-control" onchange="validateField(this)">
                            <option value="">Select timeline...</option>
                            <option value="immediate">Immediate need (within 1-2 months)</option>
                            <option value="moderate">3-6 months is fine</option>
                            <option value="patient">Can wait 6-12 months for good business</option>
                            <option value="long-term">Building for long-term (1+ years)</option>
                        </select>
                        <div class="validation-message" id="income-timeline-validation"></div>
                    </div>

                    <div class="form-group">
                        <label>Maximum startup budget (total): <span class="required">*</span></label>
                        <select id="total-budget" class="form-control" onchange="validateField(this)">
                            <option value="">Select budget...</option>
                            <option value="zero">$0 - Must be completely free</option>
                            <option value="minimal">Under $50 total</option>
                            <option value="moderate">$50-200 if necessary</option>
                            <option value="invest">$200-500 for right opportunity</option>
                            <option value="serious">$500+ ready to invest</option>
                        </select>
                        <div class="validation-message" id="total-budget-validation"></div>
                    </div>
                </div>

                <!-- Learning Style Assessment -->
                <div class="form-section">
                    <h3>🧠 How You Learn Best</h3>
                    
                    <div class="form-group">
                        <label>How do you process information best? <span class="required">*</span></label>
                        <select id="learning-style" class="form-control" onchange="validateField(this)">
                            <option value="">Select learning preference...</option>
                            <option value="detailed-instructions">I need to read detailed instructions first</option>
                            <option value="video-tutorials">I prefer video tutorials and visual examples</option>
                            <option value="audio-explanations">I learn better when someone explains it to me</option>
                            <option value="accountability-partner">I work best with accountability partner check-ins</option>
                            <option value="trial-and-error">I like to try things and figure it out as I go</option>
                            <option value="written-checklists">I need written steps I can check off one by one</option>
                        </select>
                        <div class="validation-message" id="learning-style-validation"></div>
                    </div>
                </div>

                <!-- Pacing & Intensity -->
                <div class="form-section">
                    <h3>⏰ Your Ideal Pace</h3>
                    
                    <div class="form-group">
                        <label>What pace works best for your life right now? <span class="required">*</span></label>
                        <select id="work-pace" class="form-control" onchange="validateField(this)">
                            <option value="">Select your pace...</option>
                            <option value="slow-steady">Slow and steady - I need gentle progress with lots of flexibility</option>
                            <option value="moderate">Moderate pace - I can handle consistent daily actions</option>
                            <option value="intensive">Intensive - I'm motivated and ready to move fast</option>
                            <option value="variable">Variable - some days I'm all-in, other days I need breaks</option>
                        </select>
                        <div class="validation-message" id="work-pace-validation"></div>
                    </div>
                    
                    <div class="form-group">
                        <label>How many days per week can you realistically work on this? <span class="required">*</span></label>
                        <select id="work-frequency" class="form-control" onchange="validateField(this)">
                            <option value="">Select frequency...</option>
                            <option value="2-3-days">2-3 days per week (weekends only)</option>
                            <option value="3-4-days">3-4 days per week (skip busy days)</option>
                            <option value="5-6-days">5-6 days per week (consistent daily progress)</option>
                            <option value="7-days">7 days per week (I'm all-in right now)</option>
                        </select>
                        <div class="validation-message" id="work-frequency-validation"></div>
                    </div>
                </div>

                <!-- Technology Comfort -->
                <div class="form-section">
                    <h3>💻 Technology Comfort</h3>
                    
                    <div class="form-group">
                        <label>How comfortable are you with technology? <span class="required">*</span></label>
                        <select id="tech-comfort" class="form-control" onchange="validateField(this)">
                            <option value="">Select comfort level...</option>
                            <option value="mobile-first">I live on my phone - apps and mobile-first please</option>
                            <option value="computer-comfortable">Comfortable with computers but prefer simple tools</option>
                            <option value="basic-only">I stick to basic email and social media</option>
                            <option value="prefer-analog">I prefer pen and paper when possible</option>
                            <option value="need-support">I need tech support and hand-holding</option>
                        </select>
                        <div class="validation-message" id="tech-comfort-validation"></div>
                    </div>
                    
                    <div class="form-group">
                        <label>What tools do you already use successfully?</label>
                        <div class="checkbox-group" style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 8px; margin-top: 12px;">
                            <label style="display: flex; align-items: center; gap: 8px; font-weight: normal;"><input type="checkbox" id="tools-calendar" value="calendar"> Google Calendar/Apple Calendar</label>
                            <label style="display: flex; align-items: center; gap: 8px; font-weight: normal;"><input type="checkbox" id="tools-instagram" value="instagram"> Instagram for personal use</label>
                            <label style="display: flex; align-items: center; gap: 8px; font-weight: normal;"><input type="checkbox" id="tools-facebook" value="facebook"> Facebook and Facebook groups</label>
                            <label style="display: flex; align-items: center; gap: 8px; font-weight: normal;"><input type="checkbox" id="tools-messaging" value="messaging"> WhatsApp or text messaging</label>
                            <label style="display: flex; align-items: center; gap: 8px; font-weight: normal;"><input type="checkbox" id="tools-email" value="email"> Email regularly</label>
                            <label style="display: flex; align-items: center; gap: 8px; font-weight: normal;"><input type="checkbox" id="tools-video" value="video"> Zoom/video calls</label>
                            <label style="display: flex; align-items: center; gap: 8px; font-weight: normal;"><input type="checkbox" id="tools-photos" value="photos"> Basic photo editing</label>
                            <label style="display: flex; align-items: center; gap: 8px; font-weight: normal;"><input type="checkbox" id="tools-shopping" value="shopping"> Online shopping and payments</label>
                            <label style="display: flex; align-items: center; gap: 8px; font-weight: normal;"><input type="checkbox" id="tools-audio" value="audio"> Spotify/podcast apps</label>
                            <label style="display: flex; align-items: center; gap: 8px; font-weight: normal;"><input type="checkbox" id="tools-notes" value="notes"> Note-taking apps</label>
                        </div>
                    </div>
                </div>

                <button type="button" class="btn-primary" onclick="proceedToStepTwo()">
                    🚀 Create My Personalized Business Plan
                </button>

                <!-- Step 2: AI Platform Integration -->
                <div id="step2Content" class="hidden">
                    <div class="step-description">
                        <h2>🤖 Step 2: Generate with ChatGPT</h2>
                        <p>We've created a personalized prompt based on your information. Copy this prompt and paste it into ChatGPT to generate your first set of business ideas.</p>
                    </div>

                    <div class="auto-populated-prompt">
                        <div class="auto-populate-status ready">✨ Prompt Ready</div>
                        <h4>Your Personalized ChatGPT Prompt:</h4>
                        <textarea id="chatgptPrompt" class="form-control" rows="8" readonly></textarea>
                        <button class="btn-primary" onclick="copyToClipboard('chatgptPrompt')">📋 Copy Prompt</button>
                        <a href="https://chat.openai.com" target="_blank" class="platform-button chatgpt-button">Open ChatGPT</a>
                    </div>

                    <div class="form-group">
                        <label>Paste ChatGPT Response Here: <span class="required">*</span></label>
                        <textarea id="chatgpt-response" class="form-control" rows="6" placeholder="Paste the complete response from ChatGPT here..." onchange="parseChatGPTResponse()"></textarea>
                        <div class="validation-message" id="chatgpt-response-validation"></div>
                    </div>

                    <button type="button" class="btn-primary" onclick="proceedToGemini()">
                        🚀 Continue to Gemini
                    </button>
                </div>

                <!-- Step 3: Gemini Integration -->
                <div id="step3Content" class="hidden">
                    <div class="step-description">
                        <h2>🔍 Step 3: Refine with Gemini</h2>
                        <p>Now we'll use Gemini to refine and expand on your business ideas with market research and validation.</p>
                    </div>

                    <div class="auto-populated-prompt">
                        <div class="auto-populate-status ready">✨ Prompt Ready</div>
                        <h4>Your Personalized Gemini Prompt:</h4>
                        <textarea id="geminiPrompt" class="form-control" rows="8" readonly></textarea>
                        <button class="btn-primary" onclick="copyToClipboard('geminiPrompt')">📋 Copy Prompt</button>
                        <a href="https://gemini.google.com" target="_blank" class="platform-button gemini-button">Open Gemini</a>
                    </div>

                    <div class="form-group">
                        <label>Paste Gemini Response Here: <span class="required">*</span></label>
                        <textarea id="gemini-response" class="form-control" rows="6" placeholder="Paste the complete response from Gemini here..." onchange="parseGeminiResponse()"></textarea>
                        <div class="validation-message" id="gemini-response-validation"></div>
                    </div>

                    <button type="button" class="btn-primary" onclick="proceedToPricingResearch()">
                        🚀 Continue to Pricing Research
                    </button>
                </div>

                <!-- Step 3.5: Realistic Pricing Research -->
                <div id="step3_5Content" class="hidden">
                    <div class="step-description">
                        <h2>💰 Step 3.5: Realistic Pricing Research</h2>
                        <p>Before finalizing your plan, let's research realistic pricing for your selected business idea. This crucial step ensures you set competitive rates that actually get you clients.</p>
                    </div>

                    <div class="business-idea-selector" id="businessIdeaSelection">
                        <h4>📝 Your Selected Business Idea:</h4>
                        <div id="selectedBusinessIdea" style="background: var(--light-sage); padding: 20px; border-radius: 12px; margin: 16px 0; font-weight: 600; color: var(--charcoal);">
                            Your business idea will appear here after ChatGPT analysis...
                        </div>
                    </div>

                    <div class="auto-populated-prompt">
                        <div class="auto-populate-status ready">✨ Pricing Research Prompt Ready</div>
                        <h4>Your Personalized Gemini Deep Research Prompt:</h4>
                        <textarea id="pricingResearchPrompt" class="form-control" rows="10" readonly></textarea>
                        <button class="btn-primary" onclick="copyToClipboard('pricingResearchPrompt')">📋 Copy Pricing Research Prompt</button>
                        <a href="https://gemini.google.com" target="_blank" class="platform-button gemini-button">Open Gemini for Pricing Research</a>
                    </div>

                    <div class="form-group">
                        <label>Paste Pricing Research Response Here: <span class="required">*</span></label>
                        <textarea id="pricing-research-response" class="form-control" rows="6" placeholder="Paste the complete pricing research response from Gemini here..." onchange="validateField(this)"></textarea>
                        <div class="validation-message" id="pricing-research-response-validation"></div>
                    </div>

                    <button type="button" class="btn-primary" onclick="proceedToClaude()">
                        🚀 Continue to Claude
                    </button>
                </div>

                <!-- Step 4: Claude Integration -->
                <div id="step4Content" class="hidden">
                    <div class="step-description">
                        <h2>🎯 Step 4: Perfect with Claude</h2>
                        <p>Finally, we'll use Claude to create your comprehensive ADHD-friendly business plan with actionable steps and realistic timelines.</p>
                    </div>

                    <div class="auto-populated-prompt">
                        <div class="auto-populate-status ready">✨ ADHD-Friendly Plan Prompt Ready</div>
                        <h4>Your Personalized Claude Prompt (ADHD-Optimized):</h4>
                        <textarea id="claudePrompt" class="form-control" rows="12" readonly></textarea>
                        <button class="btn-primary" onclick="copyToClipboard('claudePrompt')">📋 Copy Prompt</button>
                        <a href="https://claude.ai" target="_blank" class="platform-button claude-button">Open Claude</a>
                    </div>

                    <div class="form-group">
                        <label>Paste Claude Response Here: <span class="required">*</span></label>
                        <textarea id="claude-response" class="form-control" rows="6" placeholder="Paste the complete response from Claude here..." onchange="generateFinalPlan()"></textarea>
                        <div class="validation-message" id="claude-response-validation"></div>
                    </div>

                    <button type="button" class="btn-primary" onclick="completePlan()">
                        🎉 Complete My Business Plan
                    </button>
                </div>

                <!-- Final Plan -->
                <div id="finalPlanContent" class="hidden">
                    <div class="celebration-section">
                        <h2>🎉 Congratulations! Your Business Plan is Ready!</h2>
                        <p>You've successfully created a comprehensive, ADHD-friendly business plan tailored specifically for your life as a busy mom!</p>
                        <button class="btn-primary" onclick="downloadBusinessPlan()" style="background: white; color: var(--sage-green); margin-top: 24px;">
                            📥 Download Your Business Plan
                        </button>
                    </div>

                    <!-- Interactive ADHD-Friendly Calendar -->
                    <div id="interactiveCalendar" class="interactive-calendar hidden">
                        <div class="calendar-header">
                            <h2 class="calendar-title">🗓️ Your 12-Week ADHD-Friendly Business Calendar</h2>
                            <p class="calendar-subtitle">Maximum 4 tasks per day • Step-by-step checkboxes • Built for neurodivergent minds</p>
                            
                            <div class="calendar-progress">
                                <div class="progress-stats">
                                    <div class="stat-item">
                                        <span class="stat-number" id="completedTasks">0</span>
                                        <span class="stat-label">Tasks Done</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-number" id="totalTasks">0</span>
                                        <span class="stat-label">Total Tasks</span>
                                    </div>
                                    <div class="stat-item">
                                        <span class="stat-number" id="currentWeek">1</span>
                                        <span class="stat-label">Current Week</span>
                                    </div>
                                </div>
                                <div class="overall-calendar-progress">
                                    <div class="overall-progress-fill" id="overallProgressFill"></div>
                                </div>
                            </div>

                            <!-- Energy Tracker for Spoon Theory -->
                            <div class="energy-tracker">
                                <div class="energy-title">🥄 Today's Energy Level (Spoon Theory)</div>
                                <div class="energy-levels">
                                    <div class="energy-level" data-energy="1" onclick="setEnergyLevel(1)">🔋</div>
                                    <div class="energy-level" data-energy="2" onclick="setEnergyLevel(2)">🔋</div>
                                    <div class="energy-level" data-energy="3" onclick="setEnergyLevel(3)">🔋</div>
                                    <div class="energy-level" data-energy="4" onclick="setEnergyLevel(4)">🔋</div>
                                    <div class="energy-level" data-energy="5" onclick="setEnergyLevel(5)">🔋</div>
                                </div>
                            </div>

                            <div class="week-selector" id="weekSelector">
                                <!-- Week buttons will be generated dynamically -->
                            </div>
                        </div>

                        <div id="calendarWeeks">
                            <!-- Calendar weeks will be generated dynamically -->
                        </div>

                        <!-- Rest Day Message -->
                        <div id="restDayMessage" class="rest-day-message hidden">
                            <div class="rest-day-title">🛌 Rest Day Activated</div>
                            <p>Your energy is low today. That's perfectly okay! Rest is productive too. Come back when you're ready. 💙</p>
                        </div>

                        <!-- Adaptive Suggestions -->
                        <div id="adaptiveSuggestions" class="adaptive-suggestions hidden">
                            <div class="adaptive-title">💡 Gentle Suggestion</div>
                            <div class="adaptive-text" id="adaptiveText"></div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Share Your Success Story (Optional):</label>
                        <textarea id="testimonial" class="form-control" rows="4" placeholder="How was your experience creating your business plan? Your story could inspire other moms!"></textarea>
                        <button type="button" class="btn-primary" onclick="submitTestimonial()">
                            💬 Share Your Story
                        </button>
                    </div>
                </div>

                <!-- Celebration Popup -->
                <div id="celebrationPopup" class="celebration-popup">
                    <div class="celebration-emoji">🎉</div>
                    <h3 id="celebrationTitle">Amazing Work!</h3>
                    <p id="celebrationMessage">You completed a task!</p>
                    <button class="btn-primary" onclick="closeCelebration()" style="margin-top: 20px;">Continue ✨</button>
                </div>

                <!-- Services Section -->
                <section class="services-section" id="servicesSection">
                    <div class="services-container">
                        <h2 class="services-title">Choose Your Smart Mom Support Level</h2>
                        <p class="services-subtitle">Two specialized tracks designed for your specific needs:</p>
                        
                        <!-- Life Organization Track -->
                        <div class="track-section">
                            <h3 class="track-title">Life Organization Track</h3>
                            <p class="track-subtitle">Perfect for busy moms who want to organize daily life, family schedules, and household management</p>
                            
                            <div class="service-blocks">
                                <!-- Free Support -->
                                <div class="service-block">
                                    <div class="service-icon">FREE</div>
                                    <h3>Life Organization Support</h3>
                                    <p class="service-price">$0</p>
                                    <p class="service-description">Struggling with daily chaos? Let's troubleshoot your family organization challenges together!</p>
                                    <ul class="service-features">
                                        <li>30-minute support call</li>
                                        <li>Family schedule troubleshooting</li>
                                        <li>Organization quick wins</li>
                                        <li>Executive function strategies</li>
                                    </ul>
                                    <button class="service-button free-button" onclick="openCalendly('https://calendly.com/momsurvivaltoolkit/free-smart-mom-call-30-min')">
                                        Book Free Support Call
                                    </button>
                                </div>
                                
                                <!-- Done-For-You Life Calendar -->
                                <div class="service-block popular-service">
                                    <div class="popular-badge">Most Popular</div>
                                    <div class="service-icon">DONE FOR YOU</div>
                                    <h3>Life Organization Calendar</h3>
                                    <p class="service-price">$39</p>
                                    <p class="service-description">I'll create your personalized family organization calendar - meal planning, pickup schedules, household routines!</p>
                                    <ul class="service-features">
                                        <li>Custom family calendar creation</li>
                                        <li>Daily routines & schedules</li>
                                        <li>Meal planning integration</li>
                                        <li>School/activity coordination</li>
                                        <li>Ready-to-download file</li>
                                    </ul>
                                    <button class="service-button premium-button" onclick="handleStripePayment('life-calendar')">
                                        Get My Life Calendar $39
                                    </button>
                                </div>
                                
                                <!-- Life Organization Training -->
                                <div class="service-block">
                                    <div class="service-icon">AI TRAINING</div>
                                    <h3>Life Organization AI Training</h3>
                                    <p class="service-price">$89</p>
                                    <p class="service-description">Get your calendar created PLUS learn executive function strategies and organization systems!</p>
                                    <ul class="service-features">
                                        <li>60-minute training session</li>
                                        <li>Custom calendar creation</li>
                                        <li>ADHD-friendly organization tips</li>
                                        <li>Future update training</li>
                                        <li>Family routine optimization</li>
                                    </ul>
                                    <button class="service-button premium-button" onclick="handleStripePayment('life-training')">
                                        Book AI Training $89
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Business Growth Track -->
                        <div class="track-section">
                            <h3 class="track-title">Business Growth Track</h3>
                            <p class="track-subtitle">For mom entrepreneurs who want to build and scale their business while managing family life</p>
                            
                            <div class="service-blocks">
                                <!-- Free Business Support -->
                                <div class="service-block">
                                    <div class="service-icon">FREE</div>
                                    <h3>Business Planning Support</h3>
                                    <p class="service-price">$0</p>
                                    <p class="service-description">Stuck with your business calendar? Let's troubleshoot your entrepreneurial challenges together!</p>
                                    <ul class="service-features">
                                        <li>30-minute strategy call</li>
                                        <li>Business calendar troubleshooting</li>
                                        <li>Revenue planning advice</li>
                                        <li>Mom entrepreneur tips</li>
                                    </ul>
                                    <button class="service-button free-button" onclick="openCalendly('https://calendly.com/momsurvivaltoolkit/30min')">
                                        Book Free Strategy Call
                                    </button>
                                </div>
                                
                                <!-- Done-For-You Business Calendar -->
                                <div class="service-block popular-service">
                                    <div class="popular-badge">Most Popular</div>
                                    <div class="service-icon">BUSINESS</div>
                                    <h3>Business Growth Calendar</h3>
                                    <p class="service-price">$49</p>
                                    <p class="service-description">I'll create your personalized business planning calendar with revenue goals, marketing tasks, and growth strategies!</p>
                                    <ul class="service-features">
                                        <li>Custom business calendar creation</li>
                                        <li>Revenue goal planning</li>
                                        <li>Marketing task scheduling</li>
                                        <li>Client management system</li>
                                        <li>SEO content suggestions</li>
                                    </ul>
                                    <button class="service-button premium-button" onclick="handleStripePayment('business-calendar')">
                                        Get My Business Calendar $49
                                    </button>
                                </div>
                                
                                <!-- Business Training -->
                                <div class="service-block">
                                    <div class="service-icon">AI TRAINING</div>
                                    <h3>Business Growth AI Training</h3>
                                    <p class="service-price">$100</p>
                                    <p class="service-description">Complete business planning system + personal training to scale your mom business successfully!</p>
                                    <ul class="service-features">
                                        <li>90-minute strategy session</li>
                                        <li>Custom business calendar</li>
                                        <li>Revenue optimization training</li>
                                        <li>Marketing automation setup</li>
                                        <li>Ongoing update training</li>
                                    </ul>
                                    <button class="service-button premium-button" onclick="handleStripePayment('business-training')">
                                        Book AI Training $100
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <script>
        // Global Variables
        let currentLanguage = 'en';
        let currentUser = null;
        let formData = {};
        let currentStep = 1;
        let authMode = 'signup';
        let selectedBusinessIdea = '';
        let calendarData = null;
        let currentEnergyLevel = 3;
        let calendarProgress = {
            completedTasks: 0,
            totalTasks: 0,
            completedSteps: 0,
            totalSteps: 0,
            currentWeek: 1
        };

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyCfDJS5aoj2UlqJzN8hcHYi_DwNhF9SeUQ",
            authDomain: "smart-mom-method-4a804.firebaseapp.com",
            projectId: "smart-mom-method-4a804",
            storageBucket: "smart-mom-method-4a804.firebasestorage.app",
            messagingSenderId: "847553438888",
            appId: "1:847553438888:web:3275de458a4e4c0235ce9d",
            measurementId: "G-SKRCMSVH72"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();

        // Updated required fields validation for 7 steps
        const requiredFieldsByStep = {
            0: ['user-name', 'user-email', 'family-structure', 'daily-schedule', 'work-status', 'skills', 'income-goal', 'learning-willingness', 'investment-level', 'work-location', 'work-style', 'camera-comfort', 'income-timeline', 'total-budget', 'learning-style', 'work-pace', 'work-frequency', 'tech-comfort'],
            1: ['chatgpt-response'],
            2: ['gemini-response'],
            3: ['pricing-research-response'], // NEW STEP 3.5
            4: ['claude-response'],
            5: [],
            6: []
        };

        // Authentication Functions
        function showAuthModal(mode = 'signup') {
            authMode = mode;
            const modal = document.getElementById('authModal');
            const title = document.getElementById('authTitle');
            const nameField = document.getElementById('authName');
            const confirmPasswordField = document.getElementById('authConfirmPassword');
            const submitBtn = document.getElementById('authSubmitBtn');
            const switchText = document.getElementById('authSwitchText');
            const switchLink = document.getElementById('authSwitchLink');
            
            if (mode === 'signup') {
                title.textContent = 'Create Your Account';
                nameField.style.display = 'block';
                confirmPasswordField.style.display = 'block';
                submitBtn.textContent = 'Create Account';
                switchText.textContent = 'Already have an account?';
                switchLink.textContent = 'Sign In';
            } else {
                title.textContent = 'Welcome Back!';
                nameField.style.display = 'none';
                confirmPasswordField.style.display = 'none';
                submitBtn.textContent = 'Sign In';
                switchText.textContent = "Don't have an account?";
                switchLink.textContent = 'Create Account';
            }
            
            modal.classList.add('active');
            clearAuthMessages();
        }

        function closeAuthModal() {
            document.getElementById('authModal').classList.remove('active');
            clearAuthMessages();
        }

        function toggleAuthMode() {
            authMode = authMode === 'signup' ? 'signin' : 'signup';
            showAuthModal(authMode);
        }

        function clearAuthMessages() {
            document.getElementById('authError').classList.add('hidden');
            document.getElementById('authSuccess').classList.add('hidden');
        }

        function showAuthError(message) {
            const errorDiv = document.getElementById('authError');
            errorDiv.textContent = message;
            errorDiv.classList.remove('hidden');
        }

        function showAuthSuccess(message) {
            const successDiv = document.getElementById('authSuccess');
            successDiv.textContent = message;
            successDiv.classList.remove('hidden');
        }

        // Authentication Event Handlers
        document.getElementById('authForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const email = document.getElementById('authEmail').value;
            const password = document.getElementById('authPassword').value;
            const name = document.getElementById('authName').value;
            const confirmPassword = document.getElementById('authConfirmPassword').value;
            
            clearAuthMessages();
            
            try {
                if (authMode === 'signup') {
                    if (password !== confirmPassword) {
                        showAuthError('Passwords do not match');
                        return;
                    }
                    
                    const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                    await userCredential.user.updateProfile({ displayName: name });
                    
                    // Save user data to Firestore
                    await db.collection('users').doc(userCredential.user.uid).set({
                        name: name,
                        email: email,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        language: currentLanguage
                    });
                    
                    showAuthSuccess('Account created successfully!');
                } else {
                    await auth.signInWithEmailAndPassword(email, password);
                    showAuthSuccess('Welcome back!');
                }
                
                setTimeout(() => {
                    closeAuthModal();
                    startOnboarding();
                }, 1500);
                
            } catch (error) {
                showAuthError(error.message);
            }
        });

        async function signInWithGoogle() {
            try {
                const provider = new firebase.auth.GoogleAuthProvider();
                const result = await auth.signInWithPopup(provider);
                
                // Save user data to Firestore if new user
                const userRef = db.collection('users').doc(result.user.uid);
                const userDoc = await userRef.get();
                
                if (!userDoc.exists) {
                    await userRef.set({
                        name: result.user.displayName,
                        email: result.user.email,
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        language: currentLanguage,
                        provider: 'google'
                    });
                }
                
                showAuthSuccess('Welcome! Signed in with Google');
                setTimeout(() => {
                    closeAuthModal();
                    startOnboarding();
                }, 1500);
                
            } catch (error) {
                showAuthError(error.message);
            }
        }

        async function signOut() {
            try {
                await auth.signOut();
                document.getElementById('userStatusBar').classList.add('hidden');
                document.getElementById('welcomeModal').classList.remove('hidden');
            } catch (error) {
                console.error('Sign out error:', error);
            }
        }

        // Auth State Observer
        auth.onAuthStateChanged(async (user) => {
            if (user) {
                currentUser = user;
                document.getElementById('userWelcome').textContent = `Welcome back, ${user.displayName || user.email}!`;
                document.getElementById('userStatusBar').classList.remove('hidden');
                
                // Load user's saved progress
                await loadUserProgress();
            } else {
                currentUser = null;
                document.getElementById('userStatusBar').classList.add('hidden');
            }
        });

        // User Progress Management
        async function loadUserProgress() {
            if (!currentUser) return;
            
            try {
                const progressDoc = await db.collection('progress').doc(currentUser.uid).get();
                if (progressDoc.exists) {
                    const progress = progressDoc.data();
                    
                    // Restore form data
                    Object.keys(progress.formData || {}).forEach(key => {
                        const element = document.getElementById(key);
                        if (element) {
                            element.value = progress.formData[key];
                        }
                    });
                    
                    // Restore current step
                    if (progress.currentStep) {
                        currentStep = progress.currentStep;
                        updateProgressDisplay();
                    }
                    
                    // Show returning user status
                    showReturningUserStatus(progress.lastSaved);
                }
            } catch (error) {
                console.error('Error loading progress:', error);
            }
        }

        async function saveFormProgress() {
            if (!currentUser) {
                // Save to localStorage for non-authenticated users
                var data = {
                    formData: collectFormData(),
                    currentStep: currentStep,
                    lastSaved: new Date().toISOString()
                };
                try {
                    localStorage.setItem('smartMomWorkflowData', JSON.stringify(data));
                } catch (e) {
                    console.log('localStorage not available');
                }
                return;
            }
            
            try {
                await db.collection('progress').doc(currentUser.uid).set({
                    formData: collectFormData(),
                    currentStep: currentStep,
                    lastSaved: firebase.firestore.FieldValue.serverTimestamp(),
                    language: currentLanguage
                }, { merge: true });
            } catch (error) {
                console.error('Error saving progress:', error);
            }
        }

        function showReturningUserStatus(lastSaved) {
            const statusDiv = document.createElement('div');
            statusDiv.className = 'returning-user-status';
            statusDiv.innerHTML = `
                <h4>🎉 Welcome Back!</h4>
                <p>Your progress has been restored from ${lastSaved ? new Date(lastSaved.toDate()).toLocaleDateString() : 'your last session'}.</p>
            `;
            
            const formSection = document.querySelector('.form-section');
            formSection.parentNode.insertBefore(statusDiv, formSection);
        }

        // Form Management Functions
        function collectFormData() {
            return {
                'user-name': document.getElementById('user-name')?.value || '',
                'user-email': document.getElementById('user-email')?.value || '',
                'family-structure': document.getElementById('family-structure')?.value || '',
                'daily-schedule': document.getElementById('daily-schedule')?.value || '',
                'work-status': document.getElementById('work-status')?.value || '',
                'skills': document.getElementById('skills')?.value || '',
                'income-goal': document.getElementById('income-goal')?.value || '',
                'learning-willingness': document.getElementById('learning-willingness')?.value || '',
                'investment-level': document.getElementById('investment-level')?.value || '',
                'work-location': document.getElementById('work-location')?.value || '',
                'work-style': document.getElementById('work-style')?.value || '',
                'camera-comfort': document.getElementById('camera-comfort')?.value || '',
                'income-timeline': document.getElementById('income-timeline')?.value || '',
                'total-budget': document.getElementById('total-budget')?.value || '',
                'learning-style': document.getElementById('learning-style')?.value || '',
                'work-pace': document.getElementById('work-pace')?.value || '',
                'work-frequency': document.getElementById('work-frequency')?.value || '',
                'tech-comfort': document.getElementById('tech-comfort')?.value || '',
                'tech-tools': collectSelectedTools(),
                'chatgpt-response': document.getElementById('chatgpt-response')?.value || '',
                'gemini-response': document.getElementById('gemini-response')?.value || '',
                'pricing-research-response': document.getElementById('pricing-research-response')?.value || '',
                'claude-response': document.getElementById('claude-response')?.value || ''
            };
        }

        function collectSelectedTools() {
            const tools = [];
            const checkboxes = document.querySelectorAll('.checkbox-group input[type="checkbox"]:checked');
            checkboxes.forEach(cb => tools.push(cb.value));
            return tools;
        }

        function validateField(field) {
            const fieldId = field.id;
            const value = field.value.trim();
            const validationDiv = document.getElementById(`${fieldId}-validation`);
            
            let isValid = true;
            let message = '';
            
            // Required field validation
            if (field.hasAttribute('required') || field.classList.contains('required')) {
                if (!value) {
                    isValid = false;
                    message = 'This field is required';
                }
            }
            
            // Email validation
            if (field.type === 'email' && value) {
                const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
                if (!emailRegex.test(value)) {
                    isValid = false;
                    message = 'Please enter a valid email address';
                }
            }
            
            // Update validation message
            if (validationDiv) {
                validationDiv.textContent = message;
                validationDiv.className = isValid ? 'validation-message success' : 'validation-message';
            }
            
            // Auto-save if authenticated
            if (isValid && currentUser) {
                saveFormProgress();
            }
            
            return isValid;
        }

        function validateCurrentStep() {
            const requiredFields = requiredFieldsByStep[currentStep - 1] || [];
            
            let allValid = true;
            requiredFields.forEach(fieldId => {
                const field = document.getElementById(fieldId);
                if (field && !validateField(field)) {
                    allValid = false;
                }
            });
            
            return allValid;
        }

        function updateCharCount(textarea, maxLength) {
            const counter = textarea.parentNode.querySelector('.char-counter');
            if (counter) {
                const currentLength = textarea.value.length;
                counter.textContent = `${currentLength}/${maxLength}`;
                
                if (currentLength > maxLength) {
                    counter.style.color = '#e57373';
                } else {
                    counter.style.color = '';
                }
            }
        }

        // Progress Management - Updated for 7 steps
        function updateProgressDisplay() {
            const progressFill = document.querySelector('.progress-fill');
            const stepCounter = document.querySelector('.step-counter');
            const progressSteps = document.querySelectorAll('.progress-step');
            
            // Update progress bar
            const progressPercentage = (currentStep / 7) * 100;
            progressFill.style.width = `${progressPercentage}%`;
            
            // Update step counter
            stepCounter.textContent = `Step ${currentStep} of 7`;
            
            // Update step indicators
            progressSteps.forEach((step, index) => {
                step.classList.remove('active', 'completed', 'next');
                
                if (index + 1 < currentStep) {
                    step.classList.add('completed');
                } else if (index + 1 === currentStep) {
                    step.classList.add('active');
                } else if (index + 1 === currentStep + 1) {
                    step.classList.add('next');
                }
            });
        }

        // AI Platform Integration with Enhanced Prompts
        function generateChatGPTPrompt() {
            const data = collectFormData();
            
            const realismInstructions = `
**CRITICAL INSTRUCTIONS - BE EXTREMELY REALISTIC:**
- This person is a BEGINNER, not an expert
- Be brutally honest about challenges and timelines  
- Don't suggest businesses requiring experience they don't have
- Focus on DOWN-TO-EARTH, practical solutions only
- Consider their family constraints and available time
- If they said "free only," respect that completely
- Suggest pricing that will actually get clients, not scare them away

**REMEMBER:** A mom with 2 hours/day and no business experience should NOT be suggested:
- Businesses requiring 40+ hours/week
- High-skill services they've never done
- Anything requiring significant upfront investment (if they said free)
- Complex businesses with steep learning curves

Focus on what's ACTUALLY doable for their situation.`;
            
            const prompt = `${realismInstructions}

Create 3 personalized business ideas for a busy mom with this profile:

**Personal Situation:**
- Name: ${data['user-name']}
- Family: ${data['family-structure']}
- Daily Schedule: ${data['daily-schedule']}
- Work Status: ${data['work-status']}

**Skills & Goals:**
- Background: ${data.skills}
- Income Goal: ${data['income-goal']}
- Learning Willingness: ${data['learning-willingness']}
- Investment Level: ${data['investment-level']}
- Work Location: ${data['work-location']}
- Work Style: ${data['work-style']}
- Camera Comfort: ${data['camera-comfort']}
- Income Timeline: ${data['income-timeline']}
- Total Budget: ${data['total-budget']}
- Language: ${currentLanguage === 'es' ? 'Spanish' : 'English'}

**Learning & Work Preferences:**
- Learning Style: ${data['learning-style']}
- Work Pace: ${data['work-pace']}
- Work Frequency: ${data['work-frequency']}
- Tech Comfort: ${data['tech-comfort']}
- Current Tech Tools: ${data['tech-tools'].join(', ') || 'None specified'}

Please provide:
1. 3 specific business ideas that fit her schedule and skills
2. Estimated startup costs for each (respecting her budget constraints)
3. Expected time to profitability (realistic expectations)
4. Required weekly time commitment (fitting her availability)
5. Specific first steps for each idea

Focus on businesses that can be started with her stated investment level and can accommodate her family responsibilities. Be HONEST about challenges and timeframes.`;

            // ADD customization based on Phase 4A data:
            let customizations = '\n\n**CUSTOMIZATION REQUIREMENTS:**\n';
            
            // Learning style customization
            if (data['learning-style'] === 'video-tutorials') {
                customizations += '- Include video tutorial recommendations and visual examples\n';
            } else if (data['learning-style'] === 'detailed-instructions') {
                customizations += '- Provide extremely detailed, step-by-step written instructions\n';
            } else if (data['learning-style'] === 'audio-explanations') {
                customizations += '- Recommend podcast resources and audio-based learning\n';
            } else if (data['learning-style'] === 'written-checklists') {
                customizations += '- Format everything as actionable checklists\n';
            }
            
            // Pacing customization
            if (data['work-pace'] === 'slow-steady') {
                customizations += '- Focus on very gentle, flexible timelines with lots of grace periods\n';
            } else if (data['work-pace'] === 'intensive') {
                customizations += '- Provide aggressive timelines for motivated, fast-moving implementation\n';
            }
            
            // Tech comfort customization
            if (data['tech-comfort'] === 'basic-only') {
                customizations += '- Recommend only the simplest, most user-friendly tools (email, Facebook, basic apps)\n';
            } else if (data['tech-comfort'] === 'mobile-first') {
                customizations += '- Prioritize mobile apps and phone-based solutions over computer work\n';
            }
            
            return prompt + customizations;
        }

        function autoPopulateGeminiPrompt() {
            const data = collectFormData();
            const chatgptIdeas = data['chatgpt-response'];
            
            const realismInstructions = `
**CRITICAL INSTRUCTIONS - BE EXTREMELY REALISTIC:**
- This person is a BEGINNER, not an expert
- Be brutally honest about challenges and timelines  
- Don't suggest businesses requiring experience they don't have
- Focus on DOWN-TO-EARTH, practical solutions only
- Consider their family constraints and available time
- If they said "free only," respect that completely
- Suggest pricing that will actually get clients, not scare them away`;
            
            const prompt = `${realismInstructions}

Based on these business ideas generated for a busy mom: 

${chatgptIdeas}

**Learning & Work Preferences to Consider:**
- Learning Style: ${data['learning-style']}
- Work Pace: ${data['work-pace']}
- Work Frequency: ${data['work-frequency']}
- Tech Comfort: ${data['tech-comfort']}
- Current Tech Tools: ${data['tech-tools'].join(', ') || 'None specified'}

Please provide:
1. Market research and validation for each idea
2. Target audience analysis (who will actually pay for this?)
3. Competition assessment (realistic view of what she's up against)
4. Marketing strategies that work for busy moms (simple, effective)
5. Potential challenges and realistic solutions
6. Revenue projections for first year (conservative estimates)

Focus on practical, actionable insights that a mom entrepreneur can implement while managing family responsibilities. Be honest about what's actually achievable.`;

            // ADD customization based on Phase 4A data:
            let customizations = '\n\n**CUSTOMIZATION REQUIREMENTS:**\n';
            
            // Learning style customization
            if (data['learning-style'] === 'video-tutorials') {
                customizations += '- Include video tutorial recommendations and visual examples\n';
            } else if (data['learning-style'] === 'detailed-instructions') {
                customizations += '- Provide extremely detailed, step-by-step written instructions\n';
            } else if (data['learning-style'] === 'audio-explanations') {
                customizations += '- Recommend podcast resources and audio-based learning\n';
            } else if (data['learning-style'] === 'written-checklists') {
                customizations += '- Format everything as actionable checklists\n';
            }
            
            // Pacing customization
            if (data['work-pace'] === 'slow-steady') {
                customizations += '- Focus on very gentle, flexible timelines with lots of grace periods\n';
            } else if (data['work-pace'] === 'intensive') {
                customizations += '- Provide aggressive timelines for motivated, fast-moving implementation\n';
            }
            
            // Tech comfort customization
            if (data['tech-comfort'] === 'basic-only') {
                customizations += '- Recommend only the simplest, most user-friendly tools (email, Facebook, basic apps)\n';
            } else if (data['tech-comfort'] === 'mobile-first') {
                customizations += '- Prioritize mobile apps and phone-based solutions over computer work\n';
            }
            
            return prompt + customizations;
        }

        function generatePricingResearchPrompt() {
            const data = collectFormData();
            const selectedIdea = selectedBusinessIdea || 'the selected business idea';
            const userLocation = 'Lincoln, Nebraska'; // Default location
            
            const prompt = `Research realistic pricing for ${selectedIdea} specifically for someone just starting:

**Personal Context:**
- Complete beginner with no business experience
- Daily Schedule: ${data['daily-schedule']}
- Investment Level: ${data['investment-level']}
- Income Timeline: ${data['income-timeline']}
- Location: ${userLocation}

**PRICING RESEARCH NEEDED:**

1. **Beginner Pricing (Month 1-6):** What should someone with no experience charge?
   - Specific dollar amounts, not ranges
   - What makes pricing competitive vs. too low/high
   - How to price when you have no portfolio

2. **Developing Skills (Month 6-18):** Pricing as competency grows
   - When and how much to raise prices
   - What achievements justify price increases

3. **Experienced Rates (18+ months):** What experts charge
   - Market ceiling for this service
   - Premium pricing strategies

4. **Geographic Considerations:** Market rates for ${userLocation}
   - Local market analysis
   - Online vs. local pricing differences

5. **Common Pricing Mistakes:** What kills new businesses
   - Pricing too low (and why)
   - Pricing too high (and consequences)
   - Hidden costs beginners forget

6. **Competition Analysis:** What others actually charge vs advertise
   - Real competitor pricing research
   - How to position against competition

**BE BRUTALLY HONEST about realistic expectations for beginners.** 
Include specific examples and dollar amounts. Don't sugarcoat - give the real data that will help her succeed.`;

            return prompt;
        }

        function autoPopulateClaudePrompt() {
            const data = collectFormData();
            const chatgptIdeas = data['chatgpt-response'];
            const geminiAnalysis = data['gemini-response'];
            const pricingResearch = data['pricing-research-response'];
            
            const realismInstructions = `
**CRITICAL INSTRUCTIONS - BE EXTREMELY REALISTIC:**
- This person is a BEGINNER, not an expert
- Be brutally honest about challenges and timelines  
- Don't suggest businesses requiring experience they don't have
- Focus on DOWN-TO-EARTH, practical solutions only
- Consider their family constraints and available time
- If they said "free only," respect that completely
- Suggest pricing that will actually get clients, not scare them away`;

            const adhdInstructions = `
**CRITICAL: Design this calendar for ADHD, Autism, and Executive Function challenges**

DAILY STRUCTURE RULES:
- MAXIMUM 4 tasks per day (never exceed this number)
- Each task broken into 3-7 specific sub-steps
- No vague instructions - be extremely detailed
- Include exact links to platforms/tools needed
- Specify if account creation required (FREE vs PAID with exact costs)
- Add time estimates including thinking/processing time
- Build in 15-minute buffer between tasks

TASK FORMAT EXAMPLE:
✅ Task 1: Create Instagram Business Account (FREE - 30 minutes)
  □ Step 1: Go to instagram.com/business (click this exact link)
  □ Step 2: Click "Create account" → Select "Business Account"  
  □ Step 3: Choose username: [yourname] + "business" or "coaching"
  □ Step 4: Upload profile photo (phone selfie works perfectly)
  □ Step 5: Write bio: "I help [your target audience] achieve [specific result]"
  □ Step 6: Add contact info: your email and phone

**SOCIAL MEDIA BUSINESS REQUIREMENTS:**
If this is a social media business, include:
- SEO-optimized title ideas (10 options)
- Current viral hashtags for the niche
- 30-day content calendar with post ideas
- Platform-specific posting schedules
- Engagement strategies for each platform

**PLATFORM INTEGRATION REQUIREMENTS:**
For each platform/tool mentioned:
- Direct clickable links
- Step-by-step account creation (with screenshots description)
- Exact costs (FREE vs $X/month)
- What to look for on each page
- Common troubleshooting tips

**12-WEEK DETAILED BREAKDOWN:**
Format each day EXACTLY like this for parsing:

WEEK 1 - DAY 1:
Task 1: [Task Title] ([FREE/PAID $X] - [X minutes])
- Step 1: [Exact instruction with link if needed]
- Step 2: [Exact instruction with link if needed]
- Step 3: [Exact instruction with link if needed]

Task 2: [Task Title] ([FREE/PAID $X] - [X minutes])
- Step 1: [Exact instruction with link if needed]
- Step 2: [Exact instruction with link if needed]

[Continue for all 84 days total]

**CRITICAL:** Use this EXACT format for every single day so the calendar system can parse it correctly.

Generate the COMPLETE 12-week calendar with daily actionable tasks.`;
            
            const prompt = `${realismInstructions}

${adhdInstructions}

Create a comprehensive ADHD-friendly business plan based on:

**Original Business Ideas:**
${chatgptIdeas}

**Market Research & Analysis:**
${geminiAnalysis}

**Realistic Pricing Research:**
${pricingResearch}

**Mom's Profile:**
- Schedule: ${data['daily-schedule']}
- Skills: ${data.skills}
- Goal: ${data['income-goal']}
- Camera Comfort: ${data['camera-comfort']}
- Work Style: ${data['work-style']}
- Budget: ${data['total-budget']}
- Timeline: ${data['income-timeline']}

**Learning & Work Preferences:**
- Learning Style: ${data['learning-style']}
- Work Pace: ${data['work-pace']}
- Work Frequency: ${data['work-frequency']}
- Tech Comfort: ${data['tech-comfort']}
- Current Tech Tools: ${data['tech-tools'].join(', ') || 'None specified'}

Please create a detailed business plan including:
1. Executive summary
2. ADHD-optimized step-by-step implementation timeline
3. Daily action items for first 12 weeks (following ADHD rules above)
4. Resource requirements and realistic budget
5. Success metrics and achievable milestones
6. Risk management strategies
7. Work-life balance considerations specific to moms

Make this actionable and realistic for a busy mom entrepreneur with executive function challenges. Use the pricing research to set realistic expectations.`;

            // ADD customization based on Phase 4A data:
            let customizations = '\n\n**CUSTOMIZATION REQUIREMENTS:**\n';
            
            // Learning style customization
            if (data['learning-style'] === 'video-tutorials') {
                customizations += '- Include video tutorial recommendations and visual examples\n';
            } else if (data['learning-style'] === 'detailed-instructions') {
                customizations += '- Provide extremely detailed, step-by-step written instructions\n';
            } else if (data['learning-style'] === 'audio-explanations') {
                customizations += '- Recommend podcast resources and audio-based learning\n';
            } else if (data['learning-style'] === 'written-checklists') {
                customizations += '- Format everything as actionable checklists\n';
            }
            
            // Pacing customization
            if (data['work-pace'] === 'slow-steady') {
                customizations += '- Focus on very gentle, flexible timelines with lots of grace periods\n';
            } else if (data['work-pace'] === 'intensive') {
                customizations += '- Provide aggressive timelines for motivated, fast-moving implementation\n';
            }
            
            // Tech comfort customization
            if (data['tech-comfort'] === 'basic-only') {
                customizations += '- Recommend only the simplest, most user-friendly tools (email, Facebook, basic apps)\n';
            } else if (data['tech-comfort'] === 'mobile-first') {
                customizations += '- Prioritize mobile apps and phone-based solutions over computer work\n';
            }
            
            return prompt + customizations;
        }

        function parseChatGPTResponse() {
            const response = document.getElementById('chatgpt-response').value;
            if (response.trim()) {
                // Auto-generate Gemini prompt
                document.getElementById('geminiPrompt').value = autoPopulateGeminiPrompt();
                
                // Extract business idea for pricing research
                extractBusinessIdea(response);
                
                // Save progress
                saveFormProgress();
            }
        }

        function parseGeminiResponse() {
            const response = document.getElementById('gemini-response').value;
            if (response.trim()) {
                // Save progress
                saveFormProgress();
            }
        }

        function extractBusinessIdea(chatgptResponse) {
            // Simple extraction - take first business idea mentioned
            const lines = chatgptResponse.split('\n');
            for (let line of lines) {
                if (line.includes('1.') || line.includes('Business Idea 1') || line.includes('Option 1')) {
                    selectedBusinessIdea = line.replace(/^\d+\.?\s*/, '').trim();
                    break;
                }
            }
            
            // Fallback: take first sentence that looks like a business idea
            if (!selectedBusinessIdea) {
                const sentences = chatgptResponse.split('.');
                for (let sentence of sentences) {
                    if (sentence.length > 20 && sentence.length < 100) {
                        selectedBusinessIdea = sentence.trim();
                        break;
                    }
                }
            }
            
            // Update UI
            const businessIdeaDiv = document.getElementById('selectedBusinessIdea');
            if (businessIdeaDiv) {
                businessIdeaDiv.textContent = selectedBusinessIdea || 'Selected business idea from ChatGPT response';
            }
        }

        // Step Navigation - Updated for 7 steps
        function proceedToStepTwo() {
            if (!validateCurrentStep()) {
                alert('Please fill in all required fields before continuing.');
                return;
            }
            
            currentStep = 2;
            updateProgressDisplay();
            
            // Generate personalized prompt
            document.getElementById('chatgptPrompt').value = generateChatGPTPrompt();
            
            // Show step 2 content
            document.getElementById('step2Content').classList.remove('hidden');
            document.getElementById('step2Content').scrollIntoView({ behavior: 'smooth' });
            
            // Save progress
            saveFormProgress();
        }

        function proceedToGemini() {
            if (!document.getElementById('chatgpt-response').value.trim()) {
                alert('Please paste your ChatGPT response before continuing.');
                return;
            }
            
            currentStep = 3;
            updateProgressDisplay();
            
            // Show step 3 content
            document.getElementById('step3Content').classList.remove('hidden');
            document.getElementById('step3Content').scrollIntoView({ behavior: 'smooth' });
            
            // Save progress
            saveFormProgress();
        }

        function proceedToPricingResearch() {
            if (!document.getElementById('gemini-response').value.trim()) {
                alert('Please paste your Gemini response before continuing.');
                return;
            }
            
            currentStep = 4; // Step 3.5 in display but step 4 in logic
            updateProgressDisplay();
            
            // Generate pricing research prompt
            document.getElementById('pricingResearchPrompt').value = generatePricingResearchPrompt();
            
            // Show step 3.5 content
            document.getElementById('step3_5Content').classList.remove('hidden');
            document.getElementById('step3_5Content').scrollIntoView({ behavior: 'smooth' });
            
            // Save progress
            saveFormProgress();
        }

        function proceedToClaude() {
            if (!document.getElementById('pricing-research-response').value.trim()) {
                alert('Please paste your pricing research response before continuing.');
                return;
            }
            
            currentStep = 5;
            updateProgressDisplay();
            
            // Auto-generate Claude prompt
            document.getElementById('claudePrompt').value = autoPopulateClaudePrompt();
            
            // Show step 4 content
            document.getElementById('step4Content').classList.remove('hidden');
            document.getElementById('step4Content').scrollIntoView({ behavior: 'smooth' });
            
            // Save progress
            saveFormProgress();
        }

        function completePlan() {
            if (!document.getElementById('claude-response').value.trim()) {
                alert('Please paste your Claude response before completing.');
                return;
            }
            
            currentStep = 7;
            updateProgressDisplay();
            
            generateFinalPlan();
            
            // Show final content
            document.getElementById('finalPlanContent').classList.remove('hidden');
            document.getElementById('finalPlanContent').scrollIntoView({ behavior: 'smooth' });
            
            // Save progress
            saveFormProgress();
        }

        function generateFinalPlan() {
            // Combine all AI responses into final plan
            const data = collectFormData();
            formData.finalPlan = {
                chatgpt: data['chatgpt-response'],
                gemini: data['gemini-response'],
                pricingResearch: data['pricing-research-response'],
                claude: data['claude-response'],
                generatedAt: new Date().toISOString()
            };
            
            // Parse Claude response and generate interactive calendar
            parseClaudeResponseToCalendar(data['claude-response']);
        }

        // Interactive Calendar System
        function parseClaudeResponseToCalendar(claudeResponse) {
            if (!claudeResponse || claudeResponse.trim() === '') {
                console.log('No Claude response to parse');
                return;
            }

            try {
                calendarData = parseCalendarStructure(claudeResponse);
                if (calendarData && calendarData.weeks && calendarData.weeks.length > 0) {
                    generateInteractiveCalendar();
                    document.getElementById('interactiveCalendar').classList.remove('hidden');
                } else {
                    console.log('Could not parse calendar structure');
                }
            } catch (error) {
                console.error('Error parsing calendar:', error);
            }
        }

        function parseCalendarStructure(response) {
            const calendar = {
                weeks: [],
                businessType: '',
                socialMediaContent: null
            };

            // Detect if it's a social media business
            const isSocialMediaBusiness = response.toLowerCase().includes('instagram') || 
                                        response.toLowerCase().includes('facebook') || 
                                        response.toLowerCase().includes('tiktok') ||
                                        response.toLowerCase().includes('social media');

            if (isSocialMediaBusiness) {
                calendar.businessType = 'social-media';
                calendar.socialMediaContent = extractSocialMediaContent(response);
            }

            // Parse week by week
            const weekMatches = response.match(/WEEK\s*(\d+)[^\n]*\n([\s\S]*?)(?=WEEK\s*\d+|$)/gi);
            
            if (weekMatches) {
                weekMatches.forEach((weekText, weekIndex) => {
                    const weekNumber = weekIndex + 1;
                    const week = {
                        number: weekNumber,
                        title: `Week ${weekNumber}`,
                        days: []
                    };

                    // Parse days within the week
                    const dayMatches = weekText.match(/DAY\s*(\d+):([\s\S]*?)(?=DAY\s*\d+|WEEK\s*\d+|$)/gi);
                    
                    if (dayMatches) {
                        dayMatches.forEach((dayText, dayIndex) => {
                            const dayNumber = dayIndex + 1;
                            const day = {
                                number: dayNumber,
                                title: `Day ${dayNumber}`,
                                tasks: []
                            };

                            // Parse tasks within the day
                            const taskMatches = dayText.match(/Task\s*(\d+):\s*([^\n]*)\s*\(([^)]*)\)\s*\n([\s\S]*?)(?=Task\s*\d+|DAY\s*\d+|$)/gi);
                            
                            if (taskMatches) {
                                taskMatches.forEach(taskText => {
                                    const task = parseTaskFromText(taskText);
                                    if (task) {
                                        day.tasks.push(task);
                                    }
                                });
                            }

                            if (day.tasks.length > 0) {
                                week.days.push(day);
                            }
                        });
                    }

                    if (week.days.length > 0) {
                        calendar.weeks.push(week);
                    }
                });
            }

            return calendar;
        }

        function parseTaskFromText(taskText) {
            try {
                const lines = taskText.split('\n').filter(line => line.trim());
                if (lines.length === 0) return null;

                const firstLine = lines[0];
                const taskMatch = firstLine.match(/Task\s*\d+:\s*([^(]*)\s*\(([^)]*)\)/);
                
                if (!taskMatch) return null;

                const title = taskMatch[1].trim();
                const meta = taskMatch[2].trim();
                
                // Parse cost and time from meta
                const isFree = meta.toLowerCase().includes('free');
                const costMatch = meta.match(/\$(\d+)/);
                const timeMatch = meta.match(/(\d+)\s*min/);
                
                const task = {
                    title: title,
                    cost: isFree ? 'FREE' : (costMatch ? `${costMatch[1]}` : 'FREE'),
                    time: timeMatch ? `${timeMatch[1]} min` : '30 min',
                    steps: [],
                    completed: false,
                    id: generateTaskId()
                };

                // Parse steps
                for (let i = 1; i < lines.length; i++) {
                    const line = lines[i].trim();
                    if (line.startsWith('- Step') || line.startsWith('Step')) {
                        const stepText = line.replace(/^-?\s*Step\s*\d+:\s*/, '');
                        if (stepText) {
                            const step = {
                                text: stepText,
                                completed: false,
                                id: generateStepId(),
                                hasLink: stepText.includes('http') || stepText.includes('.com')
                            };
                            task.steps.push(step);
                        }
                    }
                }

                return task;
            } catch (error) {
                console.error('Error parsing task:', error);
                return null;
            }
        }

        function extractSocialMediaContent(response) {
            const content = {
                seoTitles: [],
                hashtags: [],
                contentIdeas: []
            };

            // Extract SEO titles
            const seoSection = response.match(/SEO[^:]*:[\s\S]*?(?=\n\n|\n[A-Z])/i);
            if (seoSection) {
                const titles = seoSection[0].match(/\d+\.\s*[^\n]+/g);
                if (titles) {
                    content.seoTitles = titles.map(title => title.replace(/^\d+\.\s*/, '').trim());
                }
            }

            // Extract hashtags
            const hashtagSection = response.match(/#\w+/g);
            if (hashtagSection) {
                content.hashtags = [...new Set(hashtagSection)].slice(0, 20);
            }

            // Extract content ideas
            const contentSection = response.match(/content[^:]*:[\s\S]*?(?=\n\n|\n[A-Z])/i);
            if (contentSection) {
                const ideas = contentSection[0].match(/\d+\.\s*[^\n]+/g);
                if (ideas) {
                    content.contentIdeas = ideas.map(idea => idea.replace(/^\d+\.\s*/, '').trim());
                }
            }

            return content;
        }

        function generateInteractiveCalendar() {
            if (!calendarData || !calendarData.weeks) return;

            generateWeekSelector();
            generateCalendarWeeks();
            updateCalendarStats();
            loadCalendarProgress();
            showWeek(1);
        }

        function generateWeekSelector() {
            const selector = document.getElementById('weekSelector');
            selector.innerHTML = '';

            calendarData.weeks.forEach(week => {
                const button = document.createElement('button');
                button.className = 'week-btn';
                button.textContent = `Week ${week.number}`;
                button.onclick = () => showWeek(week.number);
                button.id = `week-btn-${week.number}`;
                selector.appendChild(button);
            });
        }

        function generateCalendarWeeks() {
            const container = document.getElementById('calendarWeeks');
            container.innerHTML = '';

            calendarData.weeks.forEach(week => {
                const weekDiv = document.createElement('div');
                weekDiv.className = 'calendar-content';
                weekDiv.id = `week-${week.number}`;
                
                weekDiv.innerHTML = `
                    <div class="week-view">
                        <div class="week-header">
                            <div class="week-title">${week.title}</div>
                            <div class="week-progress">Progress: <span id="week-${week.number}-progress">0%</span></div>
                        </div>
                        <div class="days-grid" id="days-${week.number}">
                            ${generateDaysHTML(week)}
                        </div>
                    </div>
                `;
                
                container.appendChild(weekDiv);
            });
        }

        function generateDaysHTML(week) {
            return week.days.map(day => `
                <div class="day-card" id="day-${week.number}-${day.number}">
                    <div class="day-header">
                        <div class="day-title">Day ${day.number}</div>
                        <div class="day-progress">
                            <div class="day-progress-bar">
                                <div class="day-progress-fill" id="day-progress-${week.number}-${day.number}"></div>
                            </div>
                            <span class="day-percentage" id="day-percentage-${week.number}-${day.number}">0%</span>
                        </div>
                    </div>
                    <ul class="task-list">
                        ${generateTasksHTML(day.tasks, week.number, day.number)}
                    </ul>
                </div>
            `).join('');
        }

        function generateTasksHTML(tasks, weekNumber, dayNumber) {
            return tasks.map(task => `
                <li class="task-item" id="task-${task.id}">
                    <div class="task-header">
                        <div>
                            <div class="task-title">${task.title}</div>
                            <div class="task-meta">
                                <span class="task-cost ${task.cost === 'FREE' ? 'free' : ''}">${task.cost}</span>
                                <span class="task-time">${task.time}</span>
                            </div>
                        </div>
                        <div class="task-progress">
                            <div class="task-progress-bar">
                                <div class="task-progress-fill" id="task-progress-${task.id}"></div>
                            </div>
                            <span class="task-percentage" id="task-percentage-${task.id}">0%</span>
                        </div>
                    </div>
                    <ul class="step-list">
                        ${generateStepsHTML(task.steps)}
                    </ul>
                </li>
            `).join('');
        }

        function generateStepsHTML(steps) {
            return steps.map(step => `
                <li class="step-item" id="step-${step.id}">
                    <div class="step-checkbox" onclick="toggleStep('${step.id}')">
                        <span class="step-check" id="check-${step.id}">✓</span>
                    </div>
                    <div class="step-text" id="text-${step.id}">
                        ${formatStepText(step.text)}
                    </div>
                </li>
            `).join('');
        }

        function formatStepText(text) {
            // Convert URLs to clickable links
            return text.replace(/(https?:\/\/[^\s]+)/g, '<a href="$1" target="_blank" class="step-link">$1</a>');
        }

        function showWeek(weekNumber) {
            // Hide all weeks
            document.querySelectorAll('.calendar-content').forEach(week => {
                week.classList.remove('active');
            });
            
            // Show selected week
            const weekElement = document.getElementById(`week-${weekNumber}`);
            if (weekElement) {
                weekElement.classList.add('active');
            }
            
            // Update week button states
            document.querySelectorAll('.week-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const activeBtn = document.getElementById(`week-btn-${weekNumber}`);
            if (activeBtn) {
                activeBtn.classList.add('active');
            }
            
            calendarProgress.currentWeek = weekNumber;
            updateCalendarStats();
        }

        function toggleStep(stepId) {
            const step = findStepById(stepId);
            if (!step) return;

            step.completed = !step.completed;
            
            const checkbox = document.getElementById(`check-${stepId}`);
            const stepElement = document.getElementById(`step-${stepId}`);
            const textElement = document.getElementById(`text-${stepId}`);
            
            if (step.completed) {
                stepElement.querySelector('.step-checkbox').classList.add('checked');
                textElement.classList.add('completed');
                showCelebration('Step completed! 🎉', 'You\'re making amazing progress!');
            } else {
                stepElement.querySelector('.step-checkbox').classList.remove('checked');
                textElement.classList.remove('completed');
            }
            
            updateTaskProgress(stepId);
            updateDayProgress(stepId);
            updateWeekProgress();
            updateCalendarStats();
            saveCalendarProgress();
            
            // Check for adaptive suggestions
            checkAdaptiveSuggestions();
        }

        function findStepById(stepId) {
            for (const week of calendarData.weeks) {
                for (const day of week.days) {
                    for (const task of day.tasks) {
                        const step = task.steps.find(s => s.id === stepId);
                        if (step) return step;
                    }
                }
            }
            return null;
        }

        function findTaskByStepId(stepId) {
            for (const week of calendarData.weeks) {
                for (const day of week.days) {
                    for (const task of day.tasks) {
                        if (task.steps.find(s => s.id === stepId)) {
                            return task;
                        }
                    }
                }
            }
            return null;
        }

        function updateTaskProgress(stepId) {
            const task = findTaskByStepId(stepId);
            if (!task) return;

            const completedSteps = task.steps.filter(s => s.completed).length;
            const totalSteps = task.steps.length;
            const percentage = totalSteps > 0 ? (completedSteps / totalSteps) * 100 : 0;
            
            const progressBar = document.getElementById(`task-progress-${task.id}`);
            const progressText = document.getElementById(`task-percentage-${task.id}`);
            
            if (progressBar) progressBar.style.width = `${percentage}%`;
            if (progressText) progressText.textContent = `${Math.round(percentage)}%`;
            
            // Mark task as completed if all steps are done
            const wasCompleted = task.completed;
            task.completed = completedSteps === totalSteps;
            
            if (task.completed && !wasCompleted) {
                showCelebration('Task completed! 🚀', 'You\'re crushing your business goals!');
            }
        }

        function updateDayProgress(stepId) {
            const week = findWeekByStepId(stepId);
            const day = findDayByStepId(stepId);
            if (!week || !day) return;

            let completedSteps = 0;
            let totalSteps = 0;
            
            day.tasks.forEach(task => {
                task.steps.forEach(step => {
                    totalSteps++;
                    if (step.completed) completedSteps++;
                });
            });
            
            const percentage = totalSteps > 0 ? (completedSteps / totalSteps) * 100 : 0;
            
            const progressBar = document.getElementById(`day-progress-${week.number}-${day.number}`);
            const progressText = document.getElementById(`day-percentage-${week.number}-${day.number}`);
            const dayCard = document.getElementById(`day-${week.number}-${day.number}`);
            
            if (progressBar) progressBar.style.width = `${percentage}%`;
            if (progressText) progressText.textContent = `${Math.round(percentage)}%`;
            
            if (percentage === 100 && dayCard) {
                dayCard.classList.add('completed');
                showCelebration('Day completed! 🌟', 'You\'ve finished all tasks for today!');
            } else if (dayCard) {
                dayCard.classList.remove('completed');
            }
        }

        function findWeekByStepId(stepId) {
            for (const week of calendarData.weeks) {
                for (const day of week.days) {
                    for (const task of day.tasks) {
                        if (task.steps.find(s => s.id === stepId)) {
                            return week;
                        }
                    }
                }
            }
            return null;
        }

        function findDayByStepId(stepId) {
            for (const week of calendarData.weeks) {
                for (const day of week.days) {
                    for (const task of day.tasks) {
                        if (task.steps.find(s => s.id === stepId)) {
                            return day;
                        }
                    }
                }
            }
            return null;
        }

        function updateWeekProgress() {
            calendarData.weeks.forEach(week => {
                let completedSteps = 0;
                let totalSteps = 0;
                
                week.days.forEach(day => {
                    day.tasks.forEach(task => {
                        task.steps.forEach(step => {
                            totalSteps++;
                            if (step.completed) completedSteps++;
                        });
                    });
                });
                
                const percentage = totalSteps > 0 ? (completedSteps / totalSteps) * 100 : 0;
                const progressElement = document.getElementById(`week-${week.number}-progress`);
                if (progressElement) {
                    progressElement.textContent = `${Math.round(percentage)}%`;
                }
                
                // Update week button state
                const weekBtn = document.getElementById(`week-btn-${week.number}`);
                if (weekBtn) {
                    if (percentage === 100) {
                        weekBtn.classList.add('completed');
                    } else {
                        weekBtn.classList.remove('completed');
                    }
                }
            });
        }

        function updateCalendarStats() {
            let completedTasks = 0;
            let totalTasks = 0;
            let completedSteps = 0;
            let totalSteps = 0;
            
            calendarData.weeks.forEach(week => {
                week.days.forEach(day => {
                    day.tasks.forEach(task => {
                        totalTasks++;
                        if (task.completed) completedTasks++;
                        
                        task.steps.forEach(step => {
                            totalSteps++;
                            if (step.completed) completedSteps++;
                        });
                    });
                });
            });
            
            calendarProgress.completedTasks = completedTasks;
            calendarProgress.totalTasks = totalTasks;
            calendarProgress.completedSteps = completedSteps;
            calendarProgress.totalSteps = totalSteps;
            
            // Update UI
            document.getElementById('completedTasks').textContent = completedTasks;
            document.getElementById('totalTasks').textContent = totalTasks;
            document.getElementById('currentWeek').textContent = calendarProgress.currentWeek;
            
            const overallPercentage = totalSteps > 0 ? (completedSteps / totalSteps) * 100 : 0;
            document.getElementById('overallProgressFill').style.width = `${overallPercentage}%`;
        }

        function setEnergyLevel(level) {
            currentEnergyLevel = level;
            
            // Update UI
            document.querySelectorAll('.energy-level').forEach(el => {
                el.classList.remove('selected');
            });
            
            for (let i = 1; i <= level; i++) {
                const energyEl = document.querySelector(`[data-energy="${i}"]`);
                if (energyEl) energyEl.classList.add('selected');
            }
            
            // Show adaptive suggestions based on energy level
            showEnergyBasedSuggestions(level);
            
            // Save energy level
            saveCalendarProgress();
        }

        function showEnergyBasedSuggestions(level) {
            const suggestions = document.getElementById('adaptiveSuggestions');
            const text = document.getElementById('adaptiveText');
            const restMessage = document.getElementById('restDayMessage');
            
            if (level <= 2) {
                restMessage.classList.remove('hidden');
                suggestions.classList.add('hidden');
            } else {
                restMessage.classList.add('hidden');
                suggestions.classList.remove('hidden');
                
                const suggestionTexts = {
                    3: "You're at medium energy today. Focus on 1-2 easier tasks and take breaks between them.",
                    4: "Good energy level! You can tackle most tasks today, but don't overdo it.",
                    5: "High energy day! Perfect time to tackle challenging tasks, but remember to take breaks."
                };
                
                text.textContent = suggestionTexts[level] || suggestionTexts[3];
            }
        }

        function checkAdaptiveSuggestions() {
            // Check if user is hyperfocusing (too many tasks completed quickly)
            const recentCompletions = getRecentCompletions();
            if (recentCompletions > 5) {
                showAdaptiveSuggestion("🧠 Hyperfocus Alert", "You've been working intensely! Consider taking a 15-minute break to recharge.");
            }
            
            // Check for overwhelm patterns
            if (calendarProgress.currentWeek > 1 && getWeekCompletion(calendarProgress.currentWeek - 1) < 30) {
                showAdaptiveSuggestion("💙 Gentle Reminder", "Last week was challenging. That's totally normal! Focus on just one small step today.");
            }
        }

        function showAdaptiveSuggestion(title, message) {
            const suggestions = document.getElementById('adaptiveSuggestions');
            const titleEl = suggestions.querySelector('.adaptive-title');
            const textEl = suggestions.querySelector('.adaptive-text');
            
            titleEl.textContent = title;
            textEl.textContent = message;
            suggestions.classList.remove('hidden');
            
            // Auto-hide after 10 seconds
            setTimeout(() => {
                suggestions.classList.add('hidden');
            }, 10000);
        }

        function getRecentCompletions() {
            // Simple implementation - count completions in current session
            return calendarProgress.completedSteps % 10;
        }

        function getWeekCompletion(weekNumber) {
            const week = calendarData.weeks.find(w => w.number === weekNumber);
            if (!week) return 0;
            
            let completed = 0;
            let total = 0;
            
            week.days.forEach(day => {
                day.tasks.forEach(task => {
                    task.steps.forEach(step => {
                        total++;
                        if (step.completed) completed++;
                    });
                });
            });
            
            return total > 0 ? (completed / total) * 100 : 0;
        }

        function showCelebration(title, message) {
            const popup = document.getElementById('celebrationPopup');
            const titleEl = document.getElementById('celebrationTitle');
            const messageEl = document.getElementById('celebrationMessage');
            
            titleEl.textContent = title;
            messageEl.textContent = message;
            popup.classList.add('show');
            
            // Auto-close after 3 seconds
            setTimeout(() => {
                popup.classList.remove('show');
            }, 3000);
        }

        function closeCelebration() {
            document.getElementById('celebrationPopup').classList.remove('show');
        }

        function saveCalendarProgress() {
            if (!calendarData) return;
            
            const progressData = {
                calendarData: calendarData,
                calendarProgress: calendarProgress,
                currentEnergyLevel: currentEnergyLevel,
                lastSaved: new Date().toISOString()
            };
            
            if (currentUser) {
                // Save to Firebase
                db.collection('calendar-progress').doc(currentUser.uid).set(progressData, { merge: true })
                  .catch(error => console.error('Error saving calendar progress:', error));
            } else {
                // Save to localStorage
                try {
                    localStorage.setItem('smartMomCalendarProgress', JSON.stringify(progressData));
                } catch (e) {
                    console.log('localStorage not available');
                }
            }
        }

        function loadCalendarProgress() {
            if (currentUser) {
                // Load from Firebase
                db.collection('calendar-progress').doc(currentUser.uid).get()
                  .then(doc => {
                      if (doc.exists) {
                          const data = doc.data();
                          if (data.calendarData) {
                              calendarData = data.calendarData;
                              calendarProgress = data.calendarProgress || calendarProgress;
                              currentEnergyLevel = data.currentEnergyLevel || 3;
                              setEnergyLevel(currentEnergyLevel);
                              updateCalendarStats();
                          }
                      }
                  })
                  .catch(error => console.error('Error loading calendar progress:', error));
            } else {
                // Load from localStorage
                try {
                    const saved = localStorage.getItem('smartMomCalendarProgress');
                    if (saved) {
                        const data = JSON.parse(saved);
                        if (data.calendarData) {
                            calendarData = data.calendarData;
                            calendarProgress = data.calendarProgress || calendarProgress;
                            currentEnergyLevel = data.currentEnergyLevel || 3;
                            setEnergyLevel(currentEnergyLevel);
                            updateCalendarStats();
                        }
                    }
                } catch (e) {
                    console.log('Error loading from localStorage');
                }
            }
        }

        function generateTaskId() {
            return 'task_' + Math.random().toString(36).substr(2, 9);
        }

        function generateStepId() {
            return 'step_' + Math.random().toString(36).substr(2, 9);
        }

        // Utility Functions
        function copyToClipboard(elementId) {
            const element = document.getElementById(elementId);
            element.select();
            document.execCommand('copy');
            
            // Show feedback
            const button = event.target;
            const originalText = button.textContent;
            button.textContent = '✅ Copied!';
            setTimeout(() => {
                button.textContent = originalText;
            }, 2000);
        }

        function downloadBusinessPlan() {
            const data = collectFormData();
            const planContent = `
SMART MOM METHOD - BUSINESS PLAN
Generated: ${new Date().toLocaleDateString()}

=== PERSONAL PROFILE ===
Name: ${data['user-name']}
Email: ${data['user-email']}
Family Structure: ${data['family-structure']}
Daily Schedule: ${data['daily-schedule']}
Work Status: ${data['work-status']}
Professional Background: ${data.skills}
Income Goal: ${data['income-goal']}
Learning Willingness: ${data['learning-willingness']}
Investment Level: ${data['investment-level']}
Work Location: ${data['work-location']}
Work Style: ${data['work-style']}
Camera Comfort: ${data['camera-comfort']}
Income Timeline: ${data['income-timeline']}
Total Budget: ${data['total-budget']}

=== PHASE 4A ENHANCEMENTS ===
Learning Style: ${data['learning-style']}
Work Pace: ${data['work-pace']}
Work Frequency: ${data['work-frequency']}
Tech Comfort: ${data['tech-comfort']}
Tech Tools: ${data['tech-tools'].join(', ') || 'None specified'}

=== CHATGPT BUSINESS IDEAS ===
${data['chatgpt-response']}

=== GEMINI MARKET ANALYSIS ===
${data['gemini-response']}

=== REALISTIC PRICING RESEARCH ===
${data['pricing-research-response']}

=== CLAUDE ADHD-FRIENDLY IMPLEMENTATION PLAN ===
${data['claude-response']}

=== INTERACTIVE CALENDAR PROGRESS ===
${calendarProgress ? `
Completed Tasks: ${calendarProgress.completedTasks}/${calendarProgress.totalTasks}
Completed Steps: ${calendarProgress.completedSteps}/${calendarProgress.totalSteps}
Current Week: ${calendarProgress.currentWeek}
Overall Progress: ${calendarProgress.totalSteps > 0 ? Math.round((calendarProgress.completedSteps / calendarProgress.totalSteps) * 100) : 0}%
` : 'Calendar not yet generated'}

Generated with Smart Mom Method - smartmommethod.com
Interactive ADHD-Friendly Calendar included for step-by-step implementation
            `;
            
            const blob = new Blob([planContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `smart-mom-business-plan-${new Date().toISOString().split('T')[0]}.txt`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        async function submitTestimonial() {
            const testimonial = document.getElementById('testimonial').value.trim();
            if (!testimonial) {
                alert('Please write your testimonial before submitting.');
                return;
            }
            
            try {
                // Submit to webhook
                const formData = new FormData();
                formData.append('testimonial', testimonial);
                formData.append('user_name', currentUser?.displayName || 'Anonymous');
                formData.append('timestamp', new Date().toISOString());
                
                await fetch('https://momsurvivaltoolkit.app.n8n.cloud/webhook-test/smart-mom-form', {
                    method: 'POST',
                    body: formData
                });
                
                if (currentUser) {
                    await db.collection('testimonials').add({
                        userId: currentUser.uid,
                        userName: currentUser.displayName || 'Anonymous',
                        testimonial: testimonial,
                        submittedAt: firebase.firestore.FieldValue.serverTimestamp()
                    });
                }
                
                alert('Thank you for sharing your story! Your testimonial has been submitted.');
                document.getElementById('testimonial').value = '';
            } catch (error) {
                console.error('Error submitting testimonial:', error);
                alert('Thank you for your feedback! We appreciate your story.');
            }
        }

        // Service Integration Functions
        function handleStripePayment(service) {
            const stripeUrls = {
                'life-calendar': 'https://buy.stripe.com/cN100gj9M0fo83eUa1a17Vm07',
                'life-training': 'https://buy.stripe.com/5kQ6oHb946RSn22zbz7Vm06',
                'business-calendar': 'https://buy.stripe.com/3cI8wP7NS2BmbLqgc9L7Vm05',
                'business-training': 'https://buy.stripe.com/fZu8wP8RW1x8i18eec97Vm04'
            };
            
            const url = stripeUrls[service];
            if (url) {
                window.open(url, '_blank');
            }
        }

        function openCalendly(url) {
            window.open(url, '_blank');
        }

        // Core Functions
        function startOnboarding() {
            document.getElementById('welcomeModal').classList.add('hidden');
        }

        function checkReturningUser() {
            // Check for saved data
            var savedData = null;
            try {
                savedData = localStorage.getItem('smartMomWorkflowData');
            } catch (e) {
                console.log('localStorage not available');
            }
            
            if (savedData || currentUser) {
                if (currentUser) {
                    // User is authenticated, load their progress
                    loadUserProgress();
                    startOnboarding();
                } else if (savedData) {
                    // Load from localStorage
                    const data = JSON.parse(savedData);
                    Object.keys(data.formData || {}).forEach(key => {
                        const element = document.getElementById(key);
                        if (element) {
                            element.value = data.formData[key];
                        }
                    });
                    
                    if (data.currentStep) {
                        currentStep = data.currentStep;
                        updateProgressDisplay();
                    }
                    
                    showReturningUserStatus(data.lastSaved);
                    startOnboarding();
                }
            } else {
                showAuthModal('signin');
            }
        }

        function changeLanguage(lang) {
            currentLanguage = lang;
            
            // Update active language button
            document.querySelectorAll('.language-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.getElementById(`lang-${lang}`).classList.add('active');
            
            // Save language preference
            if (currentUser) {
                db.collection('users').doc(currentUser.uid).update({
                    language: lang
                }).catch(console.error);
            }
        }

        function scrollToForm() {
            const formSection = document.querySelector('.form-section');
            if (formSection) {
                formSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // Auto-animate user counter
        let userCount = 2847;
        function animateUserCounter() {
            setInterval(() => {
                userCount += Math.floor(Math.random() * 3);
                const counterElement = document.querySelector('.user-counter span');
                if (counterElement) {
                    counterElement.textContent = `🎉 ${userCount.toLocaleString()}+ moms have launched their businesses!`;
                }
            }, 5000);
        }

        // Initialize app
        document.addEventListener('DOMContentLoaded', () => {
            animateUserCounter();
            
            // Load calendar progress if it exists
            setTimeout(() => {
                loadCalendarProgress();
            }, 1000);
            
            // Auto-save form data as user types
            document.addEventListener('input', (e) => {
                if (e.target.classList.contains('form-control') && currentUser) {
                    clearTimeout(window.autoSaveTimer);
                    window.autoSaveTimer = setTimeout(saveFormProgress, 2000);
                }
            });
        });
    </script>
</body>
</html>
